<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>采石场</title>
    <link>http://localhost:1313/</link>
    <description>采石场</description>
    <generator>Hugo 0.147.2 &amp; FixIt v0.3.21-a85a6655</generator>
    <language>zh-CN</language>
    <lastBuildDate>Fri, 18 Apr 2025 21:50:28 +1200</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>总结-DaoFP-范畴论</title>
      <link>http://localhost:1313/posts/24198cb/</link>
      <pubDate>Fri, 18 Apr 2025 21:50:28 +1200</pubDate>
      <guid>http://localhost:1313/posts/24198cb/</guid>
      <description>$$&#xA;{\rm \LaTeX}\text{ Definitions are here.}&#xA;\let\ph=\phantom&#xA;\let\hph=\hphantom&#xA;\let\vph=\vphantom&#xA;\let\mrel=\mathrel&#xA;\let\mbin=\mathbin&#xA;\let\mllap=\mathllap&#xA;\let\mrlap=\mathrlap&#xA;\let\mclap=\mathclap&#xA;\def\verts#1{\lvert#1\rvert}&#xA;\def\pila{\vph{fg}}                   % 柱子 , 用于指定盒子的最小高度&#xA;% ------------------------------------------------------------------&#xA;% 类型运算&#xA;\def\cons{\mrel{.}}                   % 对应积类型 concatenation &#xA;\def\ethr{\mrel{|}}                   % 对应和类型 either&#xA;\def\etc{{\rm etc}}&#xA;% ------------------------------------------------------------------&#xA;% + 的值构造器&#xA;\def\Lft{{\tt Lft}}                   % 对象 + 构造器 Left&#xA;\def\Rht{{\tt Rht}}&#x9;                  % 对象 + 构造器 Right&#xA;% × 的接口&#xA;\def\fst{{\tt fst}}                   % 对象 × - first&#xA;\def\snd{{\tt snd}}                   % × - second&#xA;% N 的值构造器&#xA;\def\zero{0}                          % N - zero&#xA;\def\succ{{\tt succ}}                 % N - successor&#xA;% ------------------------------------------------------------------&#xA;% 打印方法名&#xA;\def\id{\textrm{id}}                           % 对象的 id&#xA;\def\absurd{{\rm\large\textexclamdown}\hspace{-3px}} % 对象的 absurd&#xA;\def\bang{{\rm\small !}}                       % 对象的 bang&#xA;\def\dom{\textrm{dom}}                         % 箭头的定义域&#xA;\def\img{\textrm{img}}                         % 箭头的值域&#xA;\def\src{\textrm{src}}                         % 箭头的源头&#xA;\def\tar{\textrm{tar}}                         % 箭头的目标&#xA;\def\ID{\textrm{ID}}                           % 范畴的 ID&#xA;\def\Obj{\textrm{Obj}}                         % 范畴的对象&#xA;\def\Arr{\textrm{Arr}}                         % 范畴的箭头&#xA;\def\circH{\mbin{\overline\circ}}              % 自然变换的横复合&#xA;\def\circV{\mbin{\circ}}                       % 自然变换的纵复合&#xA;% 打印常/变量名&#xA;\newcommand{\obj}[1][c]{{\sf #1}}              % 对象&#xA;\def\obji{\obj[0]}                             % 对象 : 始&#xA;\def\objt{\obj[1]}                             % 对象 : 终&#xA;\newcommand{\cat}[1][C]{\mathcal{#1}}          % 范畴 : C(默认)&#xA;\def\catCat{\cat[Cat]}                         % 范畴 : Cat&#xA;\def\catSet{\cat[Set]}                         % 范畴 : Set&#xA;\def\catHask{\cat[Hask]}                       % 范畴 : Hask — 笛卡尔闭范畴 (+/× 都在里面)&#xA;\newcommand{\catcirc}[1][\cat]{                % 范畴 C 中的复合运算&#xA;  \catbfunc[#1]{\circ}}&#xA;\newcommand{\catufunc}[2][\cat]{{              % 范畴 C 中的函子 : 一元&#xA;  \overset{\mclap{\small\pila #1}}{#2}}}&#xA;\newcommand{\catbfunc}[2][\cat]{\mbin{{        % 范畴 C 中的函子 : 二元&#xA;  \overset{\mclap{\small\pila #1}}{#2}}}}&#xA;\newcommand{\catdiag}[1][\cat]{                % 范畴 C 中的函子 : 对角&#xA;  \catufunc[#1]{\Delta}}&#xA;\newcommand{\cathom}[1][\cat]{\mbin{{          % 范畴 C 中的函子 : Hom&#xA;  \xrightarrow{\small #1}}}}&#xA;\newcommand{\catplus}[1][\cat]{                % 范畴 C 中的函子 : +&#xA;  \catbfunc[#1]{+}}&#xA;\newcommand{\cattimes}[1][\cat]{               % 范畴 C 中的函子 : ×&#xA;  \catbfunc[#1]{\times}}&#xA;\newcommand{\catotimes}[1][\cat]{              % 范畴 C 中的张量积&#xA;  \catbfunc[#1]{\otimes}}&#xA;\newcommand{\list}[1]{                         % 范畴 Hask 中的函子 List&#xA;&#x9;\texttt{[\(#1\)]}}&#xA;\def\nil{{\tt []}}                             % 范畴 Hask 中的函子 List 的值构造器 nil&#xA;\def\concat{\mbin{:}}                          % 范畴 Hask 中的函子 List 的值构造器 concat&#xA;\def\yoneda{{\Large\raise{-1px}{               % 米田嵌入&#xA;  \hspace{-1px}\smash{よ}\vph{(fgh)}\hspace{-1px}}}}&#xA;\def\yoda{                                     % 尤达嵌入&#xA;  \texttt{尤}}&#xA;\def\limit#1{{\rm lim}}                        % 极限&#xA;\def\colimit#1{{\rm colim}}                    % 余极限&#xA;% 用方法求值&#xA;\def\getid#1{{}_{:#1}\id}                      % 获取对象的 id&#xA;\def\getabsurd#1{{}_{:#1}\absurd}              % 获取对象的 absurd&#xA;\def\getbang#1{{}_{:#1}\bang}                  % 获取对象的 bang&#xA;\def\getdom#1{#1\textrm{ dom}}                 % 获取箭头的定义域&#xA;\def\getimg#1{#1\textrm{ img}}                 % 获取箭头的值域&#xA;\def\getsrc#1{#1~\src}                         % 获取箭头的源头&#xA;\def\gettar#1{#1~\tar}                         % 获取箭头的目标&#xA;\def\getrst#1undr#2{{}^{\vph{fg}}_{:#2}{#1}}   % 获取箭头在对象下的限制 &#xA;\def\getID#1{{}_{:#1}\ID}                      % 获取范畴的 ID&#xA;\def\getObj#1{#1~\Obj}                         % 获取范畴的对象&#xA;\def\getArr#1{#1~\Arr}                         % 获取范畴的箭头&#xA;\def\getop#1{#1^{\rm op}}                      % 获取范畴的对偶&#xA;\def\getlimit#1{#1\textrm{ lim}}               % 获取极限&#xA;\def\getcolimit#1{#1\textrm{ colim}}           % 获取余极限&#xA;$$&lt;div class=&#34;fi-row&#34;&gt;&lt;div style=&#34;page-break-after: always&#34;&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;章节-01---03&#34;&gt;&lt;span&gt;章节 01 - 03&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e7%ab%a0%e8%8a%82-01---03&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;范畴由对象以及对象间的箭头构成 。本文将会&lt;br&gt;&#xA;着重分析余积闭范畴 $\cat$ 。 现在先给出下述定义 :&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;$\obji$ 为始对象&lt;/strong&gt;当且仅当对任意 $\cat$ 中对象 $\obj$&lt;br&gt;&#xA;都有且仅有唯一的箭头 $\getabsurd{\obj}: \obji\cathom \obj$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;$\objt$ 为终对象&lt;/strong&gt;当且仅当对任意 $\cat$ 中对象 $\obj$&lt;br&gt;&#xA;都有且仅有唯一的箭头 $\getbang{\obj}: \obj \cathom \objt$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;注意&lt;/p&gt;&lt;p&gt;其他范畴中始 / 终对象未必存在 。&lt;/p&gt;&lt;/div&gt;&lt;p&gt;我们假设范畴 $\cat$ 中含有始对象 $\obj[0]$ 以及终对象 $\obj[1]$ 。&lt;br&gt;&#xA;因此根据上面的的信息我们不难得出下述内容 :&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;形如 $\obji\cathom\obji$ 的箭头&lt;br&gt;&#xA;仅有一个 , 即 $\getid\obji$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;形如 $\objt\cathom\objt$ 的箭头&lt;br&gt;&#xA;仅有一个 , 即 $\getid\objt$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;对任意 $\cat$ 中对象 $\obj[a]$ , $\obj[a_1]$ , $\obj[a_2]$ , $\etc$ , $\obj[b]$ , $\obj[b_1]$ , $\obj[b_2]$ , $\etc$ &lt;br&gt;&#xA;及任意 $\cat$ 中映射 $\phi$ 我们规定下述性质始终成立 : 。&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\phi$ 为 $\obj[b]$ 的&lt;strong&gt;元素&lt;/strong&gt;当且仅当&lt;br&gt;&#xA;$\phi: \obj[a]\cathom\obj[b]$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\phi$ 为 $\obj[a]$ 的&lt;strong&gt;全局元素&lt;/strong&gt;当且仅当&lt;br&gt;&#xA;$\phi: \objt\cathom\obj[a]$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\phi$ 不存在可由&lt;br&gt;&#xA;$\phi: \obj[b]\cathom \obji$ 得出&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;注意&lt;/p&gt;&lt;p&gt;其他范畴中上一条断言未必成立 。&lt;/p&gt;&lt;/div&gt;&lt;p&gt;另外我们规定&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;$\obj[a]\cathom\obj[b]$ 为所有&lt;br&gt;&#xA;从 $\obj[a]$ 射向 $\obj[b]$ 的箭头构成的集&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;注意&lt;/p&gt;&lt;p&gt;上述断言仅对&lt;strong&gt;局部小范畴成立&lt;/strong&gt;&lt;br&gt;&#xA;其他范畴里 $\obj[a]\cathom\obj[b]$ 未必为集合 。&lt;/p&gt;&lt;/div&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;div style=&#34;page-break-after: always&#34;&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&lt;p&gt;范畴 $\cat$ 中某些特定的箭头可进行复合运算 :&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;对任意 $\cat$ 中对象 $\obj[c_1]$ , $\obj[c_2]$ , $\obj[c_3]$ 我们都会有&lt;br&gt;&#xA;$\begin{aligned}[t]&#xA;\cathom &amp;: (\obj[c_1]\cathom\obj[c_2])\cattimes[\catSet](\obj[c_2]\cathom\obj[c_3])\cathom[\catSet](\obj[c_1]\cathom\obj[c_3]) \\&#xA;\cathom &amp;: (\quad~\phi_1~\quad\,\cons\,\quad~\phi_2~\quad) \longmapsto ~\phi_1\catcirc \phi_2&#xA;\end{aligned}$&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;假如现在还知道箭头 $f_1$ , $\phi_1$ , $g_1$ 分别属于&lt;br&gt;&#xA;$\obj[a_2]\cathom\obj[a_1]$ , $\obj[a_1]\cathom\obj[b_1]$ , $\obj[b_1]\cathom\obj[b_2]$ , 那么便可得知&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;$(f_1\catcirc\phi_1)\catcirc g_1 = f_1\catcirc(\phi_1\catcirc g_1)$&lt;br&gt;&#xA;说明箭头复合运算有结合律&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;另外如果固定住 $\catcirc$ 的单侧实参我们便可获得&lt;br&gt;&#xA;两个新的函数 :&lt;/p&gt;&#xA;$$&#xA;\begin{array}{ll}&#xA;\getabsurd{\obj}A  \\&#xA;\getbang{\obj}A&#xA;\end{array}&#xA;$$</description>
    </item>
    <item>
      <title>翻译-EOPL-05</title>
      <link>http://localhost:1313/posts/d83fb0b/</link>
      <pubDate>Thu, 03 Apr 2025 23:50:08 +1300</pubDate>
      <guid>http://localhost:1313/posts/d83fb0b/</guid>
      <description>&lt;p&gt;Hello&lt;/p&gt;</description>
    </item>
    <item>
      <title>翻译-EOPL-04</title>
      <link>http://localhost:1313/posts/a588704/</link>
      <pubDate>Thu, 03 Apr 2025 23:49:32 +1300</pubDate>
      <guid>http://localhost:1313/posts/a588704/</guid>
      <description>&lt;p&gt;Hello&lt;/p&gt;</description>
    </item>
    <item>
      <title>翻译-EOPL-03</title>
      <link>http://localhost:1313/posts/a3b7a27/</link>
      <pubDate>Thu, 03 Apr 2025 16:06:19 +1300</pubDate>
      <guid>http://localhost:1313/posts/a3b7a27/</guid>
      <description></description>
    </item>
    <item>
      <title>翻译-EOPL-02-数据抽象</title>
      <link>http://localhost:1313/posts/1568c34/</link>
      <pubDate>Wed, 02 Apr 2025 23:11:17 +1300</pubDate>
      <guid>http://localhost:1313/posts/1568c34/</guid>
      <description>$$&#xA;\rm\LaTeX\textrm{ Definitions are here.}&#xA;\def\Int{\textrm{Int}}&#xA;\def\Expression{\textrm{Expression}}&#xA;\def\SList{\textrm{S-list}}&#xA;\def\SExp{\textrm{S-exp}}&#xA;\def\Symbol{\textrm{Symbol}}&#xA;\def\Bintree{\textrm{Bintree}}&#xA;\def\LcExp{\textrm{LcExp}}&#xA;\def\Iden{\textrm{Identifier}}&#xA;\def\BinSearchTree{\textrm{Binary-search-tree}}&#xA;\def\InductHyp{\textit{IH}}&#xA;\def\List{\textrm{List}}&#xA;\def\ScmVal{\textrm{Scheme\_value}}&#xA;\def\ListOfInt{\textrm{List-of-Int}}&#xA;\def\ListOfSymbol{\textrm{List-of-Symbol}}&#xA;\def\ListOf#1{\textrm{List-of-(#1)}}&#xA;\def\VectorOf#1{\textrm{Vector-of(#1)}}&#xA;\def\implement#1{\lceil#1\rceil}&#xA;\def\DiffTree{\textrm{Diff-Tree}}&#xA;\def\EnvExp{\textrm{Env-exp}}&#xA;\def\Var{\textrm{Var}}&#xA;\def\Bool{\textrm{Bool}}&#xA;\def\NodeInSeq{\textrm{NodeInSequence}}&#xA;\def\RedBlueTree{\textrm{Red-blue-tree}}&#xA;\def\RedBlueSubtree{\textrm{Red-blue-subtree}}&#xA;\def\PrefixList{\textrm{Prefix-list}}&#xA;$$&lt;h2 class=&#34;heading-element&#34; id=&#34;S2.1&#34;&gt;&lt;span&gt;2.1 通过接口声明数据&lt;/span&gt;&#xA;  &lt;a href=&#34;#S2.1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;每当我们以某种方式描述集合时 , 一种新数据类型便会随之产生 。&#xA;对这些数据类型下的实体而言 ,&#xA;其值为其外在的表示 ,&#xA;而基于其的运算便是处理这些实体的过程 。&lt;/p&gt;&#xA;&lt;p&gt;这些实体的表示通常会很复杂 。如果允许的话 , 我们不会关心它们具体的实现细节 ,&#xA;但是我们可能会改变数据的表示 。完美的表示往往难以实现 ,&#xA;因此我们会先尝试一些简单的实现 , 只有在系统整体性能与之攸关时才改用更高效的表示 。&#xA;如果决定要改变某些数据的表示方式 , 我们需要能定位出程序中所有依赖该表示的部分 。&#xA;这就需要借助&lt;strong&gt;数据抽象 data abstraction&lt;/strong&gt; 技术 。&lt;/p&gt;&#xA;&lt;p&gt;数据抽象将数据类型分为两部分 : &lt;strong&gt;接口 interface&lt;/strong&gt; 和&lt;strong&gt;实现 implementation&lt;/strong&gt; 。接口告诉我们类型表示什么数据 ,&#xA;数据可进行什么操作 ,&#xA;这些操作可得出什么性质 , 等等 ;&#xA;而实现则会给出数据的具体表示以及处理数据表示的代码 。&lt;/p&gt;&#xA;&lt;p&gt;这样抽象出的数据类型称作&lt;strong&gt;抽象数据类型 abstract data type&lt;/strong&gt; 。程序的其余部分 ( 即数据类型&#xA;的&lt;strong&gt;用户 client&lt;/strong&gt; ) 只能通过接口中指定的操作来处理新数据 。这样一来如果希望改变数据的表示&#xA;我们只需改变数据处理接口的实现即可 。&lt;/p&gt;&#xA;&lt;p&gt;这一想法并不陌生 : 我们写程序处理文件时一般只关心能否调用过程以对文件进行打开 , 关闭 ,&#xA;读取或其他操作 。同样地在大多数时候我们并不关心整数在机器中究竟怎样表示 , 只关心能否&#xA;可靠地执行算术操作 。&lt;/p&gt;&#xA;&lt;p&gt;如果数据类型下的项只能通过接口提供的过程进行处理, 那么我们便可将代码称作&lt;strong&gt;表示无关的 representation independent&lt;/strong&gt; —— 因为这些代码不依赖这些项的值的表示  。&lt;/p&gt;&#xA;&lt;p&gt;如此所有关于数据表示的信息必然在实现对应的代码之中 ; 实现中最重要的部分便是声明数据&#xA;的表示方式 。我们用记号 $\implement v$ 表示 &amp;quot; $v$ 的表示 &amp;quot; 。&lt;/p&gt;&#xA;&lt;p&gt;为使这一切更明了 , 考虑一个简单的例子 —— 自然数类型 :  待表示数据为自然数 , 接口由四个&#xA;过程组成 : &lt;code&gt;zero&lt;/code&gt; , &lt;code&gt;is-zero?&lt;/code&gt; , &lt;code&gt;successor&lt;/code&gt; , &lt;code&gt;predecessor&lt;/code&gt; ; 当然不是随便几个过程都能够&#xA;作为该接口的实现 , 一组过程只有同时满足下述四个方程才可作为下述接口的实现 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;&amp;\texttt{(zero)} &#xA;&amp;{}={}&#xA;&amp;\implement 0 &#xA;\\&#xA;&amp;\texttt{(is-zero? \implement {$n$})}&#xA;&amp;{}={}&#xA;&amp;\begin{cases}&#xA;\texttt{\#t} &amp; n=0 \\&#xA;\texttt{\#f} &amp; n\neq 0&#xA;\end{cases}&#xA;\\&#xA;&amp;\texttt{(successor \implement {$n$})}&#xA;&amp;{}={}&#xA;&amp;\implement{n+1} &amp; (n\geq 0) &#xA;\\&#xA;&amp;\texttt{(predecessor \implement {$n+1$})}&#xA;&amp;{}={}&#xA;&amp;\implement{n} &amp; (n\geq 0)&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;该定义并未指明自然数应当如何表示 , 它只要求这些过程产生指定的行为 —— 如 &lt;code&gt;zero&lt;/code&gt; 必须&#xA;返回 &lt;code&gt;0&lt;/code&gt; 的表示 , &lt;code&gt;successor&lt;/code&gt; 须返回 &lt;code&gt;n+1&lt;/code&gt; 的表示 , 等等 ;  该定义并没有对 &lt;code&gt;zero&lt;/code&gt; 做出说明 ,&#xA;所以按照该定义任何行为都是可接受的 。&lt;/p&gt;&#xA;&lt;p&gt;现在我们可以写出处理自然数的用户程序 ,&#xA;并且不论用哪种表示方式都可以保证得出正确结果 。如 ,&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;plus&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;is-zero?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;successor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;plus&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;都将满足 $\texttt{(plus \implement {$x$}  \implement {$y$})} = \implement {x+y}$ , 无论采用的表示方式为如何 。&lt;/p&gt;&#xA;&lt;p&gt;大多数接口都包含若干用于创建数据类型的元素的&lt;strong&gt;构造器 constructor&lt;/strong&gt; 及若干用于从数据类型&#xA;的元素中提取信息的&lt;strong&gt;观测器 observer&lt;/strong&gt; 。这里也不例外 : 有三个构造器 &lt;code&gt;zero&lt;/code&gt; , &lt;code&gt;successor&lt;/code&gt; 及&#xA;&lt;code&gt;predecessor&lt;/code&gt; 外加一个观测器 &lt;code&gt;is-zero?&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;可以用多种方式表示这套接口 。我们考虑其中三种 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;一元表示法 Unary representation&lt;/strong&gt; :&#xA;在一元表示法中自然数 &lt;code&gt;n&lt;/code&gt; 表示为 &lt;code&gt;n&lt;/code&gt; 个 &lt;code&gt;#t&lt;/code&gt; 构成的列表 ; 如此&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;   &amp;\implement 0 &#xA;   &amp;{}={}&#xA;   &amp;\texttt{()}&#xA;   \\&#xA;   &amp;\implement 1&#xA;   &amp;{}={}&#xA;   &amp;\texttt{(\#t)}&#xA;   \\&#xA;   &amp;\implement 2&#xA;   &amp;{}={}&#xA;   &amp;\texttt{(\#t \#t)}&#xA;   \end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;如此便可递归定义该表示法 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;   &amp;\implement 0 &#xA;   &amp;{}={}&#xA;   &amp;\texttt{()}&#xA;   \\&#xA;   &amp;\implement {n+1}&#xA;   &amp;{}={}&#xA;   &amp;\texttt{(\#t . n)}&#xA;   \\&#xA;   \end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;在该表示法中我们可通过下述代码实现接口&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;zero&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;is-zero?&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;successor&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Scheme 数字表示法 Scheme number representation&lt;/strong&gt; :&#xA;该表示仅涉及 Scheme 内置的数字表示法 ( 本身可能十分复杂 ! ) 。&#xA;如果令 $\implement n$ 为 Scheme 整数 $n$ , 则所需的四个过程可以定义为：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;(define zero        (lambda ()  0))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;(define is-zero?    (lambda (n) (zero? n)))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;(define successor   (lambda (n) (+ n 1)))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;(define predecessor (lambda (n) (- n 1)))&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;大数表示法 Bignum representation&lt;/strong&gt; :&#xA;此表示法中数值以 $N$ 进制表示 , 其中 $N$ 是某个整数 ; 该方法以 $0$ 到 $N-1$ 之间的数字 (&#xA;有时不称数位而称&lt;strong&gt;大位 bigit&lt;/strong&gt; ) 组成的表来表示数值 , 这就很容易表示那些远超机器字长&#xA;的整数 。为了便使用 , 这里把最低位放在列表最前端 。该表示法可通过归纳法如下定义 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;   &amp;\implement n &#xA;   &amp;{}={}&#xA;   &amp; 0 &amp;&amp; \textrm{若 $n=0$} \\&#xA;   &amp;&amp;&#xA;   &amp; \texttt{(r . \implement {$q$})} &amp;&amp;\textrm{若 $n=qN+r$ 且 $0\leq r &amp;lt; N$}&#xA;   \end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;因此若 $N=16$ 则 $\implement {33}=\texttt{(1 2)}$ 且 $\implement {258} =\texttt{(2 0 1)}$ —— 因为&lt;/p&gt;&#xA;&lt;p&gt;$\qquad 258 = 2\times 16^0+0\times 16^1+1\times 16^2$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;上述表示法都没有强制数据抽象 ,&#xA;没有东西可以阻止用户程序查验表示法用的究竟是列表还是 Scheme 整数 。&#xA;有些语言对数据抽象有直接支持 , 它们允许程序员创建新接口并确保只能通过&#xA;接口提供的过程处理新数据 。若类型表示被隐藏且不会因任何操作而暴露 ( 包括打印 ) 则称作&lt;strong&gt;模糊 opaque&lt;/strong&gt; 的 , 否则称为&lt;strong&gt;透明 transparent&lt;/strong&gt; 的 。&lt;/p&gt;&#xA;&lt;p&gt;Scheme 并未提供标准机制来创建新的模糊类型 , 因此我们采取一种折衷的抽象级别 —— 定义&#xA;接口并劳烦用户程序的作者谨慎行事 , 只使用接口中定义的过程 。&lt;/p&gt;&#xA;&lt;p&gt;在第 8 章 ( 模块 ) 将会研究一些方法以强化语言的这种行为准则 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.1&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.1&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;尝试实现大数表示法的四种接口并用你的实现求 10 的阶乘 。执行时间将会随着参数 / 进制&#xA;的改变如何变化 ? 请解释原因 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 设置大数表示法的基底&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;base&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;set-base!&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;set! &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;base&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 下面是大数表示法的四个接口&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;is-zero?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;null?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;successor&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;is-zero?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;lt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;base&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;successor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;= &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;base&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 整数与大数表示法的互相转换&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;integer-&amp;gt;bigits&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zero? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;successor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;integer-&amp;gt;bigits&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bigits-&amp;gt;integer&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;is-zero?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bigits-&amp;gt;integer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 加法和乘法&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;plus&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;is-zero?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;successor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;plus&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;multiply&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;is-zero?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;is-zero?&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;plus&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;multiply&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 阶乘&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;factorial&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;is-zero?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;successor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;zero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;multiply&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;factorial&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;predecessor&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 测试&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;with-base&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;thunk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;orig-base&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;begin&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;set-base!&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;thunk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;set-base!&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;orig-base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;print-factorial&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;base&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;with-base&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;base&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;collect-garbage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;eopl:printf&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s&#34;&gt;&amp;#34;Base ~s: ~s! = ~s~%&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;base&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bigits-&amp;gt;integer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;factorial&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;integer-&amp;gt;bigits&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;注意到 :&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;(factorial n)&lt;/code&gt; 中的 &lt;code&gt;n&lt;/code&gt; 与执行时间成正比 ( 原因在于阶乘运算本身的时间复杂度 ) ;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;(set-base! n)&lt;/code&gt; 中的 &lt;code&gt;n&lt;/code&gt; 与执行时间成反比 ( 大基数在表示数字时所需的位数更少 ) 。&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.2&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.2&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;详细分析上述表示法 : 从满足数据类型定义的角度来说 , 在何种程度上它们是成功 / 失败的 ?&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;表示法&lt;/th&gt;&#xA;          &lt;th&gt;优点&lt;/th&gt;&#xA;          &lt;th&gt;缺点&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;一元&lt;/td&gt;&#xA;          &lt;td&gt;实现简单 , 完全符合规范 , 仅受物理内存容量的限制&lt;/td&gt;&#xA;          &lt;td&gt;性能差 , 另外在表示大数字时几乎不可读&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;Scheme  数字&lt;/td&gt;&#xA;          &lt;td&gt;实现简单 , 表示方式易于阅读 , 性能良好 ( 完全由底层具体的 Scheme 实现决定 )&lt;/td&gt;&#xA;          &lt;td&gt;对于没有内建大数支持的 Scheme 实现计算结果可能会溢出，因此不能完全符合规范&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;大数&lt;/td&gt;&#xA;          &lt;td&gt;完全符合规范 , 性能相对较好 ( 较大的基数会带来更好的性能 )&lt;/td&gt;&#xA;          &lt;td&gt;依赖于基数 , 不容易实现&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.3&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.3&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;用差分树表示所有整数 ( 负数和非负数 ) 。差分树是一个列表 , 对应的语法定义如下：&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]\DiffTree ::={}&amp; \texttt{(one)} \mid \texttt{(diff \DiffTree  \DiffTree)}\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;列表 $\texttt{(one)}$ 表示 $1$ ; 另外若 $t_1$ 表示 $n_1$ 且 $t_2$ 表示 $n_2$ 则 $\texttt{(diff $t_1$ $t_2$)}$ 表示 $n_1 - n_2$ 。&lt;/p&gt;&#xA;&lt;p&gt;故 $\texttt{(one)}$ 和 $\texttt{(diff (one) (diff (one) (one)))}$ 都表示 $1$ ;&#xA;而 $\texttt{(diff (diff (one) (one)) (one))}$ 表示的数则是 $-1$ 。&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;证明此系统中的每个数都有无限种表示方式 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;证 : 反证法 。&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;假如 $S$ 为自然数 $n$ 的所有表示所构成的集 , 那么对任意 $x\in S$ 我们定义集合 $S&#39;$ 为满足下述两条推理规则的集合 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\begin{prooftree}\AXC{}\UIC{\(x\in S&#39;\)}\end{prooftree}$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\begin{prooftree}\AXC{\(y\in S&#39;\)}\UIC{\(\texttt{(diff \(y\) (diff (one) (one)))}\)}\end{prooftree}$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;不难看出 $S&#39;$ 是无穷集 ; 而 $S&#39;\subseteq S$ , 故 $S$ 亦为无穷集 。&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;完整实现这种整数表示法  ——  即写出整数定义的 &lt;code&gt;zero&lt;/code&gt; , &lt;code&gt;is-zero?&lt;/code&gt; , &lt;code&gt;successor&lt;/code&gt;&#xA;和 &lt;code&gt;predecessor&lt;/code&gt; 。此外还要能表示负数 。此表示法中整数的任何合法表示都可以&#xA;作为你过程的参数 : 如过程 &lt;code&gt;successor&lt;/code&gt; 可接受无限多种 &lt;code&gt;1&lt;/code&gt; 的合法表示且最终都能&#xA;给出一个 &lt;code&gt;2&lt;/code&gt; 的合法表示 ; 对 &lt;code&gt;1&lt;/code&gt; 的不同合法表示皆可给出对应的 &lt;code&gt;2&lt;/code&gt; 的合法表示 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 : &lt;mark class=&#34;mark-default&#34;&gt;TODO&lt;/mark&gt;&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;写出过程 &lt;code&gt;diff-tree-plus&lt;/code&gt; 并用这种表示做加法 。你的过程应针对不同的差分树&#xA;进行优化并在常数时间内得出结果 ( 即与输入大小无关 ) 。注意本题不能使用递归 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;S2.2&#34;&gt;&lt;span&gt;2.2 数据类型的表示策略&lt;/span&gt;&#xA;  &lt;a href=&#34;#S2.2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;一旦使用了数据抽象 , 程序便拥有了表示无关性 —— 其与用来实现抽象数据类型的具体的&#xA;表示方式无关 。我们甚至还可以通过重新定义接口中的一小部分来改变数据的表示 。在&#xA;后面的章节会经常用到此性质 。&lt;/p&gt;&#xA;&lt;p&gt;本节将介绍几种数据类型的表示策略 : 我们将通过&lt;strong&gt;环境 environment&lt;/strong&gt; 数据类型对这些策略&#xA;进行探究 ; 环境会将有限个变量与这些变量对应的值逐个关联起来 。在编程语言的实现中&#xA;环境可用来维系变量与值之间的关系 , 编译器也可借由环境将变量名与变量信息关联起来 。&lt;/p&gt;&#xA;&lt;p&gt;变量可用任何我们喜欢的方式来表示 , 只要能够检查两个变量是否相等即可 。这里我们用&#xA;Scheme 符号表示变量 , 但在没有符号数据类型的语言中变量也可用字符串 、哈希表引用&#xA;甚至是数字来表示 ( 见 &lt;a href=&#34;http://localhost:1313/posts/a3b7a27/#S3.6&#34;&gt;3.6 节&lt;/a&gt; ) 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;S2.2.1&#34;&gt;&lt;span&gt;2.2.1 环境的接口&lt;/span&gt;&#xA;  &lt;a href=&#34;#S2.2.1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;环境是个函数 , 其定义域为变量构成的有限集 , 值域为所有 Scheme 值构成的集 。数学中&#xA;有限函数常被解释为由有序对组成的有限集 ;  而本书决定采用该释义 , 因此就必须表示出&#xA;所有形如 $\texttt{(($var_1$,$val_1$),...,($var_n$,$val_n$))}$ 的集 ,  其中 $var_i$ 为某一变量而 $val_i$ 为任意的&#xA;Scheme 值 。有时也将环境 $env$ 中变量 $var$ 的值 $val$ 称作是 $var$ 在 $env$ 中的&lt;strong&gt;绑定 binding&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;该数据类型的接口有三个过程 , 定义如下 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;&amp;\texttt{(empty-env)}&#xA;&amp;{}={}&#xA;&amp;\implement \varnothing&#xA;\\&#xA;&amp;\texttt{(apply-env \implement {$f$}  $var$)}&#xA;&amp;{}={}&#xA;&amp;f(var)&#xA;\\&#xA;&amp;\texttt{(extend-env $var$ $val$ \implement {$f$})}&#xA;&amp;{}={}&#xA;&amp;\implement g , &amp;其中~&#xA;g(var_1) ={}&#xA;\begin{cases}&#xA;val      &amp; 如果~ var_1=var\\&#xA;f(var_1) &amp; 否则&#xA;\end{cases}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;过程 &lt;code&gt;empty-env&lt;/code&gt; 不接受参数并返回空环境的表示 ;  &lt;code&gt;apply-env&lt;/code&gt; 将环境 $\implement f$ 应用到 $env$ ;&#xA;组合式 $\texttt{(extend-env $var$ $val$ $env$)}$ 将产生一个行为同 $env$ 的新环境 ,  只不过新环境里&#xA;变量 $var$ 的值会被设为 $val$ 。例如 : 表达式&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;extend-env&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;d&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;extend-env&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;y&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;extend-env&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;extend-env&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;y&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;定义了一个环境 $e$ 满足 $e(\texttt{d}) = 6$ , $e(\texttt{x}) = 7$ , $e(\texttt{y}) = 8$ 并且 $e$ 对任何其他变量都是未定义的 ;&#xA;当然这只是生成该环境的众多方法之一 。在刚才的例子中 , $\tt y$ 先被绑定到 $14$ 后被绑定到 $8$ 。&lt;/p&gt;&#xA;&lt;p&gt;与上一个例子类似 , 我们可将接口的过程分为构造器和观测器 ; 本例中的 &lt;code&gt;empty-env&lt;/code&gt; 以及&#xA;&lt;code&gt;extend-env&lt;/code&gt; 是构造器 , 而 &lt;code&gt;apply-env&lt;/code&gt; 则是唯一的观测器 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.4&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.4&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;考虑&lt;strong&gt;栈 stack&lt;/strong&gt; 数据类型 , 其接口有 &lt;code&gt;empty-stack&lt;/code&gt; , &lt;code&gt;push&lt;/code&gt; , &lt;code&gt;pop&lt;/code&gt; , &lt;code&gt;top&lt;/code&gt; , &lt;code&gt;empty-stack?&lt;/code&gt; 。&#xA;请模仿示例中的方式写出这些过程的定义 。另外上述过程中哪些是构造器 , 哪些是观测器 ?&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;S2.2.2&#34;&gt;&lt;span&gt;2.2.2 数据结构表示法&lt;/span&gt;&#xA;  &lt;a href=&#34;#S2.2.2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;易知每个环境都是从空环境开始搭建并由 $n$ 次调用 &lt;code&gt;extend-env&lt;/code&gt; 以获得 , 其中 $n\geq 0$ 。如&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;extend-env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;varn&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;valn&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;extend-env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;var1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;val1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;empty-env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;由此便可获得环境的一种表示方法 。&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\EnvExp &#xA;::={} &amp; \texttt{(empty-env)} \\&#xA;::={} &amp; \texttt{(extend-env \Iden  \ScmVal  \EnvExp)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;我们可用描述列表集合 $\List$ 的递归语法来描述环境 , 如此便可获得&lt;a href=&#34;#G2.1&#34;&gt;图 2.1&lt;/a&gt; 中的实现 。过程&#xA;&lt;code&gt;apply-env&lt;/code&gt; 会查看表示环境的数据结构以判断它表示哪种环境并做出适当操作 : 若它表示&#xA;空环境则会报错 ; 若它表示的是由 &lt;code&gt;extend-env&lt;/code&gt; 生成的环境则判断待查找的变量是否会与&#xA;环境中绑定的某一变量相同 : 如果是则返回保存的值 , 否则则在保存的环境中查找变量 。&lt;/p&gt;&#xA;&lt;p&gt;这是种常见的代码模式 , 我们管它叫&lt;strong&gt;解释器配方 interpreter recipe&lt;/strong&gt; :&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;解释器配方&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;查看一段数据 。&lt;/li&gt;&#xA;&lt;li&gt;判断它表示什么样的数据 。&lt;/li&gt;&#xA;&lt;li&gt;提取数据的各个部分并对它们做适当操作 。&lt;/li&gt;&#xA;&lt;/ol&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;下方为图 2.1 —— 环境的数据结构表示 。&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;G2.1&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; Env = (empty-env) | (extend-env Var SchemeVal Env)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; Var = Sym&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; empty-env : () → Env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;empty-env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;&amp;#39;empty-env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; extend-env : Var × SchemeVal × Env → Env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;extend-env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;&amp;#39;extend-env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; apply-env : Env × Var → SchemeVal&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;apply-env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;cond&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;empty-env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;report-no-binding-found&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;extend-env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;saved-var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;saved-val&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;caddr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;saved-env&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadddr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;saved-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;nv&#34;&gt;saved-val&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;apply-env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;saved-env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;else&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;report-invalid-env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)])))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;report-no-binding-found&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;eopl:error&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;apply-env&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;No binding for ~s&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;report-invalid-env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;eopl:error&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;apply-env&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Bad environment: ~s&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.5&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.5&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;我们可以用任何数据结构表示空环境 —— 只要能区分空 / 非空环境并且可以从后者中提取出&#xA;数据片段 。请按下述要求实现环境 : 空环境由空列表表示 , 而 &lt;code&gt;extend-env&lt;/code&gt; 将生成如下环境：&#xA;$&#xA;% \qquad \begin{xy}0;p+/r+10pt/:p+/u+10pt/::&#xA;% (0,0)*+=&lt;10pt&gt;[F-]{}=&#34;point-to-var1-pair&#34;;&#xA;% (1,0)*+=&lt;10pt&gt;[F-]{}=&#34;point-to-env1&#34;     ;&#xA;% {\ar{-};(1,0);p!R+/r+1.5cm/|(1.6){saved-env}};&#xA;% &#34;point-to-var1-pair&#34;+/d+1.5cm/;p+/r+10pt/:p+/d+10pt/::&#xA;% (0,0)*+=&lt;10pt&gt;[F-]{}=&#34;var1-pair-var&#34;;&#xA;% (1,0)*+=&lt;10pt&gt;[F-]{}=&#34;var1-pair-val&#34;;&#xA;% {\ar{-};0;&#34;var1-pair-var&#34;};&#xA;% {\ar{-};(0,0);p!R+/dl+1.5cm/|(1.2){saved-var}};&#xA;% {\ar{-};(1,0);p!R+/dr+1.5cm/|(1.2){saved-val}};&#xA;% \end{xy}&#xA;$&lt;/p&gt;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;  &lt;div class=&#34;svg-container&#34;&gt;&#xD;&#xA;    &lt;svg style=&#34;vertical-align: -13.069ex;&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;32.004ex&#34; height=&#34;15.105ex&#34; role=&#34;img&#34; focusable=&#34;false&#34; viewBox=&#34;0 -900 14145.9 6676.5&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34; aria-hidden=&#34;true&#34;&gt;&lt;defs&gt;&lt;path id=&#34;MJX-60-TEX-I-1D460&#34; d=&#34;M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-60-TEX-I-1D44E&#34; d=&#34;M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-60-TEX-I-1D463&#34; d=&#34;M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-60-TEX-I-1D452&#34; d=&#34;M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-60-TEX-I-1D451&#34; d=&#34;M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-60-TEX-N-2212&#34; d=&#34;M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-60-TEX-I-1D45B&#34; d=&#34;M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-60-TEX-I-1D45F&#34; d=&#34;M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-60-TEX-I-1D459&#34; d=&#34;M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z&#34;&gt;&lt;/path&gt;&lt;/defs&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; stroke-width=&#34;0&#34; transform=&#34;scale(1,-1)&#34;&gt;&lt;g data-mml-node=&#34;math&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;mspace&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;xypic&#34; data-cmd-id=&#34;0&#34; data-text-mml-ids=&#34;[0,1,2,3,4,5,6]&#34; transform=&#34;translate(2000,0)&#34;&gt;&lt;g fill=&#34;none&#34; stroke=&#34;currentColor&#34; stroke-linecap=&#34;round&#34; stroke-width=&#34;0.64&#34; transform=&#34;translate(4468.1,250) scale(62.5, -62.5)&#34;&gt;&lt;rect x=&#34;-8&#34; y=&#34;-8&#34; width=&#34;16&#34; height=&#34;16&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;rect x=&#34;8&#34; y=&#34;-8&#34; width=&#34;16&#34; height=&#34;16&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;16&#34; y1=&#34;0&#34; x2=&#34;60.84&#34; y2=&#34;0&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(62.4,0) rotate(0) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;-8&#34; y=&#34;38.4&#34; width=&#34;16&#34; height=&#34;16&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;rect x=&#34;8&#34; y=&#34;38.4&#34; width=&#34;16&#34; height=&#34;16&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;0&#34; y1=&#34;0&#34; x2=&#34;0&#34; y2=&#34;38.4&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(0,38.4) rotate(90) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;line x1=&#34;0&#34; y1=&#34;46.4&#34; x2=&#34;-32.72&#34; y2=&#34;79.12&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(-32.81,79.21) rotate(135) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;line x1=&#34;16&#34; y1=&#34;46.4&#34; x2=&#34;48.72&#34; y2=&#34;79.12&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(48.81,79.21) rotate(45) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;0&#34; data-y=&#34;0&#34; data-xypic-id=&#34;0&#34; transform=&#34;translate(4468.1,250)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;1&#34; data-y=&#34;0&#34; data-xypic-id=&#34;1&#34; transform=&#34;translate(5468.1,250)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;3.9436508319334727&#34; data-y=&#34;0.2163746750430835&#34; data-xypic-id=&#34;2&#34; transform=&#34;translate(8411.7,33.6)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mi&#34;&gt;&lt;use data-c=&#34;1D460&#34; xlink:href=&#34;#MJX-60-TEX-I-1D460&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(469,0)&#34;&gt;&lt;use data-c=&#34;1D44E&#34; xlink:href=&#34;#MJX-60-TEX-I-1D44E&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(998,0)&#34;&gt;&lt;use data-c=&#34;1D463&#34; xlink:href=&#34;#MJX-60-TEX-I-1D463&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(1483,0)&#34;&gt;&lt;use data-c=&#34;1D452&#34; xlink:href=&#34;#MJX-60-TEX-I-1D452&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(1949,0)&#34;&gt;&lt;use data-c=&#34;1D451&#34; xlink:href=&#34;#MJX-60-TEX-I-1D451&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mo&#34; transform=&#34;translate(2469,0)&#34;&gt;&lt;use data-c=&#34;2212&#34; xlink:href=&#34;#MJX-60-TEX-N-2212&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(3247,0)&#34;&gt;&lt;use data-c=&#34;1D452&#34; xlink:href=&#34;#MJX-60-TEX-I-1D452&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(3713,0)&#34;&gt;&lt;use data-c=&#34;1D45B&#34; xlink:href=&#34;#MJX-60-TEX-I-1D45B&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(4313,0)&#34;&gt;&lt;use data-c=&#34;1D463&#34; xlink:href=&#34;#MJX-60-TEX-I-1D463&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;1.6653345369377348e-16&#34; data-y=&#34;2.9&#34; data-xypic-id=&#34;3&#34; transform=&#34;translate(4468.1,-2650)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;1.0000000000000002&#34; data-y=&#34;2.9&#34; data-xypic-id=&#34;4&#34; transform=&#34;translate(5468.1,-2650)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;-4.126675175004691&#34; data-y=&#34;5.5771062735722685&#34; data-xypic-id=&#34;5&#34; transform=&#34;translate(341.4,-5327.1)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mi&#34;&gt;&lt;use data-c=&#34;1D460&#34; xlink:href=&#34;#MJX-60-TEX-I-1D460&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(469,0)&#34;&gt;&lt;use data-c=&#34;1D44E&#34; xlink:href=&#34;#MJX-60-TEX-I-1D44E&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(998,0)&#34;&gt;&lt;use data-c=&#34;1D463&#34; xlink:href=&#34;#MJX-60-TEX-I-1D463&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(1483,0)&#34;&gt;&lt;use data-c=&#34;1D452&#34; xlink:href=&#34;#MJX-60-TEX-I-1D452&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(1949,0)&#34;&gt;&lt;use data-c=&#34;1D451&#34; xlink:href=&#34;#MJX-60-TEX-I-1D451&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mo&#34; transform=&#34;translate(2469,0)&#34;&gt;&lt;use data-c=&#34;2212&#34; xlink:href=&#34;#MJX-60-TEX-N-2212&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(3247,0)&#34;&gt;&lt;use data-c=&#34;1D463&#34; xlink:href=&#34;#MJX-60-TEX-I-1D463&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(3732,0)&#34;&gt;&lt;use data-c=&#34;1D44E&#34; xlink:href=&#34;#MJX-60-TEX-I-1D44E&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(4261,0)&#34;&gt;&lt;use data-c=&#34;1D45F&#34; xlink:href=&#34;#MJX-60-TEX-I-1D45F&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;1.84888169081445&#34; data-y=&#34;5.5771062735722685&#34; data-xypic-id=&#34;6&#34; transform=&#34;translate(6317,-5327.1)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mi&#34;&gt;&lt;use data-c=&#34;1D460&#34; xlink:href=&#34;#MJX-60-TEX-I-1D460&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(469,0)&#34;&gt;&lt;use data-c=&#34;1D44E&#34; xlink:href=&#34;#MJX-60-TEX-I-1D44E&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(998,0)&#34;&gt;&lt;use data-c=&#34;1D463&#34; xlink:href=&#34;#MJX-60-TEX-I-1D463&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(1483,0)&#34;&gt;&lt;use data-c=&#34;1D452&#34; xlink:href=&#34;#MJX-60-TEX-I-1D452&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(1949,0)&#34;&gt;&lt;use data-c=&#34;1D451&#34; xlink:href=&#34;#MJX-60-TEX-I-1D451&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mo&#34; transform=&#34;translate(2469,0)&#34;&gt;&lt;use data-c=&#34;2212&#34; xlink:href=&#34;#MJX-60-TEX-N-2212&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(3247,0)&#34;&gt;&lt;use data-c=&#34;1D463&#34; xlink:href=&#34;#MJX-60-TEX-I-1D463&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(3732,0)&#34;&gt;&lt;use data-c=&#34;1D44E&#34; xlink:href=&#34;#MJX-60-TEX-I-1D44E&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;mi&#34; transform=&#34;translate(4261,0)&#34;&gt;&lt;use data-c=&#34;1D459&#34; xlink:href=&#34;#MJX-60-TEX-I-1D459&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;  &lt;style&gt;&#xD;&#xA;    .svg-container {&#xD;&#xA;      display: inline-block;&#xD;&#xA;      width: 100%;&#xD;&#xA;      max-width: 100%;&#xD;&#xA;      height: auto;&#xD;&#xA;      overflow-x: auto;&#xD;&#xA;      overflow-y: hidden;&#xD;&#xA;    }&#xD;&#xA;    .svg-container svg {&#xD;&#xA;      width: auto;&#xD;&#xA;      height: auto;&#xD;&#xA;      &#xD;&#xA;      &#xD;&#xA;    }&#xD;&#xA;  &lt;/style&gt;&#xD;&#xA;&#xA;&lt;p&gt;这叫做&lt;strong&gt;关联列表 association-list 表示法&lt;/strong&gt;或 &lt;strong&gt;a-list 表示法&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.6&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.6&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;请发明至少三种环境接口表示 , 并给出它们具体的实现 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.7&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.7&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;重写&lt;a href=&#34;#G2.1&#34;&gt;图 2.1&lt;/a&gt; 中的 &lt;code&gt;apply-env&lt;/code&gt; 并给出更详细的错误信息 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.8&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.8&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;为环境接口添加观测器 &lt;code&gt;empty-env?&lt;/code&gt; 并用 a-list 表示法实现它 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.9&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.9&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;为环境接口添加观测器 &lt;code&gt;has-binding?&lt;/code&gt; : 其取一个环境 $env$ 以及一个变量 $s$ 并判断 $s$ 在&#xA;$env$ 中是否有绑定值 。请用 a-list 表示法实现它 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.10&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.10&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;为环境接口添加构造器 &lt;code&gt;extend-env*&lt;/code&gt; 并用 a-list 表示法实现它 : 该构造器接受的参数有 :&#xA;一个变量列表 , 一个长度相等的值列表以及一个环境 。其定义为 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \texttt{(extended-env* ($var_1$ ... $var_k$) ($val_1$ ... $val_k$) \implement {$f$})} = \implement g$ , 其中&lt;/p&gt;&#xA;&lt;p&gt;$\qquad g = \begin{cases}&#xA;val_i &amp; \textrm{若存在 $i$ 满足 $1\leq i\leq k$ 且 $var=var_i$} \\&#xA;f(var)&amp; \textrm{否则}&#xA;\end{cases}$&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.11&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.11&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;考虑前一题中 &lt;code&gt;extend-env*&lt;/code&gt; 较为拙劣的实现 , 其运行时间与 $k$ 成正比 。有一种表示可使得&#xA;&lt;code&gt;extend-env*&lt;/code&gt; 的运行时间为常数 : 及用空列表表示空环境并用下面的数据结构表示非空环境 :&#xA;$&#xA;%\qquad \qquad \begin{xy}0;p+/r+10pt/:p+/d+10pt/::&#xA;%(0,0)=&#34;var1-pair-c&#34;*+=&lt;10pt&gt;[F-]{}=&#34;var1-pair&#34;;&#xA;%(1,0)=&#34;env1-c&#34;     *+=&lt;10pt&gt;[F-]{}=&#34;env1&#34;     ;&#xA;%&#34;env1&#34;+/r+5cm/;p+/r+10pt/:p+/d+10pt/::&#xA;%(0,0)=&#34;var2-pair-c&#34;*+=&lt;10pt&gt;[F-]{}=&#34;var2-pair&#34;;&#xA;%(1,0)=&#34;env2-c&#34;     *+=&lt;10pt&gt;[F-]{}=&#34;env2&#34;     ;&#xA;%{\ar{-};&#34;env1-c&#34;;&#34;var2-pair&#34;^{\text{backbone}}};&#xA;%&#34;env2&#34;+/r+5cm/;p+/r+10pt/:p+/d+10pt/::&#xA;%(0,0)=&#34;var3-pair-c&#34;*+=&lt;10pt&gt;[F-]{}=&#34;var3-pair&#34;;&#xA;%(1,0)=&#34;env3-c&#34;     *+=&lt;10pt&gt;[F-]{}=&#34;env3&#34;     ;&#xA;%{\ar{-};&#34;env2-c&#34;;&#34;var3-pair&#34;^{\text{backbone}}};&#xA;%{\ar{-};&#34;env3-c&#34;;p!R+/r+3cm/|(1.3){{\text{rest of env}}}};&#xA;%&#34;var1-pair&#34;+/d+1.5cm/;p+/r+10pt/:p+/d+10pt/::&#xA;%(0,0)*+=&lt;10pt&gt;[F-]{}=&#34;var1-pair-var&#34;;&#xA;%(1,0)*+=&lt;10pt&gt;[F-]{}=&#34;var1-pair-val&#34;;&#xA;%{\ar{-};&#34;var1-pair-c&#34;;&#34;var1-pair-var&#34;};&#xA;%{\ar{-};(0,0);p!R+/dl+1.5cm/|(1.2){\texttt{(a b c)}}};&#xA;%{\ar{-};(1,0);p!R+/dr+1.5cm/|(1.2){\texttt{(11 12 13)}}};&#xA;%&#34;var2-pair&#34;+/d+1.5cm/;p+/r+10pt/:p+/d+10pt/::&#xA;%(0,0)*+=&lt;10pt&gt;[F-]{}=&#34;var2-pair-var&#34;;&#xA;%(1,0)*+=&lt;10pt&gt;[F-]{}=&#34;var2-pair-val&#34;;&#xA;%{\ar{-};&#34;var2-pair-c&#34;;&#34;var2-pair-var&#34;};&#xA;%{\ar{-};(0,0);p!R+/dl+1.5cm/|(1.2){\texttt{(x z)}}};&#xA;%{\ar{-};(1,0);p!R+/dr+1.5cm/|(1.2){\texttt{(66 77)}}};&#xA;%&#34;var3-pair&#34;+/d+1.5cm/;p+/r+10pt/:p+/d+10pt/::&#xA;%(0,0)*+=&lt;10pt&gt;[F-]{}=&#34;var3-pair-var&#34;;&#xA;%(1,0)*+=&lt;10pt&gt;[F-]{}=&#34;var3-pair-val&#34;;&#xA;%{\ar{-};&#34;var3-pair-c&#34;;&#34;var3-pair-var&#34;};&#xA;%{\ar{-};(0,0);p!R+/dl+1.5cm/|(1.2){\texttt{(x y)}}};&#xA;%{\ar{-};(1,0);p!R+/dr+1.5cm/|(1.2){\texttt{(88 99)}}};&#xA;%\end{xy}&#xA;$&lt;/p&gt;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;  &lt;div class=&#34;svg-container&#34;&gt;&#xD;&#xA;    &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;no&#34;?&gt;&#xA;&lt;svg&#xA;   style=&#34;vertical-align: -13.186ex;&#34;&#xA;   width=&#34;90.34ex&#34;&#xA;   height=&#34;16.424ex&#34;&#xA;   role=&#34;img&#34;&#xA;   focusable=&#34;false&#34;&#xA;   viewBox=&#34;0 -1431.4 39930.3 7259.5&#34;&#xA;   aria-hidden=&#34;true&#34;&#xA;   version=&#34;1.1&#34;&#xA;   id=&#34;svg1307&#34;&#xA;   sodipodi:docname=&#34;Xer2.11.svg&#34;&#xA;   inkscape:version=&#34;1.1.1 (3bf5ae0d25, 2021-09-20)&#34;&#xA;   xmlns:inkscape=&#34;http://www.inkscape.org/namespaces/inkscape&#34;&#xA;   xmlns:sodipodi=&#34;http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd&#34;&#xA;   xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&#xA;   xmlns=&#34;http://www.w3.org/2000/svg&#34;&#xA;   xmlns:svg=&#34;http://www.w3.org/2000/svg&#34;&gt;&#xA;  &lt;sodipodi:namedview&#xA;     id=&#34;namedview1309&#34;&#xA;     pagecolor=&#34;#ffffff&#34;&#xA;     bordercolor=&#34;#666666&#34;&#xA;     borderopacity=&#34;1.0&#34;&#xA;     inkscape:pageshadow=&#34;2&#34;&#xA;     inkscape:pageopacity=&#34;0.0&#34;&#xA;     inkscape:pagecheckerboard=&#34;0&#34;&#xA;     showgrid=&#34;false&#34;&#xA;     inkscape:zoom=&#34;0.032882297&#34;&#xA;     inkscape:cx=&#34;19965.15&#34;&#xA;     inkscape:cy=&#34;3634.1743&#34;&#xA;     inkscape:window-width=&#34;1920&#34;&#xA;     inkscape:window-height=&#34;992&#34;&#xA;     inkscape:window-x=&#34;-8&#34;&#xA;     inkscape:window-y=&#34;-8&#34;&#xA;     inkscape:window-maximized=&#34;1&#34;&#xA;     inkscape:current-layer=&#34;svg1307&#34; /&gt;&#xA;  &lt;defs&#xA;     id=&#34;defs853&#34;&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-62&#34;&#xA;       d=&#34;M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-61&#34;&#xA;       d=&#34;M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-63&#34;&#xA;       d=&#34;M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-6B&#34;&#xA;       d=&#34;M36 46H50Q89 46 97 60V68Q97 77 97 91T97 124T98 167T98 217T98 272T98 329Q98 366 98 407T98 482T98 542T97 586T97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V463L180 233L240 287Q300 341 304 347Q310 356 310 364Q310 383 289 385H284V431H293Q308 428 412 428Q475 428 484 431H489V385H476Q407 380 360 341Q286 278 286 274Q286 273 349 181T420 79Q434 60 451 53T500 46H511V0H505Q496 3 418 3Q322 3 307 0H299V46H306Q330 48 330 65Q330 72 326 79Q323 84 276 153T228 222L176 176V120V84Q176 65 178 59T189 49Q210 46 238 46H254V0H246Q231 3 137 3T28 0H20V46H36Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-6F&#34;&#xA;       d=&#34;M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-6E&#34;&#xA;       d=&#34;M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-65&#34;&#xA;       d=&#34;M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-72&#34;&#xA;       d=&#34;M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-73&#34;&#xA;       d=&#34;M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-74&#34;&#xA;       d=&#34;M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-20&#34;&#xA;       d=&#34;&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-66&#34;&#xA;       d=&#34;M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-76&#34;&#xA;       d=&#34;M338 431Q344 429 422 429Q479 429 503 431H508V385H497Q439 381 423 345Q421 341 356 172T288 -2Q283 -11 263 -11Q244 -11 239 -2Q99 359 98 364Q93 378 82 381T43 385H19V431H25L33 430Q41 430 53 430T79 430T104 429T122 428Q217 428 232 431H240V385H226Q187 384 184 370Q184 366 235 234L286 102L377 341V349Q377 363 367 372T349 383T335 385H331V431H338Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-28&#34;&#xA;       d=&#34;M437 -53Q437 -82 399 -82H394Q377 -82 342 -55Q259 7 213 102T166 306Q166 412 211 507T342 667Q377 694 393 694H399Q437 694 437 665Q437 654 426 643T397 620T356 584T311 525Q301 511 290 488T264 412T250 306Q250 191 300 105T422 -27Q437 -37 437 -53Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D68A&#34;&#xA;       d=&#34;M126 306Q105 306 90 321T74 359Q74 439 211 439Q268 439 276 438Q343 426 383 390T430 306Q431 301 431 190V81Q446 79 465 78T492 76T509 72T521 60T524 38Q524 11 506 3Q502 1 466 1Q426 1 406 5T379 14T355 36L345 30Q284 -6 205 -6Q135 -6 92 39T48 141Q48 182 79 212T158 256T252 278T342 285H347V290Q347 315 325 335T267 362Q258 363 224 363Q189 363 185 362H179L178 358Q178 353 178 352T176 345T174 337T170 330T165 322T158 316T150 311T139 308T126 306ZM132 140Q132 115 157 93T224 70Q269 70 302 87T344 133Q346 139 347 175V211H339Q256 209 194 190T132 140Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-20&#34;&#xA;       d=&#34;&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D68B&#34;&#xA;       d=&#34;M4 573Q4 596 15 603T52 611H90H124Q146 611 155 608T171 591Q173 586 173 491V396L182 402Q217 424 256 431Q280 437 309 437Q376 437 434 379T492 217Q492 162 473 118T422 47T358 8T293 -6Q229 -6 174 38Q171 13 163 7T135 1H131H122Q99 1 90 23L89 279V535H58L27 536Q4 543 4 573ZM409 215Q409 269 377 315T283 361Q255 361 224 344T177 297L173 290V167Q189 124 213 97T278 70Q330 70 369 111T409 215Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D68C&#34;&#xA;       d=&#34;M291 -6Q196 -6 131 60T66 216Q66 296 119 361Q154 403 200 421T273 439Q275 440 293 440H313Q400 440 433 409Q454 388 454 359Q454 335 439 321T402 306Q380 306 365 321T350 357V362L340 363Q339 363 326 363T303 364Q280 364 266 362Q217 352 184 313T151 215Q151 153 199 112T313 70Q341 70 357 85T381 118T394 140Q402 146 424 146Q443 146 447 144Q466 137 466 117Q466 106 457 88T429 47T374 10T291 -6Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-29&#34;&#xA;       d=&#34;M87 664Q87 694 126 694Q138 694 147 690T183 667Q266 605 312 510T358 306Q358 193 307 93T161 -70Q142 -82 126 -82Q105 -82 96 -73T87 -53Q87 -47 88 -44Q92 -36 116 -19T173 34T230 119Q273 206 273 306Q273 408 231 494T109 635Q87 649 87 664Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7F7&#34;&#xA;       d=&#34;M99 461Q99 470 99 474T104 487T120 498T151 502Q213 517 251 596Q264 622 283 622Q308 622 319 597V76H373H401Q428 76 439 69T450 38Q450 11 428 1H127Q104 10 104 38Q104 62 115 69T153 76H181H235V269Q235 461 234 461Q184 426 137 424H133Q124 424 119 425T109 431T99 447V461Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7F8&#34;&#xA;       d=&#34;M52 462Q52 528 110 575T247 622H250Q343 622 407 565T472 421Q472 371 446 324T390 248T308 178Q307 177 275 151T214 101L185 77Q185 76 286 76H388V87Q388 105 397 114T430 123T463 114Q470 107 471 100T472 61V42Q472 24 468 16T450 1H75Q53 10 53 32V38V48Q53 57 63 67T127 122Q153 144 169 157L289 256Q388 345 388 419Q388 473 346 509T231 545H224Q176 545 146 499L144 494Q155 476 155 459Q154 459 155 455T154 444T148 430T136 417T114 408Q113 408 110 408T104 407Q80 407 66 422T52 462Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7F9&#34;&#xA;       d=&#34;M260 546Q233 546 211 541T180 531T171 524L174 514Q177 505 177 497Q177 476 162 461T125 446Q106 446 90 459T73 504Q76 540 98 565T150 601T203 616T239 621Q241 622 265 622Q322 620 362 602T420 558T444 513T451 478Q451 386 369 329L375 326Q381 323 386 320T401 311T419 298T436 283T452 263T466 240T475 212T479 180Q479 99 416 44T259 -11T105 28T44 130Q44 154 59 168T95 183Q117 183 132 169T148 131Q148 119 139 101Q175 65 260 65Q316 65 355 97T395 179Q395 211 375 240Q336 292 253 292H234H215Q194 292 185 299T175 330Q175 350 184 359Q192 368 238 370T309 384Q336 398 351 423T367 474Q367 496 350 513Q321 546 260 546Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D6A1&#34;&#xA;       d=&#34;M35 393Q35 417 46 424T89 432Q95 432 112 432T141 431H223Q238 422 241 415T244 393Q244 389 244 383T237 367T216 355Q209 355 209 354L234 319Q259 286 260 286L308 354Q308 355 301 355Q285 356 278 365T270 384L271 393Q271 420 289 428Q295 431 376 431H459Q460 430 465 427T472 422T476 416T480 407T481 393Q481 368 470 362T434 355H425H392L344 290Q295 225 295 223Q294 223 309 203T350 149L405 77L439 76H453Q474 76 484 69T495 38Q495 10 473 1H303Q281 9 281 32V38Q281 49 282 54T290 67T313 76Q324 76 324 77L259 173L197 77Q202 76 209 76Q225 75 233 68T241 55T242 38Q242 28 242 24T236 12T221 1H51Q29 9 29 32V38Q29 48 29 51T31 59T38 67T51 76H117L171 149Q224 222 224 223L124 355H90H78Q54 355 45 361T35 393Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D6A3&#34;&#xA;       d=&#34;M56 1Q40 7 37 14T34 41Q34 59 36 64Q39 67 43 73Q65 95 191 213T341 355H133V334Q133 306 124 297Q116 289 91 289H83Q60 289 51 308Q49 313 49 361L50 409Q59 427 72 430H78Q83 430 92 430T115 430T144 430T179 431T219 431T262 431H450Q452 430 455 428T459 424T463 422T466 419T468 416T469 413T470 409T471 404T472 398T472 391Q472 374 469 368L462 358Q453 349 315 218Q210 122 164 76H391V103Q391 136 400 146Q409 155 433 155Q464 155 473 135Q475 130 475 78V46Q475 24 472 16T453 1H56Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7FC&#34;&#xA;       d=&#34;M357 536Q357 546 318 546Q258 546 205 497T133 357V353L144 361Q210 402 285 402Q362 402 414 350Q479 285 479 193Q479 111 418 50T263 -11Q234 -11 207 -3T149 26T97 81T60 171T45 301Q45 444 129 533T319 622Q388 622 421 589T454 510Q454 491 442 475T402 458Q373 458 362 475T350 510Q350 520 354 528L357 536ZM319 326T269 326T179 298T136 223Q136 202 143 174T176 112T237 68Q246 66 265 66Q319 66 360 107Q395 146 395 197Q395 250 356 289Q319 326 269 326Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7FD&#34;&#xA;       d=&#34;M204 -10Q162 -10 162 40Q162 146 198 261T310 477Q311 478 321 491T342 517T358 535H128V524Q128 506 119 497Q111 489 86 489H78Q55 489 46 508Q44 513 44 557V580Q44 605 52 616T88 627H93Q114 627 125 611H458Q474 598 477 593T480 573Q480 559 478 553T469 543T446 521T408 477Q252 290 246 49Q246 43 246 37T246 27T245 22Q243 11 233 1T204 -10Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D6A2&#34;&#xA;       d=&#34;M26 393Q26 417 37 424T80 431H134H217Q232 422 235 416T239 393Q239 379 236 371T226 360T214 356T197 355L179 354V353L188 330Q197 306 209 272T235 201T259 133T271 89V84L274 95Q279 122 298 185T335 300T352 354Q352 355 331 355Q312 355 304 358Q288 368 288 393Q288 408 291 415T310 431H478Q479 430 484 427T491 422T495 416T499 407T500 393Q500 376 493 367T479 357T458 355H452Q426 355 425 353Q420 337 351 124T280 -94Q240 -195 168 -220Q147 -228 125 -228Q89 -228 66 -201T42 -139Q42 -116 56 -102T93 -87Q117 -87 130 -102T144 -135V-138H126Q121 -148 121 -150T130 -152Q182 -147 207 -87Q211 -78 223 -40T236 1Q230 10 102 355H75L49 356Q26 363 26 393Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7FE&#34;&#xA;       d=&#34;M58 460Q58 523 117 572T254 621Q290 621 298 620Q376 607 421 560T466 460Q466 441 460 424T443 393T421 370T397 352T374 340T357 332L350 330L356 328Q363 325 371 321T392 310T415 295T439 274T459 249T473 217T479 179Q479 102 418 46T262 -10T106 46T45 179Q45 202 52 222T70 257T96 284T123 305T148 319T167 328L174 330L170 332Q166 333 159 336T145 343Q104 362 81 393T58 460ZM382 458Q382 491 349 518T263 546Q215 546 179 521T142 458Q142 421 178 395T262 368Q315 368 348 396T382 458ZM396 178Q396 223 358 257T263 292Q206 292 167 258T128 178Q128 137 163 102T262 66Q324 66 360 101T396 178Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7FF&#34;&#xA;       d=&#34;M392 259Q333 210 236 210H233Q163 210 109 262Q46 325 46 411T99 550Q164 622 264 622Q293 622 319 615T376 587T428 532T464 440T479 304Q479 167 400 78T217 -11Q140 -11 105 22T70 101Q70 124 84 138T122 153Q150 153 162 137T174 101Q174 91 168 76Q179 65 216 65Q267 65 300 93Q322 109 339 130T366 173T380 210T388 242T392 259ZM388 389Q388 438 357 492T268 546T185 520Q129 479 129 415Q129 384 138 363Q145 349 156 334T195 302T255 285Q305 285 345 313T388 389Z&#34; /&gt;&#xA;  &lt;/defs&gt;&#xA;  &lt;g&#xA;     data-mml-node=&#34;math&#34;&#xA;     id=&#34;g1303&#34;&#xA;     transform=&#34;matrix(1,0,0,-1,-2568.9982,0)&#34;&#xA;     style=&#34;fill:#000000;stroke:#000000;stroke-width:0&#34;&gt;&#xA;    &lt;g&#xA;       data-mml-node=&#34;mstyle&#34;&#xA;       id=&#34;g857&#34;&gt;&#xA;      &lt;g&#xA;         data-mml-node=&#34;mspace&#34;&#xA;         id=&#34;g855&#34; /&gt;&#xA;    &lt;/g&gt;&#xA;    &lt;g&#xA;       data-mml-node=&#34;mstyle&#34;&#xA;       transform=&#34;translate(2000)&#34;&#xA;       id=&#34;g861&#34;&gt;&#xA;      &lt;g&#xA;         data-mml-node=&#34;mspace&#34;&#xA;         id=&#34;g859&#34; /&gt;&#xA;    &lt;/g&gt;&#xA;    &lt;g&#xA;       data-mml-node=&#34;xypic&#34;&#xA;       data-cmd-id=&#34;0&#34;&#xA;       data-text-mml-ids=&#34;[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]&#34;&#xA;       transform=&#34;translate(4000)&#34;&#xA;       id=&#34;g1301&#34;&gt;&#xA;      &lt;g&#xA;         fill=&#34;none&#34;&#xA;         stroke=&#34;currentColor&#34;&#xA;         stroke-linecap=&#34;round&#34;&#xA;         stroke-width=&#34;0.64&#34;&#xA;         transform=&#34;matrix(62.5,0,0,-62.5,4101.5,250)&#34;&#xA;         id=&#34;g987&#34;&gt;&#xA;        &lt;rect&#xA;           x=&#34;-8&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect863&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;8&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect865&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;162.88&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect867&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;178.88&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect869&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;16&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;162.88&#34;&#xA;           y2=&#34;0&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line871&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(162.88)&#34;&#xA;           id=&#34;g877&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path873&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path875&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(0,-10.25)&#34;&#xA;           id=&#34;g879&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;333.76001&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect881&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;349.76001&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect883&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;186.88&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;333.76001&#34;&#xA;           y2=&#34;0&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line885&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(333.76)&#34;&#xA;           id=&#34;g891&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path887&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path889&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(0,-10.25)&#34;&#xA;           id=&#34;g893&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;357.76001&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;450.72&#34;&#xA;           y2=&#34;0&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line895&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(450.72)&#34;&#xA;           id=&#34;g901&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path897&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path899&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;rect&#xA;           x=&#34;-8&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect903&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;8&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect905&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;0&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;0&#34;&#xA;           y2=&#34;38.400002&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line907&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(90,-19.2,19.2)&#34;&#xA;           id=&#34;g913&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path909&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path911&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;0&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;-32.720001&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line915&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(135,-32.809928,32.809827)&#34;&#xA;           id=&#34;g921&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path917&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path919&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;16&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;48.720001&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line923&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(45,-71.209928,98.523882)&#34;&#xA;           id=&#34;g929&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path925&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path927&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;rect&#xA;           x=&#34;162.88&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect931&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;178.88&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect933&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;170.88&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;170.88&#34;&#xA;           y2=&#34;38.400002&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line935&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(90,66.24,104.64)&#34;&#xA;           id=&#34;g941&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path937&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path939&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;170.88&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;138.16&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line943&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(135,52.630072,68.200233)&#34;&#xA;           id=&#34;g949&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path945&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path947&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;186.88&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;219.60001&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line951&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(45,14.230072,304.79429)&#34;&#xA;           id=&#34;g957&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path953&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path955&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;rect&#xA;           x=&#34;333.76001&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect959&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;349.76001&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect961&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;341.76001&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;341.76001&#34;&#xA;           y2=&#34;38.400002&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line963&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(90,151.68,190.08)&#34;&#xA;           id=&#34;g969&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path965&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path967&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;341.76001&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;309.87&#34;&#xA;           y2=&#34;78.290001&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line971&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(135,138.07007,103.59064)&#34;&#xA;           id=&#34;g977&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path973&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path975&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;357.76001&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;390.48001&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line979&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(45,99.670072,511.0647)&#34;&#xA;           id=&#34;g985&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path981&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path983&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;0&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;0&#34;&#xA;         transform=&#34;translate(4101.5,250)&#34;&#xA;         id=&#34;g997&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g995&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g993&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g991&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g989&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;1&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;1&#34;&#xA;         transform=&#34;translate(5101.5,250)&#34;&#xA;         id=&#34;g1007&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1005&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1003&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1001&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g999&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;10.68&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;2&#34;&#xA;         transform=&#34;translate(14781.5,250)&#34;&#xA;         id=&#34;g1017&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1015&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1013&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1011&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1009&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;11.68&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;3&#34;&#xA;         transform=&#34;translate(15781.5,250)&#34;&#xA;         id=&#34;g1027&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1025&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1023&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1021&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1019&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;4.396087952817069&#34;&#xA;         data-y=&#34;-0.39919953083036164&#34;&#xA;         data-xypic-id=&#34;4&#34;&#xA;         transform=&#34;translate(8497.5,649.2)&#34;&#xA;         id=&#34;g1049&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1047&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1045&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;62&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-62&#34;&#xA;               id=&#34;use1029&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;61&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-61&#34;&#xA;               transform=&#34;translate(556)&#34;&#xA;               id=&#34;use1031&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;63&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-63&#34;&#xA;               transform=&#34;translate(1056)&#34;&#xA;               id=&#34;use1033&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6B&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6B&#34;&#xA;               transform=&#34;translate(1500)&#34;&#xA;               id=&#34;use1035&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;62&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-62&#34;&#xA;               transform=&#34;translate(2028)&#34;&#xA;               id=&#34;use1037&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6F&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6F&#34;&#xA;               transform=&#34;translate(2584)&#34;&#xA;               id=&#34;use1039&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6E&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6E&#34;&#xA;               transform=&#34;translate(3084)&#34;&#xA;               id=&#34;use1041&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;65&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-65&#34;&#xA;               transform=&#34;translate(3640)&#34;&#xA;               id=&#34;use1043&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;21.36&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;5&#34;&#xA;         transform=&#34;translate(25461.5,250)&#34;&#xA;         id=&#34;g1059&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1057&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1055&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1053&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1051&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;22.36&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;6&#34;&#xA;         transform=&#34;translate(26461.5,250)&#34;&#xA;         id=&#34;g1069&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1067&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1065&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1063&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1061&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;15.076087952817069&#34;&#xA;         data-y=&#34;-0.39919953083036164&#34;&#xA;         data-xypic-id=&#34;7&#34;&#xA;         transform=&#34;translate(19177.5,649.2)&#34;&#xA;         id=&#34;g1091&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1089&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1087&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;62&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-62&#34;&#xA;               id=&#34;use1071&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;61&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-61&#34;&#xA;               transform=&#34;translate(556)&#34;&#xA;               id=&#34;use1073&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;63&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-63&#34;&#xA;               transform=&#34;translate(1056)&#34;&#xA;               id=&#34;use1075&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6B&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6B&#34;&#xA;               transform=&#34;translate(1500)&#34;&#xA;               id=&#34;use1077&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;62&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-62&#34;&#xA;               transform=&#34;translate(2028)&#34;&#xA;               id=&#34;use1079&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6F&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6F&#34;&#xA;               transform=&#34;translate(2584)&#34;&#xA;               id=&#34;use1081&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6E&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6E&#34;&#xA;               transform=&#34;translate(3084)&#34;&#xA;               id=&#34;use1083&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;65&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-65&#34;&#xA;               transform=&#34;translate(3640)&#34;&#xA;               id=&#34;use1085&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;28.33862675168815&#34;&#xA;         data-y=&#34;0.24536605307173198&#34;&#xA;         data-xypic-id=&#34;8&#34;&#xA;         transform=&#34;translate(32440.1,4.6)&#34;&#xA;         id=&#34;g1121&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1119&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1117&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mtext&#34;&#xA;               id=&#34;g1115&#34;&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;72&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-72&#34;&#xA;                 id=&#34;use1093&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;65&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-65&#34;&#xA;                 transform=&#34;translate(392)&#34;&#xA;                 id=&#34;use1095&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;73&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-73&#34;&#xA;                 transform=&#34;translate(836)&#34;&#xA;                 id=&#34;use1097&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;74&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-74&#34;&#xA;                 transform=&#34;translate(1230)&#34;&#xA;                 id=&#34;use1099&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;20&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-20&#34;&#xA;                 transform=&#34;translate(1619)&#34;&#xA;                 id=&#34;use1101&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;6F&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-6F&#34;&#xA;                 transform=&#34;translate(1869)&#34;&#xA;                 id=&#34;use1103&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;66&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-66&#34;&#xA;                 transform=&#34;translate(2369)&#34;&#xA;                 id=&#34;use1105&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;20&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-20&#34;&#xA;                 transform=&#34;translate(2675)&#34;&#xA;                 id=&#34;use1107&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;65&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-65&#34;&#xA;                 transform=&#34;translate(2925)&#34;&#xA;                 id=&#34;use1109&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;6E&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-6E&#34;&#xA;                 transform=&#34;translate(3369)&#34;&#xA;                 id=&#34;use1111&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;76&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-76&#34;&#xA;                 transform=&#34;translate(3925)&#34;&#xA;                 id=&#34;use1113&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;1.6653345369377348e-16&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;9&#34;&#xA;         transform=&#34;translate(4101.5,-2650)&#34;&#xA;         id=&#34;g1131&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1129&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1127&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1125&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1123&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;1.0000000000000002&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;10&#34;&#xA;         transform=&#34;translate(5101.5,-2650)&#34;&#xA;         id=&#34;g1141&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1139&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1137&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1135&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1133&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;-3.7600403089594656&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;11&#34;&#xA;         transform=&#34;translate(341.4,-5327.1)&#34;&#xA;         id=&#34;g1161&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1159&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1157&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1143&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D68A&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D68A&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1145&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1147&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D68B&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D68B&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1149&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1151&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D68C&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D68C&#34;&#xA;               transform=&#34;translate(2625)&#34;&#xA;               id=&#34;use1153&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(3150)&#34;&#xA;               id=&#34;use1155&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;1.6045762979144977&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;12&#34;&#xA;         transform=&#34;translate(5706,-5327.1)&#34;&#xA;         id=&#34;g1187&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1185&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1183&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1163&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F7&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F7&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1165&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F7&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F7&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1167&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1169&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F7&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F7&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1171&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F8&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F8&#34;&#xA;               transform=&#34;translate(2625)&#34;&#xA;               id=&#34;use1173&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(3150)&#34;&#xA;               id=&#34;use1175&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F7&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F7&#34;&#xA;               transform=&#34;translate(3675)&#34;&#xA;               id=&#34;use1177&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F9&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F9&#34;&#xA;               transform=&#34;translate(4200)&#34;&#xA;               id=&#34;use1179&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(4725)&#34;&#xA;               id=&#34;use1181&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;10.68&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;13&#34;&#xA;         transform=&#34;translate(14781.5,-2650)&#34;&#xA;         id=&#34;g1197&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1195&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1193&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1191&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1189&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;11.68&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;14&#34;&#xA;         transform=&#34;translate(15781.5,-2650)&#34;&#xA;         id=&#34;g1207&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1205&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1203&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1201&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1199&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;7.291190751163471&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;15&#34;&#xA;         transform=&#34;translate(11392.7,-5327.1)&#34;&#xA;         id=&#34;g1223&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1221&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1219&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1209&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D6A1&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D6A1&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1211&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1213&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D6A3&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D6A3&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1215&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1217&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;12.841422888098903&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;16&#34;&#xA;         transform=&#34;translate(16942.9,-5327.1)&#34;&#xA;         id=&#34;g1243&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1241&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1239&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1225&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FC&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FC&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1227&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FC&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FC&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1229&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1231&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FD&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FD&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1233&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FD&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FD&#34;&#xA;               transform=&#34;translate(2625)&#34;&#xA;               id=&#34;use1235&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(3150)&#34;&#xA;               id=&#34;use1237&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;21.36&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;17&#34;&#xA;         transform=&#34;translate(25461.5,-2650)&#34;&#xA;         id=&#34;g1253&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1251&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1249&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1247&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1245&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;22.36&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;18&#34;&#xA;         transform=&#34;translate(26461.5,-2650)&#34;&#xA;         id=&#34;g1263&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1261&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1259&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1257&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1255&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;17.97119075116347&#34;&#xA;         data-y=&#34;5.52548747854565&#34;&#xA;         data-xypic-id=&#34;19&#34;&#xA;         transform=&#34;translate(22072.7,-5275.5)&#34;&#xA;         id=&#34;g1279&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1277&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1275&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1265&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D6A1&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D6A1&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1267&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1269&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D6A2&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D6A2&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1271&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1273&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;23.521422888098904&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;20&#34;&#xA;         transform=&#34;translate(27622.9,-5327.1)&#34;&#xA;         id=&#34;g1299&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1297&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1295&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1281&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FE&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FE&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1283&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FE&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FE&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1285&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1287&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FF&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FF&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1289&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FF&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FF&#34;&#xA;               transform=&#34;translate(2625)&#34;&#xA;               id=&#34;use1291&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(3150)&#34;&#xA;               id=&#34;use1293&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;    &lt;/g&gt;&#xA;  &lt;/g&gt;&#xA;&lt;/svg&gt;&#xA;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;  &lt;style&gt;&#xD;&#xA;    .svg-container {&#xD;&#xA;      display: inline-block;&#xD;&#xA;      width: 100%;&#xD;&#xA;      max-width: 100%;&#xD;&#xA;      height: auto;&#xD;&#xA;      overflow-x: auto;&#xD;&#xA;      overflow-y: hidden;&#xD;&#xA;    }&#xD;&#xA;    .svg-container svg {&#xD;&#xA;      width: auto;&#xD;&#xA;      height: auto;&#xD;&#xA;      &#xD;&#xA;      &#xD;&#xA;    }&#xD;&#xA;  &lt;/style&gt;&#xD;&#xA;&#xA;&lt;p&gt;该表示法称作是&lt;strong&gt;肋排 ribcage&lt;/strong&gt; 表示法 , 环境由名为&lt;strong&gt;肋骨 rib&lt;/strong&gt; 的有序对列表表示 , 每根左肋指向&#xA;变量列表而右肋则指向变量列表对应的值的列表 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;S2.2.3&#34;&gt;&lt;span&gt;2.2.3 过程表示法&lt;/span&gt;&#xA;  &lt;a href=&#34;#S2.2.3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;注意到环境接口有一个重要性质 : 它的观测器只有一个 , 即 &lt;code&gt;apply-env&lt;/code&gt;  。&#xA;这意味着仅利用以变量为实参并返回绑定值的 Scheme 过程便可以表示环境 。&lt;/p&gt;&#xA;&lt;p&gt;若要使用此方式表示环境则 &lt;code&gt;empty-env&lt;/code&gt; 和 &lt;code&gt;extend-env&lt;/code&gt; 就应该返回一个过程 :&#xA;这个过程在被调用时行为将和&lt;a href=&#34;#G2.1&#34;&gt;上一节提到的 &lt;code&gt;apply-env&lt;/code&gt;&lt;/a&gt; 一样 。&#xA;如此我们便可得出下述实现 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; Env = Var -&amp;gt; SchemeVal&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; empty-env : () -&amp;gt; Env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;empty-env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;report-no-binding-found&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; extend-env : Var × SchemeVal × Env → Env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;extend-env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;saved-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;saved-val&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;saved-env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;saved-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;nv&#34;&gt;saved-val&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;apply-env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;saved-env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; apply-env : Env × Var → SchemeVal&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;apply-env&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;env&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;如果空环境由 &lt;code&gt;empty-env&lt;/code&gt; 所创建且被传入了任何可能的参数 , 那么该环境便会抛出错误并&#xA;指明给定的变量不位于该环境中 。过程 &lt;code&gt;extend-env&lt;/code&gt; 返回的过程则是代表了被扩充的环境 :&#xA;若该环境被传入变量 &lt;code&gt;search-var&lt;/code&gt;  则该环境会检查该变量是否与环境中已绑定的变量相同 :&#xA;如果是则返回保存的值 , 否则则在已保存的环境中查找它 。&lt;/p&gt;&#xA;&lt;p&gt;上述表示法称作&lt;strong&gt;过程表示法 procedual representation&lt;/strong&gt; , 其中的数据皆被表示为 &lt;code&gt;apply-env&lt;/code&gt;&#xA;所执行的动作 。&lt;/p&gt;&#xA;&lt;p&gt;只有一个观测器的数据类型并非大家所想的那般罕见 , 如 : 当数据被表示为一组函数时 , 那么&#xA;它们就可以用自身被应用的这个动作作为表示 。这种情况下可以遵循下述步骤提取出对应的&#xA;接口以及对应过程的表示 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;找出用户代码中那些返回结果类型为指定类型的 $\texttt{lambda}$ 演算表达式 , 并为每个这样的&#xA;$\texttt{lambda}$ 演算表达式都写一个构造器过程 :   构造器过程接收的参数将会是 $\texttt{lambda}$ 演算&#xA;表达式中的自由变量 。在用户代码中用构造器调用替换对应的 $\texttt{lambda}$ 演算表达式 。&lt;/li&gt;&#xA;&lt;li&gt;像定义 &lt;code&gt;apply-env&lt;/code&gt; 那样去定义一个 &lt;code&gt;apply-&lt;/code&gt; 过程 。找出用户代码中所有有用到指定&#xA;类型值的地方 , 包括构造器过程的主体 。所有用到指定类型值的地方都改用  &lt;code&gt;apply-&lt;/code&gt; 过程 。&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;一旦完成上面的步骤 , 那么接口将只含构造器过程以及 &lt;code&gt;apply-&lt;/code&gt; 过程 , 并且用户代码将会是&#xA;表示无关的 : 它将不再依赖表示 , 我们可以随意换用其他接口的实现 —— 正如 &lt;a href=&#34;S2.2.2&#34;&gt;2.2.2 节&lt;/a&gt;所述 。&lt;/p&gt;&#xA;&lt;p&gt;若用于实现的语言不支持高阶过程则得再做进一步处理 : 用数据结构表示法和解释器配方来&#xA;实现所需的接口 , 就像&lt;a href=&#34;#G2.1&#34;&gt;上一节&lt;/a&gt;所描述的那样 。这样的操作叫做&lt;strong&gt;去函数化 defunctionalization&lt;/strong&gt; ,&#xA;环境的各种不同的数据结构表示法都是去函数化的简单例子 。过程表示法与去函数化表示法&#xA;间的关系将会是本书反复出现的主题 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.12&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.12&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;用过程表示法实现&lt;a href=&#34;#Xer2.4&#34;&gt;练习 2.4&lt;/a&gt; 中的栈数据类型 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.13&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.13&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;扩展过程表示法以实现 &lt;code&gt;empty-env?&lt;/code&gt; —— 利用两个过程组成的列表来表示环境 :&#xA;一个过程像前面那样返回变量所对应的绑定值 , 另一个则判断环境是否为空环境 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.14&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.14&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;扩展上题中的表示法 , 加入第三个过程并用它实现 &lt;code&gt;has-binding?&lt;/code&gt; ( 见&lt;a href=&#34;#Xer2.9&#34;&gt;练习 2.9&lt;/a&gt; ) 。&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;S2.3&#34;&gt;&lt;span&gt;2.3 递归数据类型的接口&lt;/span&gt;&#xA;  &lt;a href=&#34;#S2.3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;第一章我们都在操纵递归数据类型 , 比如 : 在&lt;a href=&#34;http://localhost:1313/posts/5cce8df/#Def1.1.8&#34;&gt;定义 1.1.8&lt;/a&gt; 给出了 $\texttt{lambda}$ 演算表达式的语法 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\LcExp   ::={}&amp; &#xA;\Iden \\ ::={}&amp;&#xA;\texttt{(lambda (\Iden) \LcExp)} \\::={}&amp;&#xA;\texttt{(\LcExp  \LcExp)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;并且还给出了如 &lt;code&gt;occurs-free?&lt;/code&gt; 这样的过程 。正如当时所述 , &lt;a href=&#34;http://localhost:1313/posts/5cce8df/#S1.2.4&#34;&gt;1.2.4 节&lt;/a&gt;的 &lt;code&gt;occurs-free?&lt;/code&gt;&#xA;的定义可能并非那么易懂 , 如 : 我们很难猜到 &lt;code&gt;(car (cadr exp))&lt;/code&gt; 指代的是 $\texttt{lambda}$ 演算&#xA;表达式的变量声明 , 以及 &lt;code&gt;(caddr exp)&lt;/code&gt; 指代的是 $\texttt{lambda}$ 演算表达式的主体 , 等等 。&lt;/p&gt;&#xA;&lt;p&gt;我们可通过为 $\texttt{lambda}$ 演算表达式添加一套接口以改善这种现状 : 我们的接口将会有一系列&#xA;构造器以及两种观测器 : &lt;strong&gt;谓词 predicate&lt;/strong&gt; 和&lt;strong&gt;提取器 extractor&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;构造器有 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;&amp;\texttt{var-exp}&#xA;&amp;{}:{}&#xA;&amp;\Var\to \LcExp &#xA;\\&#xA;&amp;\texttt{lambda-exp}&#xA;&amp;{}:{}&#xA;&amp;\Var\times\LcExp \to \LcExp&#xA;\\&#xA;&amp;\texttt{app-exp}&#xA;&amp;{}:{}&#xA;&amp;\LcExp\times\LcExp \to \LcExp&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;谓词有 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;&amp;\texttt{var-exp?}&#xA;&amp;{}:{}&#xA;&amp;\LcExp \to \Bool&#xA;\\&#xA;&amp;\texttt{lambda-exp?}&#xA;&amp;{}:{}&#xA;&amp;\LcExp \to \Bool&#xA;\\&#xA;&amp;\texttt{app-exp?}&#xA;&amp;{}:{}&#xA;&amp;\LcExp \to \Bool&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;最后 , 提取器有 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;&amp;\texttt{var-exp-&gt;var}&#xA;&amp;{}:{}&#xA;&amp;\LcExp \to \Var&#xA;\\&#xA;&amp;\texttt{lambda-exp-&gt;bound-var}&#xA;&amp;{}:{}&#xA;&amp;\LcExp \to \Var&#xA;\\&#xA;&amp;\texttt{lambda-exp-&gt;body}&#xA;&amp;{}:{}&#xA;&amp;\LcExp \to \LcExp&#xA;\\&#xA;&amp;\texttt{app-exp-&gt;rator}&#xA;&amp;{}:{}&#xA;&amp;\LcExp \to \LcExp&#xA;\\&#xA;&amp;\texttt{app-exp-&gt;rand}&#xA;&amp;{}:{}&#xA;&amp;\LcExp \to \LcExp&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;各个提取器对应 $\texttt{lambda}$ 演算表达式中的各个组成部分 。&#xA;我们现在可以写出一个仅依赖接口的 &lt;code&gt;occurs-free?&lt;/code&gt; :&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;S2.3-occurs-free&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; occurs-free? : Sym × LcExp -&amp;gt; Bool&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;occurs-free?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var-exp?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var-exp-&amp;gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lambda-exp?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;and &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;not &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lambda-exp-&amp;gt;bound-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lambda-exp-&amp;gt;body&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;else&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;or &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp-&amp;gt;rator&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp-&amp;gt;rand&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))])))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;这对任何的 $\texttt{lambda}$ 演算表达式的表示法都行得通 —— 只要它们是通过上述构造器构建的 。&lt;/p&gt;&#xA;&lt;p&gt;我们可以写出设计递归数据类型接口的通用步骤 :&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;为递归数据类型设计接口&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;为数据类型的每种变体添加一个构造器 。&lt;/li&gt;&#xA;&lt;li&gt;为数据类型的每种变体添加一个谓词 。&lt;/li&gt;&#xA;&lt;li&gt;为每段传入数据类型构造器的数据都添加一个提取器 。&lt;/li&gt;&#xA;&lt;/ol&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.15&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.15&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;请实现上述 $\texttt{lambda}$ 演算表达式表示法的各个接口 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.16&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.16&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;修改实现以使其适用于另一种表示法 —— 其中 $\texttt{lambda}$ 演算表达式中绑定变量周围不带括号 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.17&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.17&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;请发明至少两种表示法来呈现 $\LcExp$ 数据类型并实现它们 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.18&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.18&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;我们通常将值的序列呈现为列表 , 如此允许我们轻松地从序列的一个元素移动到下一个元素 ;&#xA;但是若不借助语境参数我们很难实现上述操作 。请实现非空的双向整数序列 , 对应的语法为&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]\NodeInSeq ::={}&amp; \texttt{(\Int  \ListOf{\Int} \ListOf{\Int})}\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;第一个整数列表是当前元素之前的序列 , 反向排列 ; 第二个列表是当前元素之后的序列 。例 :&#xA;&lt;code&gt;(6 (5 4 3 2 1) (7 8 9))&lt;/code&gt; 表示列表 &lt;code&gt;(1 2 3 4 5 6 7 8 9)&lt;/code&gt; , 当前元素为 &lt;code&gt;6&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;对于此表示法 , 请实现过程 &lt;code&gt;number-&amp;gt;sequence&lt;/code&gt; —— 它取一数字并生成只含该数字的序列 。&#xA;然后再实现 &lt;code&gt;current-element&lt;/code&gt; , &lt;code&gt;move-to-left&lt;/code&gt; ,  &lt;code&gt;move-to-right&lt;/code&gt; , &lt;code&gt;insert-to-left&lt;/code&gt; ,&#xA;&lt;code&gt;insert-to-right&lt;/code&gt; , &lt;code&gt;at-left-end?&lt;/code&gt; , &lt;code&gt;at-right-end?&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;例如 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number-&amp;gt;sequence&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;current-element&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;move-to-left&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;insert-to-left&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;insert-to-right&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;如果参数在序列的最右端那么过程 &lt;code&gt;move-to-right&lt;/code&gt; 应失败 ;&#xA;如果参数在序列的最左端那么过程 &lt;code&gt;move-to-left&lt;/code&gt; 应失败 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.19&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.19&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;无叶节点的二叉树以及非叶节点全被整数标记的二叉树可表示为下述递归语法&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\BinSearchTree ::={}&amp; \texttt{()} \mid \texttt{(\Int  \BinSearchTree  \BinSearchTree)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;对于此表示法 , 请实现过程 &lt;code&gt;number-&amp;gt;bintree&lt;/code&gt; —— 其取一个整数并产生一颗新的二叉树 ,&#xA;该树的唯一节点被该数字标记 ; 接着实现 &lt;code&gt;current-element&lt;/code&gt; , &lt;code&gt;move-to-left-son&lt;/code&gt; 以及&#xA;&lt;code&gt;move-to-right-son&lt;/code&gt; , &lt;code&gt;at-leaf?&lt;/code&gt; , &lt;code&gt;insert-to-left&lt;/code&gt; 和 &lt;code&gt;insert-to-right&lt;/code&gt; 。例如：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number-&amp;gt;bintree&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;t1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;insert-to-right&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;insert-to-left&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              &#x9;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;insert-to-left&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;t1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;move-to-left&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;current-element&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;move-to-left&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;at-leaf?&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;move-to-right&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;move-to-left&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;insert-to-left&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.20&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.20&lt;/strong&gt; &lt;code&gt;[***]&lt;/code&gt;&lt;br&gt;&#xA;在&lt;a href=&#34;#Xer2.18&#34;&gt;上一道练习&lt;/a&gt;的二叉树中我们很容易从父节点移动到某个子节点 ; 但若无语境参数的辅助&#xA;无法从子节点移动到父节点 。请扩展&lt;a href=&#34;#Xer2.18&#34;&gt;练习 2.18&lt;/a&gt; 中的列表表示法使其表示二叉树中的节点 。&#xA;提示 : 二叉树中当前节点上方的部分可以考虑试着用逆序列表来表示 , 正如&lt;a href=&#34;#Xer2.18&#34;&gt;练习 2.18&lt;/a&gt; 那样 。&lt;/p&gt;&#xA;&lt;p&gt;对于此表示法 , 请实现&lt;a href=&#34;#Xer2.19&#34;&gt;练习 2.19&lt;/a&gt; 中的过程 , 然后实现 &lt;code&gt;move-up&lt;/code&gt; , &lt;code&gt;at-root?&lt;/code&gt; 及 &lt;code&gt;at-leaf?&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;2.4&#34;&gt;&lt;span&gt;2.4 一个定义递归数据类型的工具&lt;/span&gt;&#xA;  &lt;a href=&#34;#2.4&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;对复杂的数据类型应用上述步骤设计接口很容易让人疲乏 。本节将我们将引入一个工具&#xA;用于自动构建和实现诸如上述 Scheme 接口 : 该工具生成的接口虽然与上一节的非常相似 ,&#xA;但它们并非完全一致 。&lt;/p&gt;&#xA;&lt;p&gt;同样考虑&lt;a href=&#34;#S2.3&#34;&gt;上一节的 $\texttt{lambda}$ 演算表达式数据类型&lt;/a&gt; , 我们可以如下实现 $\texttt{lambda}$ 演算表达式&#xA;类型的接口 : &lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;S2.4-lc-exp&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;define-datatype&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lc-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lc-exp?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &#x9;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;identifier?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lambda-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &#x9;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bound-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;identifier?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &#x9;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;body&lt;/span&gt;      &lt;span class=&#34;nv&#34;&gt;lc-exp?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &#x9;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rator&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lc-exp?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &#x9;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rand&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;lc-exp?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;这里的 &lt;code&gt;var-exp&lt;/code&gt; , &lt;code&gt;var&lt;/code&gt; , &lt;code&gt;bound-var&lt;/code&gt; , &lt;code&gt;app-exp&lt;/code&gt; , &lt;code&gt;rator&lt;/code&gt; 以及 &lt;code&gt;rand&lt;/code&gt; 分别为下述单词&#xA;的缩写 : &lt;strong&gt;变量表达式 variable expression&lt;/strong&gt; , &lt;strong&gt;变量 variable&lt;/strong&gt; , &lt;strong&gt;绑定变量 bound variable&lt;/strong&gt; , 以及&#xA;&lt;strong&gt;应用表达式 application expression&lt;/strong&gt; , &lt;strong&gt;操作符 operator&lt;/strong&gt; 以及&lt;strong&gt;操作数 operand&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;该表示法声明了三种构造器 : &lt;code&gt;var-exp&lt;/code&gt; , &lt;code&gt;lambda-exp&lt;/code&gt; , &lt;code&gt;app-exp&lt;/code&gt; 及一个谓词 &lt;code&gt;lc-exp?&lt;/code&gt; 。&#xA;三个构造器用谓词 &lt;code&gt;identifier?&lt;/code&gt; 和 &lt;code&gt;lc-exp?&lt;/code&gt; 以实现对实参合法性的检查 , 故若 $\LcExp$&#xA;仅通过这几个构造器构建 , 我们就可确保其及其所有子表达式都是合法的 $\LcExp$ 。这允许&#xA;我们在处理 $\texttt{lambda}$ 演算表达式时跳过许多检查 。&lt;/p&gt;&#xA;&lt;p&gt;相较于各种谓词和提词器 , 我们还是采用 &lt;code&gt;cases&lt;/code&gt; 形式来判断数据类型的实例属于哪种变体&#xA;并提取出它们的组件 。为解释该形式 ,&#xA;我们将用 $\LcExp$ 数据类型重写&lt;a href=&#34;#S2.3-occurs-free&#34;&gt;过程 &lt;code&gt;occurs-free?&lt;/code&gt; (&#xA;代码在第 43 页&lt;/a&gt; ) :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; occurs-free? : Sym × LcExp -&amp;gt; Bool&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;occurs-free?&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;cases&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lc-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var-exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lambda-exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bound-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;and&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;not &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bound-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rator&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;or&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;要明白这一切 , 需假设 &lt;code&gt;exp&lt;/code&gt; 是个由 &lt;code&gt;app-exp&lt;/code&gt; 构建的 $\texttt{lambda}$ 演算表达式 :  对于这样的&#xA;&lt;code&gt;exp&lt;/code&gt; 的值 , 分支 &lt;code&gt;app-exp&lt;/code&gt; 将被选中并且 &lt;code&gt;rator&lt;/code&gt; 和 &lt;code&gt;rand&lt;/code&gt; 则会被绑定到两个子表达式 ;&#xA;紧接着表达式&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;or&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;将会被求值 , 就如同代码&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rator&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp-&amp;gt;rator&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rand&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp-&amp;gt;rand&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;or&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;最后 &lt;code&gt;occurs-free?&lt;/code&gt; 的递归调用也将以类似的方式完成计算 。&lt;/p&gt;&#xA;&lt;p&gt;一般情况下 &lt;code&gt;define-datatype&lt;/code&gt; 声明具有如下形式 :&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;S2.4-define-datatype&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;&#xA;&lt;p&gt;$\qquad &#xA;\begin{aligned}[t]&#xA;\texttt{(define-datatype \textit{type-name} \textit{type-predicate-name}}\\&#xA;\texttt{${\texttt{(\textit{variant-name}&#xA;$\{\texttt{(\textit{field-name ~predicate})}\}^*$&#xA;)}}^+$)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;这便定义了一种名为 $\textit{type-name}$ 的数据类型 , 它有一些&lt;strong&gt;变体 variant&lt;/strong&gt; : 每个变体有变体名&#xA;以及 $0$ 或多个字段 , 每个字段都有相应的字段名及谓词 。任两个类型都不允许同名并且&#xA;任两个变体都不允许同名 —— 即便它们可能属于同一个类型 。类型名不可被用作变体名 。&#xA;每个字段的谓词必须是一个 Scheme 谓词 。&lt;/p&gt;&#xA;&lt;p&gt;对每个变体都会有一个新的构造器被创建 , 其将用于创建该变体下的项 。如果一个变体&#xA;有 $n$ 个字段那么它的构造器将取 $n$ 个实参 , 将它们分别交给对应的谓词进行处理并返回&#xA;变体值 —— 值的第 $i$ 个字段为第 $i$ 个参数值 。&lt;/p&gt;&#xA;&lt;p&gt;$\textit{type-predicate-name}$ 被绑定到一个谓词上 。该谓词判断实参的值是否属于相应的类型 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;记录表 record&lt;/strong&gt; 为仅含有单种变体的数据类型 。为了区分这种只含单种变体的数据类型&#xA;我们将遵循下述惯例 : 若只有一个变体则以 $\texttt{a-}\textit{type-name}$ 或 $\texttt{an-}\textit{type-name}$ 命名构造器 ,&#xA;否则将以 $\textit{variant-name-type-name}$ 命名构造器 。&lt;/p&gt;&#xA;&lt;p&gt;通过 &lt;code&gt;define-datatype&lt;/code&gt; 生成的数据结构可能是互为递归的 , 如 &lt;a href=&#34;http://localhost:1313/posts/5cce8df/#Def1.1.6&#34;&gt;1.1 节提到的 $\SList$&lt;/a&gt; :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;\SList ::={}&amp; \texttt{(${\SExp}^*$)} \\&#xA;\SExp  ::={}&amp; \Symbol \mid \SList&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;$\SList$ 中的数据可通过数据类型 &lt;code&gt;s-list&lt;/code&gt; 如下表示：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;define-datatype&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-list&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-list?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;empty-s-list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;non-empty-s-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;first&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-exp?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rest&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;s-list?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;define-datatype&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-exp?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;symbol-s-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sym&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;symbol?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;s-list-s-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;slst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-list?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;数据类型 &lt;code&gt;s-list&lt;/code&gt; 通过 &lt;code&gt;(empty-s-list)&lt;/code&gt; 和 &lt;code&gt;non-empty-s-list&lt;/code&gt; 而非 &lt;code&gt;()&lt;/code&gt; 和 &lt;code&gt;cons&lt;/code&gt;&#xA;来实现自己特有的列表表示方式 。如果我们依然想用 Scheme 列表表示 , 那么可以写成&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;define-datatype&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-list&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-list?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;an-s-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sexps&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s-exp?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;list-of&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;or &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;and &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pair? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;这里 $\texttt{(list-of \textit{pred})}$ 将生成一个谓词 , 该谓词用来检查实参是否构成一个列表 , 并且&#xA;列表每个元素是否都满足 $\textit{pred}$ 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;cases&lt;/code&gt; 语法的一般形式为&lt;/p&gt;&#xA;&lt;p&gt;$\qquad&#xA;\begin{aligned}[t]&#xA;&amp;\texttt{(cases \textit{type-name} \textit{expression}}\\&#xA;&amp;\texttt{\ \ \(\{\texttt{(}\textit{variant-name}\ \,\texttt{(}\{\textit{field-name}\}^*\texttt{)}\ \,\textit{consequent}\texttt{)}\}^*\)} \\&#xA;&amp;\texttt{\ \ (else \textit{default}))}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;该形式声明类型 , 一个待求值待检查的表达式以及一些语句 ; 每个语句都以指定类型的&#xA;某一变体名以及相应字段名作为标识 。&lt;code&gt;else&lt;/code&gt; 语句可省略 。首先 $\textit{expression}$ 会被求值 ,&#xA;如此便得到 $\textit{type-name}$ 的某个值 $v$ ; 如果 $v$ 对应于名为 $\textit{variant-name}$ 的变体 , 那么就&#xA;选中对应的语句 。各个 $\textit{field-name}$ 会被绑定到 $v$ 中对应的字段值 。此后 $\textit{consequent}$&#xA;的值会在这些绑定的作用域内求值并被返回 。若 $v$ 不属于任何变体且出现 &lt;code&gt;else&lt;/code&gt; 语句&#xA;则求取并返回 $\textit{de\!fault}$ 的值 ; 若没有 &lt;code&gt;else&lt;/code&gt; 语句则必须为指定数据类型的每一个变体都&#xA;指定一个语句 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;cases&lt;/code&gt; 形式根据位置绑定变量 : 第 $i$ 个变量绑定到第 $i$ 个字段 ; 因此我们就可以这样写&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;exp1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;or&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;而不是这样&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rator&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;or&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;search-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;code&gt;define-datatype&lt;/code&gt; 和 &lt;code&gt;cases&lt;/code&gt; 形式提供了一种简洁的方式来定义递归数据类型 , 但&#xA;但这种方式并不是唯一的 。其他应用场景可能需要更专门的表示方式 : 它们更紧凑且&#xA;更高效 , 可以利用上数据的特殊性质 。这些优势的代价是必须手动实现接口中的过程 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;define-datatype&lt;/code&gt; 形式是&lt;strong&gt;领域特定语言 domain-specific language&lt;/strong&gt; 的其中一个例子 。&#xA;此种语言是一种小巧的语言 , 用于描述一系列小而明确的任务中的单一任务 。本例中&#xA;我们的任务是定义一种递归数据类型 。这种语言可能存在于用途更广泛的语言中 , 就&#xA;如同 &lt;code&gt;define-datatype&lt;/code&gt; 一样 ; 也有可能是独自构成一门单独的语言 , 别有一套工具 。&#xA;一般来说创造这类语言首先需找出任务的各种变体 , 然后再设计语言并描述这些变体 。&#xA;这种策略通常非常有效 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.21&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.21&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;请用 &lt;code&gt;define-datatype&lt;/code&gt; 实现如 &lt;a href=&#34;#G2.1&#34;&gt;2.2.2 节中提到的环境数据类型&lt;/a&gt; ,&#xA;然后实现&lt;a href=&#34;#Xer2.9&#34;&gt;练习 2.9 中的 &lt;code&gt;has-binding?&lt;/code&gt;&lt;/a&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.22&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.22&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;请用 &lt;code&gt;define-datatype&lt;/code&gt; 实现&lt;a href=&#34;#Xer2.4&#34;&gt;练习 2.4 中的栈数据类型&lt;/a&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.23&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.23&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;lc-exp&lt;/code&gt; 的定义忽略了&lt;a href=&#34;http://localhost:1313/posts/5cce8df/#Def1.1.8&#34;&gt;定义 1.1.8&lt;/a&gt; 中的要求 : &amp;quot; $\Iden$ 表示任何非 $\texttt{lambda}$ 的符号 &amp;quot; ;&#xA;修改 &lt;code&gt;identifier?&lt;/code&gt; 的定义以满足这一需求 。提示 : 任何谓词 ( 包括你自己定义的 ) ,&#xA;都可以在 &lt;code&gt;define-datatype&lt;/code&gt; 中使用 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.24&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.24&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;下面是用 &lt;code&gt;define-datatype&lt;/code&gt; 表示的二叉树 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;define-datatype&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bintree&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bintree?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf-node&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;num&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;integer?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;symbol?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bintree?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;right&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bintree?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;实现 &lt;code&gt;bintree-to-list&lt;/code&gt; 以操作二叉树 , 如此 &lt;code&gt;(bintree-to-list (interior-node &lt;/code&gt;&#xA;&lt;code&gt;&#39;a (leaf-node 3) (leaf-node 4)))&lt;/code&gt; 应返回列表&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf-node&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf-node&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.25&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.25&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;用 &lt;code&gt;cases&lt;/code&gt; 写出 &lt;code&gt;max-interior&lt;/code&gt; : 它以一个含至少一个非叶节点的整数二叉树 ( 如同上题 )&#xA;作为实参并返回叶节点标签之和最大的内部节点所对应的标签 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;tree-1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;foo&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf-node&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf-node&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;tree-2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;bar&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf-node&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;-1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree-1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;tree-3&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;baz&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree-2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf-node&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;max-interior&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree-2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;foo&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;max-interior&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree-3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;baz&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;最后一次调用 &lt;code&gt;max-interior&lt;/code&gt; 也可能返回 &lt;code&gt;foo&lt;/code&gt;，因为 &lt;code&gt;foo&lt;/code&gt; 和 &lt;code&gt;baz&lt;/code&gt; 的叶节点之和都为 $5$ 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.26&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.26&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;下面是&lt;a href=&#34;http://localhost:1313/posts/5cce8df/#Xer1.33&#34;&gt;练习 1.33&lt;/a&gt; 的另一种版本 。考虑下述树的定义 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;\RedBlueTree    &amp;::={} \RedBlueSubtree \\&#xA;\RedBlueSubtree &amp;::={} \texttt{(red-node \RedBlueSubtree  \RedBlueSubtree)} \\&#xA;                &amp;::={} \texttt{(blue-node ${\RedBlueSubtree}^*$)} \\&#xA;                &amp;::={} \texttt{(leaf-node \Int)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;用 &lt;code&gt;define-datatype&lt;/code&gt; 写出等价的定义并用所得到的接口写一个过程 : 它取一棵树并生成&#xA;形状相同的另一棵树 , 但是把每片叶子的值改为从当前叶子节点到树根之间红色节点的数目 。&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;S2.5&#34;&gt;&lt;span&gt;2.5 抽象语法及其表示&lt;/span&gt;&#xA;  &lt;a href=&#34;#S2.5&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;语法通常声明的是递归数据类型的某一具体表示 : 后者使用前者生成的字符串或值 。这样的&#xA;表示叫做&lt;strong&gt;具体语法 concrete syntax&lt;/strong&gt; 或&lt;strong&gt;外在 external&lt;/strong&gt; 表示 。&lt;/p&gt;&#xA;&lt;p&gt;考虑&lt;a href=&#34;http://localhost:1313/posts/5cce8df/#Def1.1.8&#34;&gt;定义 1.1.8&lt;/a&gt; 提到的所有 $\texttt{lambda}$ 演算表达式构成的集 :  这里用的就是 $\texttt{lambda}$ 演算表达式&#xA;的具体语法 。我们也可以用其他具体的语法来表示 $\texttt{lambda}$ 演算表达式 , 比如可以用&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\LcExp   ::={}&amp; &#xA;\Iden \\ ::={}&amp;&#xA;\texttt{(proc \Iden  =&gt; \LcExp)} \\::={}&amp;&#xA;\texttt{\LcExp  (\LcExp)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;来将 $\texttt{lambda}$ 演算表达式定义为另一种不同的字符串集合 。&lt;/p&gt;&#xA;&lt;p&gt;为了处理这样的数据 , 我们需要将其转换为&lt;strong&gt;内在 internal&lt;/strong&gt; 表示 。&lt;code&gt;define-datatype&lt;/code&gt; 形式便提供了一种简洁的方式来定义这样的内在表示 ,&#xA;这样的表示称作 &lt;strong&gt;abstract syntax&lt;/strong&gt; 。&#xA;抽象语法中像括号这样的终结符不需要被储存 , 因为它们不传递信息 。&#xA;另一方面我们想确保数据结构可允许我们&#xA;判断其所代表的 $\texttt{lambda}$ 演算表达式并提取出各个部分 。&#xA;&lt;a href=&#34;#S2.4-lc-exp&#34;&gt;第 46 页提到的 &lt;code&gt;lc-exp&lt;/code&gt;&lt;/a&gt;&#xA;数据类型可允许我们轻松实现上述需求 。&lt;/p&gt;&#xA;&lt;p&gt;将内在表示可视化为&lt;strong&gt;抽象语法树 abstract syntax tree&lt;/strong&gt; 是很有效的 。&lt;a href=&#34;#G2.2&#34;&gt;图 2.2&lt;/a&gt; 是一棵抽象语法树 ,&#xA;对应于 &lt;code&gt;lc-exp&lt;/code&gt; 类型下的 $\texttt{lambda}$ 演算表达式 &lt;code&gt;(lambda (x) (f (f x)))&lt;/code&gt; 。抽象语法树中&#xA;每个非叶节点都被标注了对应的派生式的名称 , 每个枝干上都被标注了对应的非终结符的出现 ,&#xA;每个叶节点则对应于终结符 。&lt;/p&gt;&#xA;&lt;p&gt;下方为图 2.2 —— &lt;code&gt;(lambda (x) (f (f x)))&lt;/code&gt; 所对应的抽象语法树 。&#xA;$&#xA;%\qquad \begin{xy}0;p+/r1cm/:p+/d1cm/::&#xA;%(0,0)*+&lt;10pt,0pt&gt;[F-][=code]\texttt{lambda-exp}=&#34;t&#34;;&#xA;%&#34;t&#34;;p+/r2cm/:p+/d2cm/::&#xA;%(-1,+1)*[code]{\texttt{x}\vphantom{\tt fg}}=&#34;t0&#34;;{\ar&#34;t0&#34;|{\texttt{bound-var}\vphantom{\tt fg}}};&#xA;%(+1,+1)*[code]{\texttt{app-exp}\vphantom{\tt fg}}=&#34;t1&#34;;{\ar&#34;t1&#34;|{\texttt{body}}};&#xA;%&#34;t1&#34;;p+/r2cm/:p+/d2cm/::&#xA;%(-1,+1)*[code]{\texttt{var-exp}\vphantom{\tt fg}}=&#34;t10&#34;;{\ar&#34;t10&#34;|{\texttt{rator}}};&#xA;%(+1,+1)*[code]{\texttt{app-exp}\vphantom{\tt fg}}=&#34;t11&#34;;{\ar&#34;t11&#34;|{\texttt{rand}}};&#xA;%&#34;t10&#34;;p+/r2cm/:p+/d2cm/::&#xA;%(+0,+1)*[code]{\texttt{f}\vphantom{\tt fg}}=&#34;t100&#34;;{\ar&#34;t100&#34;|{\texttt{var}}};&#xA;%&#34;t11&#34;;p+/r2cm/:p+/d2cm/::&#xA;%(-1,+1)*[code]{\texttt{var-exp}\vphantom{\tt fg}}=&#34;t110&#34;;&#xA;%{\ar&#34;t110&#34;|{\texttt{rator}}};&#xA;%(+1,+1)*[code]{\texttt{var-exp}\vphantom{\tt fg}}=&#34;t111&#34;;{&#xA;%\ar&#34;t111&#34;|{\texttt{rand}}};&#xA;%&#34;t110&#34;;p+/r2cm/:p+/d2cm/::&#xA;%(+0,+1)*[code]{\texttt{f}\vphantom{\tt fg}}=&#34;t1100&#34;;{\ar&#34;t1100&#34;|{\texttt{var}}};&#xA;%&#34;t111&#34;;p+/r2cm/:p+/d2cm/::&#xA;%(+0,+1)*[code]{\texttt{x}\vphantom{\tt fg}}=&#34;t1110&#34;;{\ar&#34;t1110&#34;|{\texttt{var}}};&#xA;%\end{xy}&#xA;$ &lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;G2.2&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;  &lt;div class=&#34;svg-container&#34;&gt;&#xD;&#xA;    &lt;svg style=&#34;vertical-align: -36.432ex;&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;48.371ex&#34; height=&#34;38.731ex&#34; role=&#34;img&#34; focusable=&#34;false&#34; viewBox=&#34;0 -1016 21380 17119&#34; xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34; aria-hidden=&#34;true&#34;&gt;&lt;defs&gt;&lt;path id=&#34;MJX-135-TEX-M-1D695&#34; d=&#34;M51 573Q51 602 73 610H76Q79 610 84 610T97 610T113 610T133 611T155 611T179 611H282Q301 598 304 586V76H452Q466 67 470 60T474 38Q474 10 452 1H73Q51 9 51 32V38Q51 54 54 60T73 76H220V535H146L73 536Q51 545 51 567V573Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D68A&#34; d=&#34;M126 306Q105 306 90 321T74 359Q74 439 211 439Q268 439 276 438Q343 426 383 390T430 306Q431 301 431 190V81Q446 79 465 78T492 76T509 72T521 60T524 38Q524 11 506 3Q502 1 466 1Q426 1 406 5T379 14T355 36L345 30Q284 -6 205 -6Q135 -6 92 39T48 141Q48 182 79 212T158 256T252 278T342 285H347V290Q347 315 325 335T267 362Q258 363 224 363Q189 363 185 362H179L178 358Q178 353 178 352T176 345T174 337T170 330T165 322T158 316T150 311T139 308T126 306ZM132 140Q132 115 157 93T224 70Q269 70 302 87T344 133Q346 139 347 175V211H339Q256 209 194 190T132 140Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D696&#34; d=&#34;M133 76Q156 74 164 67T172 38Q172 9 151 1H11Q-12 8 -12 38Q-12 61 5 73Q10 75 28 76H45V355H28Q10 356 5 358Q-12 370 -12 393Q-12 419 11 431H52H70Q91 431 100 427T116 405Q163 436 200 436Q255 436 281 390L285 394Q289 398 292 400T301 407T314 415T329 423T346 429T366 434T389 436H392Q425 436 448 411Q469 390 474 360T480 268V232V203V76H497Q520 74 528 67T536 38Q536 9 515 1H396Q374 9 374 32V38Q374 73 402 76H409V191V242Q409 317 404 339T375 361Q343 361 323 332T299 264Q298 258 298 165V76H315Q338 74 346 67T354 38Q354 9 333 1H214Q192 9 192 32V38Q192 73 220 76H227V191V242Q227 317 222 339T193 361Q161 361 141 332T117 264Q116 258 116 165V76H133Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D68B&#34; d=&#34;M4 573Q4 596 15 603T52 611H90H124Q146 611 155 608T171 591Q173 586 173 491V396L182 402Q217 424 256 431Q280 437 309 437Q376 437 434 379T492 217Q492 162 473 118T422 47T358 8T293 -6Q229 -6 174 38Q171 13 163 7T135 1H131H122Q99 1 90 23L89 279V535H58L27 536Q4 543 4 573ZM409 215Q409 269 377 315T283 361Q255 361 224 344T177 297L173 290V167Q189 124 213 97T278 70Q330 70 369 111T409 215Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D68D&#34; d=&#34;M266 573Q266 596 277 603T314 611H352H385Q411 611 419 607T435 586V76H498Q512 67 516 60T520 38Q520 9 498 1H436Q429 1 417 1T398 0Q375 0 363 7T351 34V43L342 36Q288 -6 223 -6Q143 -6 87 58T31 216Q31 307 88 372T230 437Q292 437 342 405L351 399V535H320L289 536Q266 543 266 573ZM351 290Q347 302 337 316T302 346T244 361Q193 361 154 319T115 215Q115 152 152 111T235 70Q314 70 351 170V290Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-2D&#34; d=&#34;M57 306Q57 333 86 341H438Q468 332 468 306T438 271H86Q57 280 57 306Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D68E&#34; d=&#34;M48 217Q48 295 100 361T248 439L258 440Q268 440 274 440Q329 438 369 416T428 359T456 292T464 228Q464 215 461 208T454 198T442 190L288 189H135L138 179Q153 132 199 102T303 71Q336 71 353 86T380 120T398 143Q404 146 422 146Q453 146 462 126Q464 120 464 116Q464 84 416 39T285 -6Q187 -6 118 59T48 217ZM377 264Q371 291 365 306T341 338T294 362Q288 363 264 363Q225 363 190 336T139 264H377Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D6A1&#34; d=&#34;M35 393Q35 417 46 424T89 432Q95 432 112 432T141 431H223Q238 422 241 415T244 393Q244 389 244 383T237 367T216 355Q209 355 209 354L234 319Q259 286 260 286L308 354Q308 355 301 355Q285 356 278 365T270 384L271 393Q271 420 289 428Q295 431 376 431H459Q460 430 465 427T472 422T476 416T480 407T481 393Q481 368 470 362T434 355H425H392L344 290Q295 225 295 223Q294 223 309 203T350 149L405 77L439 76H453Q474 76 484 69T495 38Q495 10 473 1H303Q281 9 281 32V38Q281 49 282 54T290 67T313 76Q324 76 324 77L259 173L197 77Q202 76 209 76Q225 75 233 68T241 55T242 38Q242 28 242 24T236 12T221 1H51Q29 9 29 32V38Q29 48 29 51T31 59T38 67T51 76H117L171 149Q224 222 224 223L124 355H90H78Q54 355 45 361T35 393Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D699&#34; d=&#34;M89 431Q93 431 104 431T121 432Q173 432 173 401V396L182 402Q237 437 305 437Q376 437 434 378T492 217Q492 146 459 93T382 17T291 -6Q261 -6 232 5T188 26L174 37Q173 37 173 -54V-146H236Q250 -155 254 -162T258 -184Q258 -213 236 -221H27Q4 -214 4 -184Q4 -169 8 -162T27 -146H89V355H58L27 356Q4 363 4 393Q4 408 8 415T27 431H89ZM409 215Q409 269 377 315T283 361Q255 361 224 344T177 297L173 290V167Q189 124 213 97T278 70Q330 70 369 111T409 215Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D698&#34; d=&#34;M52 216Q52 318 118 379T261 440Q343 440 407 378T472 216Q472 121 410 58T262 -6Q176 -6 114 58T52 216ZM388 225Q388 281 351 322T261 364Q213 364 175 325T136 225Q136 158 174 114T262 70T350 114T388 225Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D69E&#34; d=&#34;M4 393Q4 416 15 423T52 431H90Q141 431 151 429T168 417Q171 412 173 409V254L174 100Q182 70 244 70Q320 70 344 119Q349 130 350 144T351 248V355H320L289 356Q266 363 266 393Q266 408 270 415T289 431H351H386Q409 431 418 428T433 411Q435 406 435 241V76H498Q512 67 516 60T520 38Q520 9 498 1H436H394Q372 1 364 5T351 26L342 21Q293 -5 227 -5Q118 -5 96 67Q91 82 90 101T89 227V355H58L27 356Q4 363 4 393Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D697&#34; d=&#34;M89 431Q94 431 105 431T122 432Q173 432 173 399Q173 394 175 394Q176 394 190 404T233 425T298 436Q343 436 371 423Q411 402 423 365T436 265Q436 257 436 239T435 211V198V76H498Q512 67 516 60T520 38Q520 9 498 1H308Q286 9 286 32V38V45Q286 65 303 73Q309 76 329 76H351V188Q351 204 351 230T352 266Q352 321 341 341T288 361Q253 361 222 341T176 274L174 264L173 170V76H236Q250 67 254 60T258 38Q258 9 236 1H27Q4 8 4 38Q4 53 8 60T27 76H89V355H58L27 356Q4 363 4 393Q4 408 8 415T27 431H89Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D69F&#34; d=&#34;M24 392Q24 417 36 424T79 432Q85 432 103 432T132 431H215Q229 422 233 415T237 393Q237 355 198 355H193H172L262 77L352 355H331H323Q288 355 288 393Q288 409 291 415T310 431H478Q491 423 495 416T500 393Q500 364 478 356L452 355H426L374 190Q320 24 318 20Q307 -4 273 -4H262H251Q217 -4 206 20Q204 24 150 190L98 355H72L47 356Q24 363 24 392Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D69B&#34; d=&#34;M327 76Q359 76 369 70T380 38Q380 10 359 1H47Q24 8 24 38Q24 54 28 61T47 76H145V355H96L47 356Q24 363 24 393Q24 409 28 416T47 431H207Q223 419 226 414T229 393V387V369Q297 437 394 437Q436 437 461 417T487 368Q487 347 473 332T438 317Q428 317 420 320T407 327T398 337T393 347T390 356L388 361Q348 356 324 345Q228 299 228 170Q228 161 228 151T229 138V76H293H327Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D6A2&#34; d=&#34;M26 393Q26 417 37 424T80 431H134H217Q232 422 235 416T239 393Q239 379 236 371T226 360T214 356T197 355L179 354V353L188 330Q197 306 209 272T235 201T259 133T271 89V84L274 95Q279 122 298 185T335 300T352 354Q352 355 331 355Q312 355 304 358Q288 368 288 393Q288 408 291 415T310 431H478Q479 430 484 427T491 422T495 416T499 407T500 393Q500 376 493 367T479 357T458 355H452Q426 355 425 353Q420 337 351 124T280 -94Q240 -195 168 -220Q147 -228 125 -228Q89 -228 66 -201T42 -139Q42 -116 56 -102T93 -87Q117 -87 130 -102T144 -135V-138H126Q121 -148 121 -150T130 -152Q182 -147 207 -87Q211 -78 223 -40T236 1Q230 10 102 355H75L49 356Q26 363 26 393Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D69D&#34; d=&#34;M25 395Q26 405 26 408T29 416T35 423T48 431H145V481L146 532Q154 547 161 550T184 554H189Q218 554 227 534Q229 529 229 480V431H405Q406 430 411 427T418 422T422 416T426 407T427 393Q427 387 427 382T424 374T421 368T417 363T413 360T408 358L405 356L317 355H229V249Q229 237 229 214T228 179Q228 126 241 98T295 70Q354 70 365 149Q366 167 375 174Q383 182 407 182H415Q438 182 446 166Q448 161 448 148Q448 84 398 39T282 -6Q226 -6 189 29T146 128Q145 134 145 247V355H96H72Q45 355 35 362T25 395Z&#34;&gt;&lt;/path&gt;&lt;path id=&#34;MJX-135-TEX-M-1D68F&#34; d=&#34;M43 395Q44 405 44 408T47 416T53 423T66 431H176V461Q176 500 182 518Q201 570 252 593T353 617Q399 614 418 593T437 548Q437 528 424 514T387 499Q365 499 353 511T338 537V541H328Q275 536 261 494Q260 490 260 460V431H327Q334 431 346 431T364 432Q392 432 404 425T416 393T405 362T365 355H327H260V76H319Q375 76 388 71T401 38Q401 27 400 23T395 12T379 1H58Q47 6 42 12T36 23T35 38Q35 65 53 73Q59 76 117 76H176V355H121H93Q64 355 54 362T43 395Z&#34;&gt;&lt;/path&gt;&lt;/defs&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; stroke-width=&#34;0&#34; transform=&#34;scale(1,-1)&#34;&gt;&lt;g data-mml-node=&#34;math&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;mspace&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;xypic&#34; data-cmd-id=&#34;0&#34; data-text-mml-ids=&#34;[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]&#34; transform=&#34;translate(2000,0)&#34;&gt;&lt;g fill=&#34;none&#34; stroke=&#34;currentColor&#34; stroke-linecap=&#34;round&#34; stroke-width=&#34;0.64&#34; transform=&#34;translate(5032.5,250) scale(62.5, -62.5)&#34;&gt;&lt;rect x=&#34;-53.2&#34; y=&#34;-9.86&#34; width=&#34;106.4&#34; height=&#34;19.71&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;rect x=&#34;-77.32&#34; y=&#34;51.95&#34; width=&#34;30.8&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;-38.01&#34; y1=&#34;38.01&#34; x2=&#34;-51.95&#34; y2=&#34;51.95&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;-9.86&#34; y1=&#34;9.86&#34; x2=&#34;-23.91&#34; y2=&#34;23.91&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(-51.95,51.95) rotate(135) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;21.32&#34; y=&#34;51.95&#34; width=&#34;81.2&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;37.97&#34; y1=&#34;37.97&#34; x2=&#34;51.95&#34; y2=&#34;51.95&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;9.86&#34; y1=&#34;9.86&#34; x2=&#34;23.95&#34; y2=&#34;23.95&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(51.95,51.95) rotate(45) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;-40.6&#34; y=&#34;113.87&#34; width=&#34;81.2&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;25.53&#34; y1=&#34;98.31&#34; x2=&#34;9.97&#34; y2=&#34;113.87&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;51.95&#34; y1=&#34;71.89&#34; x2=&#34;36.39&#34; y2=&#34;87.45&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(9.97,113.87) rotate(135) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;83.24&#34; y=&#34;113.87&#34; width=&#34;81.2&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;98.63&#34; y1=&#34;98.63&#34; x2=&#34;113.87&#34; y2=&#34;113.87&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;71.89&#34; y1=&#34;71.89&#34; x2=&#34;87.13&#34; y2=&#34;87.13&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(113.87,113.87) rotate(45) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;-15.4&#34; y=&#34;175.79&#34; width=&#34;30.8&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;0&#34; y1=&#34;159.58&#34; x2=&#34;0&#34; y2=&#34;175.79&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;0&#34; y1=&#34;133.81&#34; x2=&#34;0&#34; y2=&#34;150.02&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(0,175.79) rotate(90) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;21.32&#34; y=&#34;175.79&#34; width=&#34;81.2&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;87.45&#34; y1=&#34;160.23&#34; x2=&#34;71.89&#34; y2=&#34;175.79&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;113.87&#34; y1=&#34;133.81&#34; x2=&#34;98.31&#34; y2=&#34;149.37&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(71.89,175.79) rotate(135) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;145.16&#34; y=&#34;175.79&#34; width=&#34;81.2&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;160.55&#34; y1=&#34;160.55&#34; x2=&#34;175.79&#34; y2=&#34;175.79&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;133.81&#34; y1=&#34;133.81&#34; x2=&#34;149.05&#34; y2=&#34;149.05&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(175.79,175.79) rotate(45) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;46.52&#34; y=&#34;237.71&#34; width=&#34;30.8&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;61.92&#34; y1=&#34;221.5&#34; x2=&#34;61.92&#34; y2=&#34;237.71&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;61.92&#34; y1=&#34;195.73&#34; x2=&#34;61.92&#34; y2=&#34;211.94&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(61.92,237.71) rotate(90) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;rect x=&#34;170.36&#34; y=&#34;237.71&#34; width=&#34;30.8&#34; height=&#34;19.94&#34; rx=&#34;0&#34; stroke=&#34;currentColor&#34;&gt;&lt;/rect&gt;&lt;line x1=&#34;185.76&#34; y1=&#34;221.5&#34; x2=&#34;185.76&#34; y2=&#34;237.71&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;line x1=&#34;185.76&#34; y1=&#34;195.73&#34; x2=&#34;185.76&#34; y2=&#34;211.94&#34; stroke-dasharray=&#34;&#34;&gt;&lt;/line&gt;&lt;g transform=&#34;translate(185.76,237.71) rotate(90) &#34;&gt;&lt;path d=&#34;M0,0 Q-3.55,0.32 -7.82,2.35&#34;&gt;&lt;/path&gt;&lt;path d=&#34;M0,0 Q-3.55,-0.32 -7.82,-2.35&#34;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;-2.6250000000000004&#34; data-y=&#34;0.19499999999999995&#34; data-xypic-id=&#34;0&#34; transform=&#34;translate(2407.5,55)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D695&#34; xlink:href=&#34;#MJX-135-TEX-M-1D695&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D696&#34; xlink:href=&#34;#MJX-135-TEX-M-1D696&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68B&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68D&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68D&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(2625,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;2D&#34; xlink:href=&#34;#MJX-135-TEX-M-2D&#34; transform=&#34;translate(3150,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68E&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68E&#34; transform=&#34;translate(3675,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D6A1&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A1&#34; transform=&#34;translate(4200,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(4725,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;-4.132499999999999&#34; data-y=&#34;4.064&#34; data-xypic-id=&#34;1&#34; transform=&#34;translate(900,-3814)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D6A1&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A1&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;-3.6055397705532184&#34; data-y=&#34;2.0721787155501903&#34; data-xypic-id=&#34;2&#34; transform=&#34;translate(1427,-1822.2)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D68B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68B&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D698&#34; xlink:href=&#34;#MJX-135-TEX-M-1D698&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69E&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69E&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D697&#34; xlink:href=&#34;#MJX-135-TEX-M-1D697&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68D&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68D&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;2D&#34; xlink:href=&#34;#MJX-135-TEX-M-2D&#34; transform=&#34;translate(2625,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69F&#34; transform=&#34;translate(3150,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(3675,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(4200,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(4725,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;2.0325000000000006&#34; data-y=&#34;4.064&#34; data-xypic-id=&#34;3&#34; transform=&#34;translate(7065,-3814)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;2D&#34; xlink:href=&#34;#MJX-135-TEX-M-2D&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68E&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68E&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D6A1&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A1&#34; transform=&#34;translate(2625,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(3150,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(3675,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;1.1925378797541255&#34; data-y=&#34;2.0704109485972237&#34; data-xypic-id=&#34;4&#34; transform=&#34;translate(6225,-1820.4)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D68B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68B&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D698&#34; xlink:href=&#34;#MJX-135-TEX-M-1D698&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68D&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68D&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D6A2&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A2&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;-1.8374999999999988&#34; data-y=&#34;7.934&#34; data-xypic-id=&#34;5&#34; transform=&#34;translate(3195,-7684)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69F&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;2D&#34; xlink:href=&#34;#MJX-135-TEX-M-2D&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68E&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68E&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D6A1&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A1&#34; transform=&#34;translate(2625,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(3150,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(3675,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;1.0069223496926578&#34; data-y=&#34;5.998747258045114&#34; data-xypic-id=&#34;6&#34; transform=&#34;translate(6039.4,-5748.7)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69D&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69D&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D698&#34; xlink:href=&#34;#MJX-135-TEX-M-1D698&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;5.902500000000001&#34; data-y=&#34;7.934&#34; data-xypic-id=&#34;7&#34; transform=&#34;translate(10935,-7684)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;2D&#34; xlink:href=&#34;#MJX-135-TEX-M-2D&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68E&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68E&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D6A1&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A1&#34; transform=&#34;translate(2625,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(3150,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(3675,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;5.0625378797541245&#34; data-y=&#34;6.0188998013089305&#34; data-xypic-id=&#34;8&#34; transform=&#34;translate(10095,-5768.9)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D697&#34; xlink:href=&#34;#MJX-135-TEX-M-1D697&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68D&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68D&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;-0.26249999999999846&#34; data-y=&#34;11.803999999999998&#34; data-xypic-id=&#34;9&#34; transform=&#34;translate(4770,-11554)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D68F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68F&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;-0.5568465901844046&#34; data-y=&#34;9.828088618126888&#34; data-xypic-id=&#34;10&#34; transform=&#34;translate(4475.7,-9578.1)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69F&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;2.032500000000001&#34; data-y=&#34;11.803999999999998&#34; data-xypic-id=&#34;11&#34; transform=&#34;translate(7065,-11554)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69F&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;2D&#34; xlink:href=&#34;#MJX-135-TEX-M-2D&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68E&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68E&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D6A1&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A1&#34; transform=&#34;translate(2625,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(3150,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(3675,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;4.876922349692656&#34; data-y=&#34;9.868747258045115&#34; data-xypic-id=&#34;12&#34; transform=&#34;translate(9909.4,-9618.7)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69D&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69D&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D698&#34; xlink:href=&#34;#MJX-135-TEX-M-1D698&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;9.772499999999999&#34; data-y=&#34;11.803999999999998&#34; data-xypic-id=&#34;13&#34; transform=&#34;translate(14805,-11554)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69F&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;2D&#34; xlink:href=&#34;#MJX-135-TEX-M-2D&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68E&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68E&#34; transform=&#34;translate(2100,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D6A1&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A1&#34; transform=&#34;translate(2625,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D699&#34; xlink:href=&#34;#MJX-135-TEX-M-1D699&#34; transform=&#34;translate(3150,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(3675,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;8.932537879754125&#34; data-y=&#34;9.88889980130893&#34; data-xypic-id=&#34;14&#34; transform=&#34;translate(13965,-9638.9)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D697&#34; xlink:href=&#34;#MJX-135-TEX-M-1D697&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68D&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68D&#34; transform=&#34;translate(1575,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;3.6075000000000017&#34; data-y=&#34;15.674&#34; data-xypic-id=&#34;15&#34; transform=&#34;translate(8640,-15424)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D68F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68F&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;3.313153409815595&#34; data-y=&#34;13.698088618126887&#34; data-xypic-id=&#34;16&#34; transform=&#34;translate(8345.7,-13448.1)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69F&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;11.347499999999998&#34; data-y=&#34;15.674&#34; data-xypic-id=&#34;17&#34; transform=&#34;translate(16380,-15424)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34;&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D6A1&#34; xlink:href=&#34;#MJX-135-TEX-M-1D6A1&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;g data-mml-node=&#34;TeXAtom&#34; data-mjx-texclass=&#34;ORD&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;g data-mml-node=&#34;mpadded&#34;&gt;&lt;g data-mml-node=&#34;mphantom&#34;&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g stroke=&#34;currentColor&#34; fill=&#34;currentColor&#34; data-x=&#34;11.053153409815593&#34; data-y=&#34;13.698088618126887&#34; data-xypic-id=&#34;18&#34; transform=&#34;translate(16085.7,-13448.1)&#34;&gt;&lt;g data-mml-node=&#34;mstyle&#34; transform=&#34;scale(0.707)&#34;&gt;&lt;g data-mml-node=&#34;mtext&#34;&gt;&lt;use data-c=&#34;1D69F&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69F&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D68A&#34; xlink:href=&#34;#MJX-135-TEX-M-1D68A&#34; transform=&#34;translate(525,0)&#34;&gt;&lt;/use&gt;&lt;use data-c=&#34;1D69B&#34; xlink:href=&#34;#MJX-135-TEX-M-1D69B&#34; transform=&#34;translate(1050,0)&#34;&gt;&lt;/use&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;  &lt;style&gt;&#xD;&#xA;    .svg-container {&#xD;&#xA;      display: inline-block;&#xD;&#xA;      width: 100%;&#xD;&#xA;      max-width: 100%;&#xD;&#xA;      height: auto;&#xD;&#xA;      overflow-x: auto;&#xD;&#xA;      overflow-y: hidden;&#xD;&#xA;    }&#xD;&#xA;    .svg-container svg {&#xD;&#xA;      width: auto;&#xD;&#xA;      height: auto;&#xD;&#xA;      &#xD;&#xA;      &#xD;&#xA;    }&#xD;&#xA;  &lt;/style&gt;&#xD;&#xA;&#xA;&lt;p&gt;要为某种具体语法设计抽象语法 , 我们就必须为具体语法中的每个派生式及各个派生式中的&#xA;每个非终结符的出现都起一个名字 。使用 &lt;code&gt;define-datatype&lt;/code&gt; 可以很轻松地声明抽象语法 ,&#xA;我们为每个非终结符都使用一次 &lt;code&gt;define-datatype&lt;/code&gt; , 为每个派生式都添加一个变体 。&lt;/p&gt;&#xA;&lt;p&gt;我们可以用下述记法精确总结概括&lt;a href=&#34;#G2.2&#34;&gt;图 2.2&lt;/a&gt; 中的结构 :&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;S2.5-lc-exp&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\LcExp ::={}&amp; \Iden \\&#xA;            &amp; \bbox[border:.4pt solid black]{\texttt{var-exp (var)}} \\[+3pt]&#xA;       ::={}&amp; \texttt{(lambda (\Iden) \LcExp)} \\&#xA;            &amp; \bbox[border:.4pt solid black]{\texttt{lambda-exp (bound-var body)}}\\[+3pt]&#xA;       ::={}&amp; \texttt{(\LcExp  \LcExp)} \\&#xA;            &amp; \bbox[border:.4pt solid black]{\texttt{app-exp (rator rand)}}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;这样的记法可同时指明具体语法和抽象语法 , 本书将会始终采用 。&lt;/p&gt;&#xA;&lt;p&gt;既然已经区分了具体语法 ( 主要供人使用 ) 以及抽象语法 ( 主要供计算机使用 ) , 现在看看&#xA;如何在这两种语法之间进行转换 。&lt;/p&gt;&#xA;&lt;p&gt;假如具体语法是个字符串集合 , 那么想要推导出对应的抽象语法树将会非常麻烦 。这样的&#xA;任务叫做&lt;strong&gt;解析 parsing&lt;/strong&gt; , 其由&lt;strong&gt;解析器 parser&lt;/strong&gt; 完成 。由于写解析器通常会很麻烦 , 因此最好&#xA;用一种叫&lt;strong&gt;解析器生成器 parser generator&lt;/strong&gt; 的工具来实现此目标 ; 解析器生成器以一套语法&#xA;作为输入并输出一个解析器 。由于语法是交由工具处理的 , 它们必须以某种机器可识别的&#xA;方式来书写 。有很多现成的解析器生成器 。&lt;/p&gt;&#xA;&lt;p&gt;如果具体语法以列表集合的形式给出 , 那么解析过程就可被大幅简化 。&#xA;比如将&lt;a href=&#34;#S2.5&#34;&gt;本节开头的$\texttt{lambda}$ 演算表达式&lt;/a&gt;声明为列表集合 ,&#xA;就如同前面 &lt;a href=&#34;#S2.4-define-datatype&#34;&gt;第 47 页提到的 &lt;code&gt;define-datatype&lt;/code&gt;&lt;/a&gt; 一样 。&#xA;在这种情形下 Scheme 的 &lt;code&gt;read&lt;/code&gt; 流程会自动把字符串解析为列表和符号 ,&#xA;如此将这些列表结构解析为抽象语法树就容易得多了 ,&#xA;正如下面的 &lt;code&gt;parse-expression&lt;/code&gt; 一样 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; parse-expression : SchemeVal → LcExp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;parse-expression&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;cond&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;symbol? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pair? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;lambda&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lambda-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;parse-expression&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;caddr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;parse-expression&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;parse-expression&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;report-invalid-concrete-syntax&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;datum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)])))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;通常我们很容易将抽象语法树重新转换为列表 - 符号表示 。如果这样做了那么 Scheme 的&#xA;打印流程就会将其展示为列表形式的具体语法 。这一切是通过 &lt;code&gt;unparse-lc-exp&lt;/code&gt; 实现的 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; unparse-lc-exp : LcExp → SchemeVal&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unparse-lc-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;cases&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lc-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var-exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lambda-exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bound-var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;&amp;#39;lambda&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;bound-var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;unparse-lc-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;app-exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rator&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;unparse-lc-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;unparse-lc-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.27&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.27&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;画出下面 lambda 演算表达式的抽象语法树：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.28&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.28&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;写出逆向解析器以将 &lt;code&gt;lc-exp&lt;/code&gt; 的抽象语法转换为符合&lt;a href=&#34;#S2.5-lc-exp&#34;&gt;本节第二个语法 ( 第 52 页 )&lt;/a&gt; 的字符串 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.29&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.29&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;若&lt;a href=&#34;http://localhost:1313/posts/5cce8df/#S1.1.2-Kleene&#34;&gt;克莱尼星号或加号 ( 第 7 页 )&lt;/a&gt; 被用于具体语法中 , 构建抽象语法树时最好是使用相应子树&#xA;构成的列表 。例如，如果 $\texttt{lambda}$ 演算表达式的语法为&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \qquad \begin{aligned}[t]&#xA;\LcExp ::={}&amp; \Iden \\&#xA;            &amp; \bbox[border:.4pt solid black]{\texttt{var-exp (var)}} \\[+3pt]&#xA;       ::={}&amp; \texttt{(lambda \(\{(\Iden)^*\}\) \LcExp )} \\&#xA;            &amp; \bbox[border:.4pt solid black]{\texttt{lambda-exp (bound-var body)}}\\[+3pt]&#xA;       ::={}&amp; \texttt{(\LcExp  \(\{\LcExp\}^*\))} \\&#xA;            &amp; \bbox[border:.4pt solid black]{\texttt{app-exp (rator rand)}}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;那么字段 &lt;code&gt;bound-vars&lt;/code&gt; 对应的谓词就可以写作是 &lt;code&gt;(list-of identifier?)&lt;/code&gt; ,&#xA;而 &lt;code&gt;rands&lt;/code&gt; 对应的谓词则可写作 &lt;code&gt;(list-of lc-exp?)&lt;/code&gt; 。&#xA;以此方式写出该语法的 &lt;code&gt;define-datatype&lt;/code&gt; 和解析器 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.30&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.30&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;刚才定义的 &lt;code&gt;parse-expression&lt;/code&gt; 过程不是很靠谱 :&#xA;它检查不到某些可能的语法错误 —— 如 &lt;code&gt;(a b c)&lt;/code&gt; ;&#xA;并且会在其他表达式终止时给不出恰当的错误信息 —— 如 &lt;code&gt;(lambda)&lt;/code&gt; 。&#xA;请修改它以使之更稳健 , 可以接收任何 $\SExp$ ,&#xA;并且可对不表示 $\texttt{lambda}$ 演算表达式的 $\SExp$ 给出恰当的错误信息 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer2.31&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 2.31&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;有时把具体语法定义为被括号包围的符号和整数序列会很方便 。比如我们可考虑把&lt;strong&gt;前缀列表 prefix list&lt;/strong&gt; 定义为&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\PrefixList ::={}&amp; \texttt{(\PrefixList)}  \\&#xA;\PrefixList ::={}&amp; \Int \\&#xA;            ::={}&amp; \texttt{- \PrefixList  \PrefixList}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;如此 &lt;code&gt;(- - 3 2 - 4 - 12 7)&lt;/code&gt; 是一个合法的前缀列表 。该表示法也称作&lt;strong&gt;波兰前缀表示法 Polish prefix notation&lt;/strong&gt; 以纪念其发明者Jan Łukasiewicz 。写一个解析器以将前缀列表表示法&#xA;转换为下述抽象语法 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;define-datatype&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;prefix-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;prefix-exp?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;const-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;num&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;integer?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;diff-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;operand1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;prefix-exp?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;operand2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;prefix-exp?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;使上例与这几个构造器能生成相同抽象语法树 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;diff-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;diff-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;const-exp&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;const-exp&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;diff-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;const-exp&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;diff-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;const-exp&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;const-exp&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;提示 : 想想如何写一个过程 : 其取一列表并产生一个 &lt;code&gt;prefix-exp&lt;/code&gt; 和列表剩余元素所组成的列表 。&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>翻译-EOPL-01-递归的数据集</title>
      <link>http://localhost:1313/posts/5cce8df/</link>
      <pubDate>Wed, 02 Apr 2025 00:03:07 +1300</pubDate>
      <guid>http://localhost:1313/posts/5cce8df/</guid>
      <description>$$&#xA;\rm\LaTeX\textrm{ Definitions are here.}&#xA;\def\Int{\textrm{Int}}&#xA;\def\Expression{\textrm{Expression}}&#xA;\def\SList{\textrm{S-list}}&#xA;\def\SExp{\textrm{S-exp}}&#xA;\def\Symbol{\textrm{Symbol}}&#xA;\def\Bintree{\textrm{Bintree}}&#xA;\def\LcExp{\textrm{LcExp}}&#xA;\def\Iden{\textrm{Identifier}}&#xA;\def\BinSearchTree{\textrm{Binary-search-tree}}&#xA;\def\InductHyp{\textit{IH}}&#xA;\def\List{\textrm{List}}&#xA;\def\ScmVal{\textrm{Scheme\_value}}&#xA;\def\ListOfInt{\textrm{List-of-Int}}&#xA;\def\ListOfSymbol{\textrm{List-of-Symbol}}&#xA;\def\ListOf#1{\textrm{List-of-(#1)}}&#xA;\def\VectorOf#1{\textrm{Vector-of(#1)}}&#xA;\def\implement#1{\lceil#1\rceil}&#xA;\def\DiffTree{\textrm{Diff-Tree}}&#xA;\def\EnvExp{\textrm{Env-exp}}&#xA;\def\N{\mathbb{N}}&#xA;$$&lt;p&gt;解释器、检查器及其他类似程序是编程语言处理器的核心 。本章将介绍这些程序用到的基本编程工具 。&lt;/p&gt;&#xA;&lt;p&gt;由于编程语言的语法通常具有嵌套或树状结构 ,&#xA;因此递归将成为我们的主要手段 。&lt;a href=&#34;#S1.1&#34;&gt;1.1 节&lt;/a&gt;及&#xA;&lt;a href=&#34;#S1.2&#34;&gt;1.2 节&lt;/a&gt;将介绍递归定义数据结构的方法&#xA;并展示如何利用这类定义来指导递归程序的构建 ; 而&#xA;&lt;a href=&#34;#S1.3&#34;&gt;1.3 节&lt;/a&gt; 则会介绍如何将这些技术推广到更复杂的问题上 。&#xA;本章末尾提供了大量练习 , 它们是本章的核心内容 : 它们能为掌握&#xA;递归编程技巧提供必要的实践经验 , 而这正是阅读后续内容所依赖的 。&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;S1.1&#34;&gt;&lt;span&gt;1.1 递归定义的数据&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;在书写一段程序或一个过程时你必须清楚地认识到 :&#xA;什么样的值能作为过程的实参 , 而什么样的值又能作为合法的返回值 。&#xA;这些值构成的集通常很复杂 。本节将介绍定义这些集合的形式化技术 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;S1.1.1&#34;&gt;&lt;span&gt;1.1.1 递归定义&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.1.1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;递归定义 Inductive specification&lt;/strong&gt; 是一种定义集合的强大方法 。为了介绍它&#xA;我们先试着用它描述自然数 $\N=\{0,1,2,\ldots\}$ 的某一子集 $S$ 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def1.1.1&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;定义 1.1.1&lt;/strong&gt; 规定 $n\in S$ 当且仅当&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$n=0$ , 或者&lt;/li&gt;&#xA;&lt;li&gt;$n-3\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;看看如何用上述定义判断哪些自然数会落在 $S$ 中 。&#xA;首先由 $0\in S$ 可知 $3\in S$ ( 因为 $3-3=0\in S$ ) ,&#xA;另外 $6\in S$ ( 因为 $6-3=3\in S$ ) 。继续这样做下去便可得知&#xA;所有能被 $3$ 整除的自然数都落在 $S$ 中 。&lt;/p&gt;&#xA;&lt;p&gt;那其他自然数呢 ? $1\in S$ 是否成立呢 ?&#xA;首先由 $1\neq 0$ 可知条件 1 不成立 ;&#xA;另外 $1-3=-2$ 非自然数 , 故 $-2$ 非 $S$ 中元素 , 条件 2 也不成立 ;&#xA;既然两个条件对 $1$ 都不成立 , 故 $1\notin S$ 。&#xA;同样地我们有 $2\notin S$ 。&#xA;那 $4$ 呢 ? $4\in S$ 当且仅当 $1\in S$ , 但 $1\notin S$ ,&#xA;从而 $4\notin S$ 。用类似的方法不难得知 : 若 $n$ 是自然数并且&#xA;$n$ 非 $3$ 倍数则 $n\notin S$ 。&lt;/p&gt;&#xA;&lt;p&gt;综上 $S$ 便是所有能被 $3$ 整除的自然数所构成的集 。&lt;/p&gt;&#xA;&lt;p&gt;我们可根据&lt;a href=&#34;#Def1.1.1&#34;&gt;定义 1.1.1&lt;/a&gt; 编写一个过程以判断自然数是否落在 $S$ 中 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 :  in-S? : Natural   → Bool&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (in-S?     n   )   = #t 仅当 n 属于 S 的话 , 否则为 #f&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :          Natural ::=  0 | (succ Natural)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;in-S?&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zero? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;gt;= &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;in-S?&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;刚才我们根据&lt;a href=&#34;#Def1.1.1&#34;&gt;定义 1.1.1&lt;/a&gt; 编写了一个递归过程 ,&#xA;代码中的 &lt;code&gt;in-S? : Natural → Bool&lt;/code&gt; 是一条注释 , 称作过程的&lt;strong&gt;合约 contract&lt;/strong&gt; :&#xA;它表示过程 &lt;code&gt;in-S?&lt;/code&gt; 应以一个以自然数为实参并返回一个布尔值 。&#xA;这样的注释对阅读和编写代码很有帮助 。&lt;/p&gt;&#xA;&lt;p&gt;在判断 $n\in S$ 是否成立前 , 首先应判断 $n=0$ 是否成立 :&#xA;如果成立则返回真 , 否则则需要判断 $n-3\in S$ 是否成立 ;&#xA;要实现后者首先需判断 $n-3\geq 0$ 是否为真 :&#xA;若为真则可调用上述过程判断其是否属于 $S$ ,&#xA;否则 $n\notin S$ 。&lt;/p&gt;&#xA;&lt;p&gt;下面是另一种定义 $S$ 的方法 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def1.1.2&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;定义 1.1.2&lt;/strong&gt;&#xA;规定 $S$ 为自然数 $\N$ 子集且为满足下述条件的最小集 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$0\in S$&lt;/li&gt;&#xA;&lt;li&gt;若 $n\in S$ 则 $n+3\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;刚才的 &amp;quot; 最小集 &amp;quot; 意味着该集合不仅满足上述两条性质 ,&#xA;并且还是其他任何满足上述两条性质的集的子集 。&#xA;很明显这样的集唯一 : 如果 $S_1$ , $S_2$ 都满足上述条件且都为最小集 ,&#xA;那么 $S_1\subseteq S_2$ ( 因为 $S_1$ 是最小集 )&#xA;并且 $S_1\supseteq S_2$ ( 因为 $S_2$ 是最小集 ) ,&#xA;如此 $S_1=S_2$ 。该条件不可或缺 , 否则 $S$ 就不唯一了&#xA;( 见&lt;a href=&#34;#Xer1.3&#34;&gt;练习 1.3&lt;/a&gt; ) 。&lt;/p&gt;&#xA;&lt;p&gt;下面是上述定义的另一种记法 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;   \AXC{}&#xA;   \UIC{$0\in S$}&#xA;   \end{prooftree}$&lt;/li&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;   \AXC{$n\in S$}&#xA;   \UIC{$(n+3)\in S$}&#xA;   \end{prooftree}$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;这不过是&lt;a href=&#34;#Def1.1.2&#34;&gt;定义 1.1.2&lt;/a&gt; 的简便记法罢了 。上面的每个公式称作&lt;strong&gt;推理规则 rule of inference&lt;/strong&gt; , 简称&lt;strong&gt;规则 rule&lt;/strong&gt; ;&#xA;水平线可以被解释为 &amp;quot; 若 . . . 则 . . . &amp;quot; ; 水平线上方的部分称作&lt;strong&gt;假设 hypothesis&lt;/strong&gt; 或者是&lt;strong&gt;前件 antecedent&lt;/strong&gt; ,&#xA;下方部分则称作是&lt;strong&gt;结论 conclusion&lt;/strong&gt; 或者是&lt;strong&gt;后件 consequent&lt;/strong&gt; 。若有多个假设 , 则使用隐藏的 &amp;quot; 且 &amp;quot; ( 见&#xA;&lt;a href=&#34;#Def1.1.5&#34;&gt;定义 1.1.5&lt;/a&gt; ) 来连接它们 ; 没有假设的规则称作&lt;strong&gt;公理 axiom&lt;/strong&gt; , 在书写公理时常常会省略水平线 , 即&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{prooftree}&#xA;\AXC{$0\in S$}&#xA;\end{prooftree}$&lt;/p&gt;&#xA;&lt;p&gt;上述两条规则可解释为如下 : &amp;quot; 自然数 $n$ 属于 $S$ 当且仅当断言 &amp;rsquo; $n\in S$ &amp;rsquo; 可通过在公理上有限次地应用&#xA;推理规则得出 &amp;quot; 。这一解释使得 $S$ 可以很自然地被人理解为闭合于该规则的最小集合 。&lt;/p&gt;&#xA;&lt;p&gt;刚才的两个定义描述的都是同一个对象 。我们通常会把版本 1 称作是&lt;strong&gt;自顶向下 top-down&lt;/strong&gt; 的 , 并且把&#xA;版本 2 称作是&lt;strong&gt;自底向上 bottom-up&lt;/strong&gt; 的 。版本 3 则称作是&lt;strong&gt;推理规则 rules-of-inference&lt;/strong&gt; 形式的 。&lt;/p&gt;&#xA;&lt;p&gt;来看看上述三种定义方式在其他例子中的使用 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def1.1.3&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;定义 1.1.3&lt;/strong&gt; ( 整数列表 , 自顶向下 ) Scheme 中的列表为整数列表当且仅当其&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;要么是空列表&lt;/li&gt;&#xA;&lt;li&gt;要么是个配对 , 满足 &lt;code&gt;car&lt;/code&gt; 为自然数且 &lt;code&gt;cdr&lt;/code&gt; 为整数列表&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def1.1.4&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;定义 1.1.4&lt;/strong&gt; ( 整数列表 , 自底向上 ) $\ListOfInt$ 为满足下述条件的最小集 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$\texttt{()}\in \ListOfInt$ , 并且&lt;/li&gt;&#xA;&lt;li&gt;若 $n\in \Int$ 并且 $l\in \ListOfInt$ 则 $\texttt{($n$ . $l$)}\in \ListOfInt$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;这里我们用中缀符 &amp;quot; $\texttt{.}$ &amp;quot; 来代表 Scheme 中 &lt;code&gt;cons&lt;/code&gt; 的输出结果 ; 语句 $\texttt{($n$ . $l$)}$ 表示一个头 ( &lt;code&gt;car&lt;/code&gt; ) 为 $n$&#xA;且尾 ( &lt;code&gt;cdr&lt;/code&gt; ) 为 $l$ 的 Scheme 序对 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def1.1.5&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;定义 1.1.5&lt;/strong&gt; ( 整数列表 , 推理规则 )&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;   \AXC{$\texttt{()} \in \ListOfInt$}&#xA;   \end{prooftree}$&lt;/li&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;   \AXC{$n\in \Int$}&#xA;   \AXC{$l\in \ListOfInt$} &#xA;   \BIC{$\texttt{($n$ . $l$)}\in \ListOfInt$}&#xA;   \end{prooftree}$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;上述三种定义是彼此等价的 。&lt;/p&gt;&#xA;&lt;p&gt;接下来我们来看看如何用这些定义来生成整数列表 。&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\texttt{()}$ 是整数列表 , 由&lt;a href=&#34;#Def1.1.4&#34;&gt;定义 1.1.4&lt;/a&gt; / &lt;a href=&#34;#Def1.1.5&#34;&gt;定义 1.1.5&lt;/a&gt; 的条件 1 可得知 ;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\texttt{(14 . ())}$ 是整数列表 —— 由于 $\texttt{14}$ 是整数且 $\texttt{()}$ 是&#xA;整数列表 , 如此利用&lt;a href=&#34;#Def1.1.4&#34;&gt;定义 1.1.4&lt;/a&gt; 里的条件 2 便可以得知 ;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\texttt{(3 . (14 . ()))}$ 是整数列表 —— 因为 $\texttt3$ 是整数且&#xA;$\texttt{(14 . ())}$ 是整数列表 。我们可将该推理过程写成是&#xA;$\ListOfInt$ 的第二条推理规则的一个实例 , 即&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{prooftree}&#xA;   \AXC{$\texttt{3}\in \Int$}&#xA;   \AXC{$\texttt{(14 . ())}\in \ListOfInt$}&#xA;   \BIC{$\texttt{(3 . (14 . ()))}\in \ListOfInt$}&#xA;   \end{prooftree}$&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\texttt{(-7 . (3 . (14 . ())))}$ 是整数列表 : 由于 $\texttt{-7}$ 是&#xA;整数且 $\texttt{(3 . (14 . ()))}$ 是整数列表 , 因此基于定义&#xA;1.1.4 的条件 2 便可得知 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;不遵循上述风格方式构造出的对象都不是整数列表 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;如果是将点表示法转为列表表示法则易知 $\texttt{()}$ , $\texttt{(14)}$ , $\texttt{(3 14)}$ , $\texttt{(-7 3 14)}$ 皆为 $\ListOfInt$ 中元素 。&lt;/p&gt;&#xA;&lt;p&gt;我们甚至还可将所有用到的推理规则结合起来以获得 $\texttt{(-7 . ( 3 . (14 . ()))}\in \ListOfInt$ 的&#xA;演绎推理链 。下面的树状图称作是&lt;strong&gt;推导 derivation&lt;/strong&gt; 或者是&lt;strong&gt;证明树 deduction tree&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{prooftree}&#xA;\AXC{$\texttt{-7}\in \N$}&#xA;\AXC{$\texttt{3} \in \N$}&#xA;\AXC{$\texttt{14}\in \N$}&#xA;\AXC{$\texttt{()} \in \ListOfInt$}&#xA;\BIC{$\texttt{(14 . ())}\in \ListOfInt$}&#xA;\BIC{$\texttt{(3 . (14 . ()))}\in \ListOfInt$}&#xA;\BIC{$\texttt{(-7 . (3 . (14 . ())))}\in \ListOfInt$}&#xA;\end{prooftree}$&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.1&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.1&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;写出下述集合的递归定义 。以三种方式 ( 自顶向下 / 自底向上 / 推理规则 ) 写出每个定义 , 并且用你的规则推导出下述集合可能包含的元素 。&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\{3n+2\mid n\in \N\}$&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;自顶向下 : $n\in S$ 当且仅当下述两个条件中有一个成立&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$n = 2$&lt;/li&gt;&#xA;&lt;li&gt;$n - 3 \in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;自底向上 : $S$ 为 $\N$ 的子集且为满足下述两个条件的最小集 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$2\in S$&lt;/li&gt;&#xA;&lt;li&gt;若 $n\in S$ 则 $n+3\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;推理规则 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;            \AXC{}&#xA;            \UIC{$2\in S$}&#xA;            \end{prooftree}$&lt;/li&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;            \AXC{$n\in S$}&#xA;            \UIC{$n+3\in S$}&#xA;            \end{prooftree}$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\{2n+3m+1\mid n,m\in \N\}$&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;自顶向下 : $n\in S$ 当且仅当下述三个条件有一个成立&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$n=1$&lt;/li&gt;&#xA;&lt;li&gt;$n-2\in S$ 或 $n-3\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;自底向上 : $S$ 为 $\N$ 的子集且为满足下述两个条件的最小集 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$1\in S$&lt;/li&gt;&#xA;&lt;li&gt;若 $n\in S$ 则 $n+2\in S$ 且 $n+3\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;推理规则 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;           \AXC{}&#xA;           \UIC{$1\in X$}&#xA;           \end{prooftree}$&lt;/li&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;           \AXC{$n\in S$}&#xA;           \UIC{$n+2\in S,~ n+3\in S$}&#xA;           \end{prooftree}$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\{(n,2n+1)\mid n\in \N\}$&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;自顶向下 : 一对自然数 $(n,m)\in S$ 当且仅当其下述两个条件中有一个成立 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$n=0$ 且 $m=1$ ,&lt;/li&gt;&#xA;&lt;li&gt;$(n-1,m-2)\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;自底向上 : $S$ 为 $\N$ 的子集且为满足下述两个条件的最小集 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$(0,1)\in S$&lt;/li&gt;&#xA;&lt;li&gt;若 $(n,m)\in S$ 则 $(n+1,m+2)\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;推理规则 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;            \AXC{}&#xA;            \UIC{$(0,1)\in S$}&#xA;            \end{prooftree}$&lt;/li&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;            \AXC{$(n,m)\in S$}&#xA;            \UIC{$(n+1,m+2)\in S$}&#xA;            \end{prooftree}$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\{(n,n^2\mid n\in \N)\}$ —— 请勿在您的规则中提到平方运算 。&#xA;提示 : 方程 $(n+1)^2=n^2+2n+1$ 会派上用场 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;自顶向下 : 一对自然数 $(n,m)\in S$ 当且仅当其下述两个条件中有一个成立 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$n=0$ 且 $m=0$ ,&lt;/li&gt;&#xA;&lt;li&gt;$(n-1,m-2n+1)\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;自底向上 : $S$ 为满足下述两个条件的包含 $\N$ 的最小集 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$(0,0)\in S$&lt;/li&gt;&#xA;&lt;li&gt;若 $(n,m)\in S$ 则 $(n+1,m+2n+1)\in S$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;推理规则 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;            \AXC{}&#xA;            \UIC{$(0,1)\in S$}&#xA;            \end{prooftree}$&lt;/li&gt;&#xA;&lt;li&gt;$\begin{prooftree}&#xA;            \AXC{$(n,m)\in S$}&#xA;            \UIC{$(n+1,m+2n+1)\in S$}&#xA;            \end{prooftree}$&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.2&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.2&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;下面这些推理规则所定义的集合应是什么样子的呢 ? 为什么呢 ?&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\begin{prooftree}&#xA;   \AXC{}&#xA;   \UIC{$(0,1)\in S$}&#xA;   \end{prooftree} \qquad\begin{prooftree}&#xA;   \AXC{$(n,k)\in S$}&#xA;   \UIC{$(n+1,k+7)\in S$}&#xA;   \end{prooftree}$&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;$\{(n,7n+1)\mid n\in \N\}$&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\begin{prooftree}&#xA;   \AXC{}&#xA;   \UIC{$(0,1)\in S$}&#xA;   \end{prooftree} \qquad\begin{prooftree}&#xA;   \AXC{$(n,k)\in S$}&#xA;   \UIC{$(n+1,2k)\in S$}&#xA;   \end{prooftree}$&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;$\{(n,2^n)\mid n\in \N\}$&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\begin{prooftree} \AXC{} \UIC{$(0,0,1)\in S$} \end{prooftree}&#xA;   \qquad\begin{prooftree}&#xA;   \AXC{$(n,i,j)\in S$}&#xA;   \UIC{$(n+1,j,i+j)\in S$}&#xA;   \end{prooftree}$&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;$\{(n, F(n), F(n+1))\mid n\in \N\}$&lt;/p&gt;&#xA;&lt;p&gt;想知道这是怎么得出的 ? 见&lt;strong&gt;差分方程组 difference equations&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$\begin{prooftree} \AXC{} \UIC{$(0,1,0)\in S$} \end{prooftree}&#xA;    \qquad\begin{prooftree} \AXC{$(n,i,j)\in S$} \UIC{$(n+1,i+2,i+j)\in S$} \end{prooftree}$ &lt;code&gt;[***]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;$\{(n,2n+1,n^2)\mid n\in \N\}$&lt;/p&gt;&#xA;&lt;p&gt;想知道这是怎么得出的 ? 见&lt;strong&gt;差分方程组 difference equations&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.3&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.3&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;找出自然数的子集 $T$ 满足 $0\in T$ , $T\neq S$ 且对任何 $n\in T$ 都有 $n+3\in T$ —— 其中 $S$ 为&lt;a href=&#34;#Def1.1.2&#34;&gt;定义 1.1.2&lt;/a&gt;&#xA;里提到的集合 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;$T=\N$&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;S1.1.2&#34;&gt;&lt;span&gt;1.1.2 用语法定义集合&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.1.2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;刚才的例子还算简单 , 但是不难想象在描述更复杂的数据类型时会有多么麻烦 ;&#xA;为缓解这一问题 , 我们将展示如何用&lt;strong&gt;语法 grammar&lt;/strong&gt; 来声明集合 。&#xA;语法常用来描述字符串构成的集合 , 但我们也可用它来定义&#xA;值构成的集合 。比如我们可以通过下述语法定义集 $\ListOfInt$ :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\ListOfInt &amp;::= \texttt{()} \\&#xA;\ListOfInt &amp;::= \texttt{(\Int  . \ListOfInt)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;上面两条规则分别对应&lt;a href=&#34;#Def1.1.4&#34;&gt;定义 1.1.4&lt;/a&gt; 里的两条性质 :&#xA;规则 1 声称空列表 $\texttt{()}$ 属于 $\ListOfInt$ ,&#xA;规则 2 声称若 $n\in \Int$ 且 $l\in \ListOfInt$ 则 $\texttt{($n$ . $l$)}\in \ListOfInt$ 。两条规则构成的集合称作&lt;strong&gt;语法 grammar&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;现在来仔细看看上述语法 。在刚才的语法中我们有&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;非终结符 non-terminal symbol&lt;/strong&gt; :&#xA;这些是被定义的集合的名称 。本例中虽然只提到了一个集合 ,&#xA;但是在一般情况下可能会定义好几个集合 。这些集合也称作&#xA;&lt;strong&gt;语法类别 syntactic categories&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;在书中我们会将非终结符和集合名的首字母大写 ,&#xA;但在提到它们的元素时则仍然使用小写字母 。这其实并不复杂 , 比如 :&#xA;虽然 $\Expression$ 是非终结符 , 但我们依然会写出如 $e\in \Expression$&#xA;或 &amp;quot; $e$ is an expression &amp;quot; 这样的语句 。&lt;/p&gt;&#xA;&lt;p&gt;另一种书写惯例叫做 &lt;strong&gt;Backus-Naur Form&lt;/strong&gt; , 简称 &lt;strong&gt;BNF&lt;/strong&gt; ,&#xA;即在单词周围加尖括号 , 如 $\langle \textrm{expression} \rangle$ 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;终结符 terminal symbol&lt;/strong&gt; : 这些是集合外在表示中的字符 ,&#xA;本例中则是 &amp;quot; $\texttt.$ &amp;quot; 、&amp;quot; $\texttt($ &amp;quot; 、&amp;quot; $\texttt)$ &amp;quot; 。&#xA;这些字符都以打字机字体显示 , 如 &amp;quot; $\texttt{lambda}$ &amp;quot; 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;派生式 production&lt;/strong&gt; :&#xA;前面的推理规则在这里称作是派生式 。每个派生式中左侧是一个非终结符 ,&#xA;右侧则包含终结符和非终结符 。左右两侧通常用符号 &amp;quot; $::=$ &amp;quot; 来分隔 ,&#xA;解读为 &amp;quot; 是 &amp;quot; 或者 &amp;quot; 可以是 &amp;quot; 。&#xA;派生式右侧声明了一种基于其他语法类别和终结符&#xA;( 如 &amp;quot; $\texttt($ &amp;quot; 、&amp;quot; $\texttt)$ &amp;quot; 、&amp;quot; $\texttt.$ &amp;quot; ) 构建当前语法类别的元素的方式 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;若某些语法类别的含义在语境中足够清晰&#xA;则在派生式中提到它们时通常不作定义 ,&#xA;如 $\Int$ 。&lt;/p&gt;&#xA;&lt;p&gt;语法通常以某种简写形式描述 。当一个派生式的左侧与前一派生式的左侧完全相同时 ,&#xA;我们通常会将其左侧省略 。因此上述语法基于此惯例可以写作&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\ListOfInt ::={}&amp; \texttt{()} \\&#xA;          ::={}&amp; \texttt{(\Int  . \ListOfInt)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;也可只写一次 $::=$ 和左侧的内容并用特殊符号 &amp;quot; $\mid$ &amp;quot; ( 竖线 , 读作 &amp;quot; 或 &amp;quot; ) 分隔派生式右侧内容 , 即&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\ListOfInt&#xA;::={} &amp; \texttt{()} %\\&#xA;\mid{} \texttt{(\Int  . \ListOfInt)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;S1.1.2-Kleene&#34;&gt;&lt;/a&gt;&lt;/div&gt;&#xA;另一种简写方式叫&lt;strong&gt;克莱尼星号 Kleene star&lt;/strong&gt; , 记作 $\{\ldots\}^*$ 。当它位于派生式右侧时则意味着会有一串由&#xA;任意数目个花括号间内容下的实例构成的序列 。若用克莱尼星号 , 则前面 $\ListOfInt$ 的定义可简写为&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;\ListOfInt ::={}&amp; \{\Int\}^*&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;这也涵盖了没有实例存在的情况 : 如果内容出现 $0$ 次则会获得空串 。&lt;/p&gt;&#xA;&lt;p&gt;星号记法的另一种变体叫&lt;strong&gt;克莱尼加号 Kleene plus&lt;/strong&gt; , 记作 $\{\ldots\}^+$ , 表示一串由单或多个实例构成的序列 。&#xA;上例中若把 $^+$ 换成 $^*$ , 则其定义的语法类型是非空的整数列表 。&lt;/p&gt;&#xA;&lt;p&gt;星号记法的另一种变体叫&lt;strong&gt;分隔符 separated list&lt;/strong&gt; 表示法 。例如 : $\{\Int\}^{*(c)}$ 表示一串含任意数目的 $\Int$ 中&#xA;的实例 , 并且它们以非空字符串 $c$ 分割 。同样该表示法也涵盖了没有实例的情况 : 如果有 $0$ 个实例那么&#xA;我们将得到空字符串 —— 例如 $\{\Int\}^{*(,)}$ 会含有述字符串 &lt;code&gt;8&lt;/code&gt; , &lt;code&gt;14,12&lt;/code&gt; , &lt;code&gt;7,3,14,16&lt;/code&gt; 而 $\{\Int\}^{*(\texttt{;})}$ 则会含有&#xA;下述字符串 &lt;code&gt; 8&lt;/code&gt; , &lt;code&gt;14;12&lt;/code&gt; , &lt;code&gt;7;3;14;16&lt;/code&gt; 。这些简写并不是必须的 , 没有它们我们照样可以重写语法 。&lt;/p&gt;&#xA;&lt;p&gt;假如集合由语法定义 , 那么可用&lt;strong&gt;语法推导 syntactic derivation&lt;/strong&gt; 证明给定值为其成员 ; 推导从集合对应的&#xA;非终结符开始 : 在每一步 ( 以箭头 $\Rightarrow$ 指示 ) 中非终结符会被替换为相应规则的右侧或者是被替换为某个&#xA;语法类别的已知成员 —— 如果该语法类别未被明确定义的话 。例如前面关于 $\texttt{(14 . ())}$ 是整数列表&#xA;的证明若是用语法推导便可写成&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t] &amp;&#xA;\ListOfInt \\\Rightarrow{}&amp; &#xA;\texttt{(\Int  . \ListOfInt)} \\\Rightarrow{}&amp; &#xA;\texttt{(14 . \ListOfInt)}    \\\Rightarrow{}&amp; &#xA;\texttt{(14 . ())}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;非终结符的替换顺序不影响结果 。下面是 $\texttt{(14 . ())}$ 的另一种推导 :&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t] &amp;&#xA;\ListOfInt \\\Rightarrow{}&amp; &#xA;\texttt{(\Int  . \ListOfInt)} \\\Rightarrow{}&amp; &#xA;\texttt{(\Int . ())}    \\\Rightarrow{}&amp; &#xA;\texttt{(14 . ())}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.4&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.4&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;写出 $\ListOfInt$ 推导 $\texttt{(-7 . (3 . (14 . ())))}$ 的完整步骤 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;$\begin{aligned}[t] &amp;&#xA;\ListOfInt                                \\\Rightarrow{}&amp;&#xA;\texttt{(\Int  . \ListOfInt)}             \\\Rightarrow{}&amp; &#xA;\texttt{(-7 . \ListOfInt}                 \\\Rightarrow{}&amp; &#xA;\texttt{(-7 . (\Int . \ListOfInt))}       \\\Rightarrow{}&amp;&#xA;\texttt{(-7 . (3 . (\Int . \ListOfInt)))} \\\Rightarrow{}&amp;&#xA;\texttt{(-7 . (3 . (14 . \ListOfInt)))}   \\\Rightarrow{}&amp;&#xA;\texttt{(-7 . (3 . (14 . ())))} &#xA;\end{aligned}$&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;现在来看一些常用集合的定义 。&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;不少符号操作过程被设计为处理只包含符号或者是其他具有同样约束条件的列表 。这样的列表叫&#xA;$\SList$ , 定义如下 :&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def1.1.6&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;定义 1.1.6&lt;/strong&gt; ( $\SList$ , $\SExp$ )&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;   \SList ::={}&amp; \texttt{(${\SExp}^*$)} \\&#xA;   \SExp  ::={}&amp; \Symbol \mid \SList&#xA;   \end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;$\SList$ 是串 $\SExp$ 序列 , 而 $\SExp$ 要么是个 $\SList$ 要么则是个符号 。下面是一些 $\SList$ :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;an&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;s-list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lots&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;nesting&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;我们有时也使用更宽泛的 $\SList$ 定义 , 即除了允许符号外还允许整数 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;对于一个叶节点都是数字且非叶节点都为符号的二叉树 , 其内部节点可以用一个含三个元素的列表&#xA;来表示 , 即&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def1.1.7&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;定义 1.1.7&lt;/strong&gt; ( 二叉树 )&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;   \Bintree ::={}&amp; \Int \mid \texttt{(\Symbol  \Bintree  \Bintree)}&#xA;   \end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;下面是一些二叉树的例子 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foo&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bar&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foo&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;baz&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bar&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foo&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;biz&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Lambda 演算&lt;/strong&gt;是种很简单的语言 , 常用于研究编程语言理论 。这种语言仅含变量引用 , 单参数过程&#xA;以及过程调用三种变体 。我们可通过下述语法对其进行定义 :&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def1.1.8&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;定义 1.1.8&lt;/strong&gt; ( Lambda 演算 )&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;   \LcExp   ::={}&amp; &#xA;   \Iden \\ ::={}&amp;&#xA;   \texttt{(lambda (\Iden) \LcExp)} \\::={}&amp;&#xA;   \texttt{(\LcExp  \LcExp)}&#xA;   \end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;其中 $\Iden$ 表示任何非 $\texttt{lambda}$ 的符号 。&lt;/p&gt;&#xA;&lt;p&gt;第二个派生式中的 $\Iden$ 是 $\texttt{lambda}$ 演算表达式&lt;strong&gt;体 body&lt;/strong&gt; 内某个变量的名称 。该变量称作约束变量 ,&#xA;因为它绑定 ( 或称捕获 ) 自己在表达式体中的所有出现 , 这些出现都指向其该变量 。&lt;/p&gt;&#xA;&lt;p&gt;要弄清楚是什么回事 , 考虑带有算术运算的 $\texttt{lambda}$ 演算表达式 。在此语言中&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;是个表达式且 &lt;code&gt;x&lt;/code&gt; 是一个约束变量 , 该表达式描述了一个给实参加 $5$ 的过程 。因此在&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;中 , &lt;code&gt;x&lt;/code&gt; 的最后一次出现指向的并非 $\texttt{lambda}$ 演算表达式中的 &lt;code&gt;x&lt;/code&gt; 。我们将在 &lt;a href=&#34;#S1.2.4&#34;&gt;1.2.4 节&lt;/a&gt;中详细讨论这一点 ,&#xA;在那里我们将引入 &lt;code&gt;occurs-free?&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;该语法将 $\LcExp$ 中元素定义为 Scheme 的值 , 因此写出操作它们的程序将会很容易 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;上述语法之所以被称作&lt;strong&gt;语境无关的 context-free&lt;/strong&gt; 是因为每条规则所定义的语法类别可以在任何提及它的&#xA;语境中使用 。而这并不是很具有约束性 。考虑二叉搜索树 , 其节点要么为空 , 要么则包含一个整数以及&#xA;两棵子树&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Def_BST&#34;&gt;&lt;/a&gt;&lt;/div&gt;$\qquad \begin{aligned}[t]&#xA;\BinSearchTree ::={}&amp; \texttt{()} \mid \texttt{(\Int  \BinSearchTree  \BinSearchTree)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;上述语法如实反映了每个节点的结构 , 但忽略了二叉搜索树的一个要求 : 所有左子树键的值都必须小于 (&#xA;或等于 ) 当前节点 , 而所有右子树的键值都应大于当前节点 。&lt;/p&gt;&#xA;&lt;p&gt;由于这条额外限制的存在 , 基于 $\BinSearchTree$ 的语法推导未必都是正确的 ; 要想判断一个派生式&#xA;可否用于特定的语法推导 , 我们就必须检查派生式被用于哪一种语境之中 。这样的限制叫&lt;strong&gt;语境有关约束&#xA;context-sensitive constraint&lt;/strong&gt; , 或称&lt;strong&gt;不变条件 invariant&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;语境有关约束也会在定义编程语言的语法时出现 , 如不少编程语言中变量在使用前都必须先声明 。这种&#xA;对变量使用的约束便对其语境产生有关性 。虽然形式化方法可以定义语境有关限制 , 但这些方法比本章&#xA;所考虑的更为复杂 。实际情况往往是 : 我们首先定义语境无关语法 , 然后再通过其他方法添加语境有关&#xA;约束 。这些技巧的相关案例将会在第 7 章出现 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;S1.1.3&#34;&gt;&lt;span&gt;1.1.3 数学归纳法&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.1.3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;递归描述完集合后这些递归定义有两种用途 : 要么拿它们去证那些判断元素与集合之间从属关系的定理 ,&#xA;要么拿它们编写程序以操作集合元素 。这里先提供一个此类证明的例子 , 编写程序则留作&lt;a href=&#34;#S1.2&#34;&gt;下一节&lt;/a&gt;的主题 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;定理 1.1.1&lt;/strong&gt; 若 $t$ 为一个二叉树 ( 如&lt;a href=&#34;#Def1.1.7&#34;&gt;定义 1.1.7&lt;/a&gt; 所述 ) , 则 $t$ 含奇数个节点 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;em&gt;证&lt;/em&gt; : 证明是通过对 $t$ 的&lt;strong&gt;尺寸 size&lt;/strong&gt; 进行归纳实现的 , 这里 $t$ 的尺寸为 $t$ 所含的节点个数 。归纳假设 $\InductHyp(k)$&#xA;为 &amp;quot; 任何尺寸 $\leq k$ 的树都只含有奇数个节点 &amp;quot; 。按照归纳法的惯例我们首先证 $\InductHyp(0)$ 成立 , 然后再证 &amp;quot;&#xA;若 $\InductHyp(k)$ 对任何整数 $k$ 都成立则亦有 $\InductHyp(k+1)$ &amp;quot; 。&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;没有不含节点的树 , 因此 $\InductHyp(0)$ 成立 ;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;假设 $\InductHyp(k)$ 对正整数 $k$ 成立 —— 即任何节点数目 $\leq k$ 的树都只含奇数个节点 ,&#xA;则证 $\InductHyp(k+1)$ 也成立  —— 即任何节点数目 $\leq k+1$ 的树都有奇数个节点 。&#xA;如果 $t$ 拥有的节点数 $\leq k+1$ , 那么根据前面二叉树的定义会有下述两种情况 :&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$t$ 可能形如 $n$ , 这里 $n$ 是整数 —— 此时 $t$ 只有一个节点 , 且 $1$ 是个奇数 ;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;$t$ 可能形如 $\texttt{({\rm sym} $t_1$ $t_2$)}$ —— 这里 $\texttt{sym}$ 为符号 , $t_1$ , $t_2$ 为树 ,&#xA;并且它们拥有的节点数肯定比原先的 $t$ 更少 ; 而 $t$ 所含的节点数小于等于 $k+1$ , 故 $t_1$ , $t_2$ 拥有的节点数比 $k$ 少 ;&#xA;如此它们便在 $\InductHyp(k)$ 的描述范围内 , 它们所拥有的节点数只能是奇数 —— 如分别为 $2n_1+1$ 和 $2n_2+1$ 。&#xA;因此 $t$ 拥有的节点数就应为&lt;/p&gt;&#xA;&lt;p&gt;$\qquad (2n_1+1)+(2n_2+1)+1=2(n_1+n_2+1)+1$&lt;/p&gt;&#xA;&lt;p&gt;而这同样也是个奇数 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;如此我们便完成了对 $\InductHyp(k+1)$ 的证明 , 也就完成了归纳证明 。&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;结构归纳法的证明步骤&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;要证明性质 $\textrm{\InductHyp}(s)$ 对所有结构 $s$ 都成立 , 请证明&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$\InductHyp$ 对所有简单结构 ( 即没有子结构的对象 ) 都成立 ;&lt;/li&gt;&#xA;&lt;li&gt;$\InductHyp$ 若对所有 $s$ 的子结构都成立那么 $\InductHyp$ 对 $s$ 也成立 。&lt;/li&gt;&#xA;&lt;/ol&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.5&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.5&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;证明 $e\in \LcExp$ 蕴含 $e$ 中开闭括号数目相等 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;证 : 对 $\texttt{lambda}$ 演算表达式 $e$ 的高度 $h(e)$ 进行归纳 。&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;对任何 $\texttt{lambda}$ 演算表达式 $e$ , $e_1$ , $e_2$ , 我们规定&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$h(e)=1$ 仅当 $e$ 形如 $\Iden$ ;&lt;/li&gt;&#xA;&lt;li&gt;$h(e)=d(e_1)+1$ 仅当 $e$ 形如 $\texttt{(lambda  (\Iden) $e_1$)}$ ;&lt;/li&gt;&#xA;&lt;li&gt;$h(e)=\max(d(e_1,e_2))$ 仅当 $e$ 形如 $\texttt{($e_1$  $e_2$)}$ 。&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;如果我们的归纳假设 $IH(k)$ 为 &amp;quot; 任意满足 $h(e)\leq k$ 的 $\texttt{lambda}$ 演算表达式 $e$ 所拥有的开闭括号数相等 &amp;quot; 。那么易知&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$IH(0)$ 必为真 —— 因为高度为 $0$ 的 $\texttt{lambda}$ 演算表达式都形如 $\Iden$ ;&lt;/li&gt;&#xA;&lt;li&gt;假如 $IH(k)$ 对正整数 $k$ 也成立 —— 即任何高度 $\leq k$ 的 $\texttt{lambda}$ 演算表达式所拥有的开闭括号数相等 , 则证 $IH(k+1)$ 也成立 —— 即任何高度 $\leq k+1$ 的 $\texttt{lambda}$ 演算表达式拥有的开闭括号数相等 。如果 $\texttt{lambda}$ 演算表达式 $e$ 的高度 $\leq k+1$ , 那么根据前面 $\texttt{lambda}$ 演算表达式的定义会有下述两种情况 :&#xA;&lt;ol&gt;&#xA;&lt;li&gt;$e$ 可能形如 $\texttt{(lambda  (\Iden) $e_1$)}$ , 这里 $e_1$ 也为 $\texttt{lambda}$ 演算表达式 —— 不难看出此时新增的开闭括号数是持平的 ;&lt;/li&gt;&#xA;&lt;li&gt;$e$ 可能形如 $\texttt{($e_1$  $e_2$)}$ , 这里 $e_1$ 和 $e_2$ 也为 $\texttt{lambda}$ 演算表达式 —— 同样这里新增的开闭括号数依然是持平的 。&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;如此我们便完成了对 $IH(k+1)$ 的证明 , 也就完成了归纳证明 。&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;S1.2&#34;&gt;&lt;span&gt;1.2 推导递归程序&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;我们已学会用递归定义构建复杂集合 , 且见识到通过分析这些集合的单个元素便可窥探集合的整体面貌 ;&#xA;我们用这一技巧写出了过程 &lt;code&gt;in-S?&lt;/code&gt; 以判断自然数是否为集合 $S$ 的成员 。我们将会用同样的思想定义更&#xA;通用的过程以便在这些集合上进行计算 。递归定义的过程依赖于下述重要原理 :&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;较小子问题原则&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;若能将问题归约为更小的子问题 , 则可以调用求解原问题的过程来求解子问题 。&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;已获得的子问题的解随后可用于求解原问题 。这一切之所以可行是因为每次我们调用过程都是针对一个&#xA;更小的子问题 , 直到最后一个可直接求解且无需进一步调用过程自身的子问题为止 。&lt;/p&gt;&#xA;&lt;p&gt;我们会用一些例子来解释这一思想 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;S1.2.1&#34;&gt;&lt;span&gt;1.2.1 &lt;code&gt;list-length&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.2.1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;标准的 Scheme 过程 &lt;code&gt;length&lt;/code&gt; 用于获取列表中元素个数 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;length &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;length &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;让我们来实现自己的 &lt;code&gt;length&lt;/code&gt; 并称之为 &lt;code&gt;list-length&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;首先写下过程的&lt;strong&gt;合约 contract&lt;/strong&gt; 。合约指明了过程所有实参所构成的集合以及所有可能的返回值构成的集 。&#xA;合约也可以包含过程应当具有的功能以及行为 。这有助于我们在编写程序及未来调试时追踪我们的意图 。&#xA;我们会将其作为一条注释加入代码中以便阅读 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : list-length : List-of-(SchemeValue)   → Natural&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (list-length            l         )   = l 的长度&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :               List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;list-length&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;我们可以将列表构成的集合定义为&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \List ::= \texttt{()}\mid  \texttt{(\ScmVal  . \List)}$&lt;/p&gt;&#xA;&lt;p&gt;现在来考虑列表的各种情况 : 如果列表为空则长度为 $0$ 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : list-length : List-of-(SchemeValue)   → Natural&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (list-length            l         )   = l 的长度&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :               List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;list-length&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;                                 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;如果列表非空则其长度比其 &lt;code&gt;cdr&lt;/code&gt; 长度多 $1$ 。这便推导出了完整的代码 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : list-length : List-of-(SchemeValue)   → Natural&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (list-length            l         )   = l 的长度&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :               List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;list-length&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-length&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;我们可以根据 &lt;code&gt;list-length&lt;/code&gt; 的定义窥探其计算的原理 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;          &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;      &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;      &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;S1.2.2&#34;&gt;&lt;span&gt;1.2.2 &lt;code&gt;nth-element&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.2.2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;标准的 Scheme 过程 &lt;code&gt;list-ref&lt;/code&gt; 以一个列表 &lt;code&gt;lst&lt;/code&gt; 及一个从 $0$ 开始计数的索引 &lt;code&gt;n&lt;/code&gt; 为实参并返回 &lt;code&gt;lst&lt;/code&gt; 的第&#xA;&lt;code&gt;n&lt;/code&gt; 个元素 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list-ref &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;让我们写出自己的 &lt;code&gt;list-ref&lt;/code&gt; 并称之为 &lt;code&gt;nth-element&lt;/code&gt; 。同样沿用前面 $\List$ 的定义 。&lt;/p&gt;&#xA;&lt;p&gt;$\texttt{(nth-element $lst$ $n$)}$ 在实参 $lst$ 为空时应返回什么结果呢 ?&#xA;此时 $\texttt{(nth-element $lst$ $n$)}$ 想找出&#xA;空列表的元素 , 因此应给出报错 。&lt;/p&gt;&#xA;&lt;p&gt;$\texttt{(nth-element $lst$ $n$)}$ 在实参 $lst$ 非空时又应该返回什么结果呢 ?&#xA;此时的返回值将取决于 $n$ : 若 $n = 0$&#xA;则返回值应为 $lst$ 的 &lt;code&gt;car&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;$\texttt{(nth-element $lst$ $n$)}$ 在实参 $lst$ 非空且 $n\neq 0$ 时又应返回什么呢 ?  此时返回值将会是 $lst$ 的 &lt;code&gt;cdr&lt;/code&gt; 的&#xA;第 $n-1$ 个元素 。由 $n\in \N$ 且 $n\neq 0$ 可知 $n-1$ 一定是属于 $\N$ , 因此可递归地调用 &lt;code&gt;nth-element&lt;/code&gt; 来&#xA;找出第 $n-1$ 个元素 。如此便推导出了完整的代码 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : nth-element : List-of-(SchemeValue) × Natural   → SchemeValue&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (nth-element            lst              n  )   = lst 的第 n 个元素&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :               List-of-(SchemeValue)           ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                       Natural ::=  0 | (succ Natural)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;nth-element&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;report-list-too-short&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zero? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;nth-element&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;report-list-too-short&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;eopl:error&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;nth-element&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;s&#34;&gt;&amp;#34;List too short by ~s elements.~%&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;上面的注释 &lt;code&gt;nth-element : List × Int → SchemeVal&lt;/code&gt;  表示过程  &lt;code&gt;nth-element&lt;/code&gt;  取两个参数 ( 一个列表和&#xA;一整数 ) 并返回一个 Scheme 值 。这与在数学中写下公式 $f : A \times B \to C$ 时所使用的记法有类似之处 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;report-list-too-short&lt;/code&gt; 通过调用 &lt;code&gt;eopl:error&lt;/code&gt; 实现报错 , 后者会终止计算 。该过程第一个参数是个符号 ,&#xA;用于在错误信息中指出调用 &lt;code&gt;eopl:error&lt;/code&gt; 的过程 ; 而第二个参数则是一个字符串 , 即为待打印的错误信息 ;&lt;br&gt;&#xA;对于该字符串中的每个字符序列 &lt;code&gt;~s&lt;/code&gt; 都必须提供一个额外实参 , 实参的值将用于替换对应的 &lt;code&gt;~s&lt;/code&gt; ;  而 &lt;code&gt;~%&lt;/code&gt;&#xA;则会被视作换行 。错误信息打印完后计算将会被停止 。过程 &lt;code&gt;eopl:error&lt;/code&gt; 并不是标准 Scheme 的一部分 ,&#xA;但大多数 Scheme 的实现都有提供类似的功能 ; 本书将始终采用名称带前缀 &lt;code&gt;report-&lt;/code&gt; 的过程来实现类似&#xA;风格的报错 。现在来看看 &lt;code&gt;nth-element&lt;/code&gt; 如何计算结果 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;nth-element&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;nth-element&lt;/span&gt;   &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;nth-element&lt;/span&gt;     &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;nth-element&lt;/span&gt;       &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;=&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;这里 &lt;code&gt;nth-element&lt;/code&gt; 递归处理的列表和数字都在变得越来越小 。&lt;/p&gt;&#xA;&lt;p&gt;若错误检查被省略 , 那么就得依赖 &lt;code&gt;car&lt;/code&gt; 和 &lt;code&gt;cdr&lt;/code&gt; 的报错来知悉空列表被作为实参传入 ; 但它们的错误信息&#xA;提供不了太多信息 。假如报错是从 &lt;code&gt;car&lt;/code&gt; 发出的 , 那可能得找遍程序中所有用到 &lt;code&gt;car&lt;/code&gt; 的地方才能定位错误 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.6&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.6&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;若是调换 &lt;code&gt;nth-element&lt;/code&gt; 中条件语句里的测试顺序 , 则会有什么样的问题呢 ?&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;car&lt;/code&gt; 可能会作用于 &lt;code&gt;&#39;()&lt;/code&gt; 。&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.7&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.7&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;nth-element&lt;/code&gt; 的错误信息仍不够详尽 , 请重写 &lt;code&gt;nth-element&lt;/code&gt; 并给出更详细的错误信息 ——&#xA;如 &amp;quot; &lt;code&gt;(a b c)&lt;/code&gt; 拥有的元素数目不到 8 个 &amp;quot; 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;report-list-too-short&lt;/code&gt; 修改后结果如下 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;report-list-too-short&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;eopl:error&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;nth-element&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;s&#34;&gt;&amp;#34;List too short by ~s elements.~%&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;S1.2.3&#34;&gt;&lt;span&gt;1.2.3 &lt;code&gt;remove-first&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.2.3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;过程 &lt;code&gt;remove-first&lt;/code&gt; 取两个参数 : 一个符号 $s$ 及一个符号列表 $los$ 。其应返回一个列表 , 该列表除了不含&#xA;$s$ 在 $los$ 中的首个出现外其余元素及排列顺序都应与 $los$ 相同 。若 $s$ 在 $los$ 中没有出现则原样返回 $los$ 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;remove-first&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;remove-first&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;remove-first&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;a4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;c1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;a4&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;a4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;c1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;a4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;remove-first&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;在写下此过程的完整定义前 , 我们必须通过定义符号列表所构成的集合 $\ListOfSymbol$ 以给出问题的&#xA;完整描述 。与上一节介绍的 $\SList$ 所不同的是 , 符号列表并不包含子列表 。&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \ListOfSymbol ::= \texttt{()} \mid \texttt{(\Symbol  . \ListOfSymbol)}$&lt;/p&gt;&#xA;&lt;p&gt;符号列表要么是空列表 , 要么则满足 &lt;code&gt;car&lt;/code&gt; 是单个符号且 &lt;code&gt;cdr&lt;/code&gt; 也是一个符号列表 。&lt;/p&gt;&#xA;&lt;p&gt;如果列表为空 , 则没有待移除的 $s$ 的出现 , 因此返回值为空列表 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : remove-first : Symbol × List-of-(Symbol)   → List-of-(Symbol)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (remove-first     s          los       )   = 删去 s 在 los 中的首次出现&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                         List-of-(Symbol) ::= () | (Symbol . List-of-(Symbol))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;remove-first&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;在写合约时我们用的是 $\ListOf{\Symbol}$ 而非 $\ListOfSymbol$ ; 之所以采用这样的记法是因为其可以&#xA;免除许多类似前面提到的定义 。&lt;/p&gt;&#xA;&lt;p&gt;如果 $los$ 非空 , 那么有没有哪种情况可允许我们立刻得出结果呢 ? 假如 $los$ 的首个元素是 $s$ —— 如 $los $&#xA;$= \texttt{($s$ $s_1$ $&amp;hellip;$ $s_{n-1}$)}$ , 那么 $s$ 的首个出现便是 $los$ 的 &lt;code&gt;car&lt;/code&gt; ; 因此将其剔除后结果应该为 $\texttt{($s_1$ $&amp;hellip;$ $s_{n-1}$)}$ 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : remove-first : Symbol × List-of-(Symbol)   → List-of-(Symbol)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (remove-first     s          los       )   = 删去 s 在 los 中的首次出现&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                         List-of-(Symbol) ::= () | (Symbol . List-of-(Symbol))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;remove-first&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;          &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;            &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;如果 $los$ 的首个元素不是 $s$ —— 比如 $los = \texttt{($s_0$ $s_1$ $&amp;hellip;$ $s_{n-1}$)}$ , 那么便可得知 $s_0$ 不是第一个出现的 $s$ ,&#xA;因此返回值的第一个元素一定会是 $s_0$ —— 也就是 &lt;code&gt;(car los)&lt;/code&gt; 的值 。如此 $los$ 里 $s$ 的首个出现肯定会落在&#xA;$\texttt{($s_1$ $&amp;hellip;$ $s_{n-1}$)}$ 中 , 说明返回值的 &lt;code&gt;cdr&lt;/code&gt; 肯定是通过移除 $los$ 的 &lt;code&gt;cdr&lt;/code&gt; 的首个 $s$ 的出现获得的 ; 而 $los$ 的 &lt;code&gt;cdr&lt;/code&gt;&#xA;肯定比 $los$ 短 ,  因此可通过递归调用 &lt;code&gt;remove-first&lt;/code&gt; 从 $los$ 的 &lt;code&gt;cdr&lt;/code&gt; 中移除 $s$ 的出现 , 即返回值的 &lt;code&gt;cdr&lt;/code&gt; 可由 &lt;code&gt;(remove-first s (cdr los))&lt;/code&gt; 求得 。既然已经知道如何找出返回值的 &lt;code&gt;car&lt;/code&gt; 和 &lt;code&gt;cdr&lt;/code&gt; , 便可用 &lt;code&gt;cons&lt;/code&gt; 结合二者 ,&#xA;通过代码 &lt;code&gt;(cons (car los) (remove-first s (cdr los)))&lt;/code&gt; 即得返回值 。故 &lt;code&gt;remove-first&lt;/code&gt; 的完整定义应为&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : remove-first : Symbol × List-of-(Symbol)   → List-of-(Symbol)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (remove-first     s          los       )   = 删去 s 在 los 中的首次出现&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                         List-of-(Symbol) ::= () | (Symbol . List-of-(Symbol))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;remove-first&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;           &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;remove-first&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))))&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.8&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.8&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;若是将 &lt;code&gt;remove-first&lt;/code&gt; 定义的最后一行改为 &lt;code&gt;(remove-first s (cdr los))&lt;/code&gt; , 那么得到的过程将进行什么样的运算呢 ? 请为修改后的过程给出合约以及其用法 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 : 可以将新的过程称作 &lt;code&gt;drop-until&lt;/code&gt; 。&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : drop-until : Symbol × List-of-(Symbol)   → List-of-(Symbol)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (drop-until     s         los        )   = 删去 los 中 s 的首次出现之前的所有元素&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                       List-of-(Symbol) ::= () | (Symbol . List-of-(Symbol))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;drop-until&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;           &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;drop-until&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))))&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.9&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.9&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;定义 &lt;code&gt;remove&lt;/code&gt; : 它类似 &lt;code&gt;remove-first&lt;/code&gt; , 但会从符号列表中移除给定符号的所有出现而不仅仅是第一个 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : remove : Symbol × List-of-(Symbol)   → List-of-(Symbol)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (remove    s            los      )   = 删去 los 中 s 的所有出现&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                   List-of-(Symbol) ::= () | (Symbol . List-of-(Symbol))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;remove&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;remove&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 此即与 remove-first 所不同之处&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;remove&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;los&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;S1.2.4&#34;&gt;&lt;span&gt;1.2.4 &lt;code&gt;occurs-free?&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.2.4&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;过程 &lt;code&gt;occurs-free?&lt;/code&gt; 取一个由 Scheme 符号表示的变量 $var$ 以及一个如&lt;a href=&#34;#Def1.1.8&#34;&gt;定义 1.1.8&lt;/a&gt; 所述的 $\texttt{lambda}$ 演算表达式&#xA;$exp$ 并判断 $var$ 在 $exp$ 中是否存在自由出现 。我们称变量在 $exp$ 中&lt;strong&gt;自由出现 occurs free&lt;/strong&gt; 当且仅当其于&#xA;$exp$ 中存在不位于与之同名的变量的所有 $\texttt{lambda}$ 绑定下的出现 。如 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;                                   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;                                   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;                  &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;                  &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;              &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;我们可以遵照 lambda 演算表达式的语法来解决此问题：&lt;/p&gt;&#xA;&lt;p&gt;$\qquad \begin{aligned}[t]&#xA;\LcExp   ::={}&amp; &#xA;\Iden \\ ::={}&amp;&#xA;\texttt{(lambda (\Iden) \LcExp)} \\::={}&amp;&#xA;\texttt{(\LcExp  \LcExp)}&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;我们可以总结出规则里的各种情况：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;若表达式 $e$ 是变量 , 则变量 $x$ 在 $e$ 中有自由出现&#xA;当且仅当 $x$ 与 $e$ 完全一致 。&lt;/li&gt;&#xA;&lt;li&gt;若表达式 $e$ 形如 $\texttt{(lambda ($y$) $e&amp;rsquo;$)}$ , 则变量 $x$ 在 $e$ 中有自由出现&#xA;当且仅当 $y$ 不同于 $x$ 且 $x$ 在 $e&#39;$ 中有自由出现 。&lt;/li&gt;&#xA;&lt;li&gt;若表达式 $e$ 形如 $\texttt{($e_1$ $e_2$)}$ , 则变量 $x$ 在 $e$ 中有自由出现&#xA;当且仅当 $x$ 在 $e_1$ 或 $e_2$ 中都有自由出现 。这里的 ” 或 &amp;quot; 意为&lt;strong&gt;兼有或 inclusive or&lt;/strong&gt; ,&#xA;表示其也涵盖了 $x$ 在 $e_1$ 和 $e_2$ 中同时有自由出现的情况 。我们通常用 &amp;quot; 或 &amp;quot; 来表示这个意思 。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;你应确信上述规则精准捕获了 &amp;quot; $x$ 的出现不在 $x$ 的所有 $\texttt{lambda}$ 绑定之下 &amp;quot; 所描述的概念 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.10&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.10&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;我们常用 &amp;quot; 或 &amp;quot; 表示 &amp;quot; 逻辑或 &amp;quot; 。&amp;quot; 或 &amp;quot; 还有什么含义？&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;异或 XOR , 同英文里的 &amp;quot; either &amp;hellip; or &amp;hellip; &amp;quot; 。&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;后面定义 &lt;code&gt;occurs-free?&lt;/code&gt; 就很容易了 。由于有三种情况要检查 , 故这里用的是 Scheme 的 &lt;code&gt;cond&lt;/code&gt; 而非 &lt;code&gt;if&lt;/code&gt; 。&#xA;在 Scheme 中 $\texttt{(or $exp_1$ $exp_2$)}$ 会在 $exp_1$ 和 $exp_2$ 里有一个为真的情况下返回真 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : occurs-free? : Symbol × LcExp   → Bool&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (occurs-free?   var      exp)   = 布尔值 , 若符号 var 在 exp 中自由出现则返回 #t 否则返回 #f&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                         LcExp ::= Symbol | (lambda (Symbol) LcExp) | (LcExp LcExp)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;occurs-free?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;symbol? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;lambda&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;and &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;not &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;caddr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;or &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;occurs-free?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;这一过程略显晦涩 : 如我们很难猜到 &lt;code&gt;(car (cadr exp))&lt;/code&gt; 指的是 $\texttt{lambda}$ 演算表达式中的变量声明 ; 又或者是 &lt;code&gt;(caddr exp)&lt;/code&gt; 指的是 $\texttt{lambda}$ 演算表达式的主体 。在&lt;a href=&#34;http://localhost:1313/posts/1568c34/#S2.5&#34;&gt;第 2.5 节&lt;/a&gt;里我们将会展示如何可以显著地改善这种状况 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;S1.2.5&#34;&gt;&lt;span&gt;1.2.5 &lt;code&gt;subst&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.2.5&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;过程 &lt;code&gt;subst&lt;/code&gt; 取三个参数 : 两个符号 &lt;code&gt;new&lt;/code&gt; 和 &lt;code&gt;old&lt;/code&gt; 及一个 $\SList$ &lt;code&gt;slist&lt;/code&gt; , 它会检查 &lt;code&gt;slist&lt;/code&gt; 的所有元素并返回&#xA;一个类似 &lt;code&gt;slist&lt;/code&gt; 的新列表 —— 只不过新列表中所有的 &lt;code&gt;old&lt;/code&gt; 都会被替换为 &lt;code&gt;new&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;subst&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;由于 &lt;code&gt;subst&lt;/code&gt; 是基于 $\SList$ 定义的 , 因此其结构应体现出 $\SList$ 的定义 ( 见&lt;a href=&#34;#Def1.1.6&#34;&gt;定义 1.1.6&lt;/a&gt; )&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;\SList ::={}&amp; \texttt{(\(\{\SExp\}^*\))} \\&#xA;\SExp  ::={}&amp; \Symbol \mid  \SList&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;克莱尼星号给出了集合 $\SList$ 的精简表示 , 但这对写程序没什么用 ; 因此我们的第一步是删去克莱尼星号&#xA;并重写语法 。重写后的语法指明我们的过程应该递归处理 $\SList$ 的首项和余项 。&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\begin{aligned}[t]&#xA;\SList ::={}&amp; \texttt{()} %\\&#xA;       %::={}&amp; &#xA;       \mid  \texttt{(\SExp  . \SList)} \\&#xA;\SExp  ::={}&amp; \Symbol \mid  \SList&#xA;\end{aligned}$&lt;/p&gt;&#xA;&lt;p&gt;这个例子比之前的更为复杂 —— 因为过程的其中一个输入对应的语法含有两个非终结符 $\SList$ 和 $\SExp$ 。&#xA;因此我们需要两个过程 , 一个用于处理 $\SList$ 而另一个则用于 $\SExp$ 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : subst : Symbol × Symbol × S-list   → S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (subst   new      old     slist)   = 将 slist 中所有 old 替换为 new&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                           S-list ::= () | (S-exp . S-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;subst&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : subst-in-s-exp : Symbol × Symbol × S-exp   → S-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (subst-in-s-exp   new      old     sexp)   = 将 sexp 中所有 old 替换为 new&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                    S-exp ::= Symbol | S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;subst-in-s-exp&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;我们首先处理 &lt;code&gt;subst&lt;/code&gt; 。如果列表为空则无需替换 &lt;code&gt;old&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : subst : Symbol × Symbol × S-list   → S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (subst   new      old     slist)   = 将 slist 中所有 old 替换为 new&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                           S-list ::= () | (S-exp . S-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;subst&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &#x9;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;如果 &lt;code&gt;slist&lt;/code&gt; 非空 , 那么它的 &lt;code&gt;car&lt;/code&gt; 是一个 $\SExp$ 而 &lt;code&gt;cdr&lt;/code&gt; 是另一 $\SList$ ; 这时返回值应是一个列表 , 它的 &lt;code&gt;car&lt;/code&gt; 应&#xA;等于 &lt;code&gt;slist&lt;/code&gt; 的 &lt;code&gt;car&lt;/code&gt; , 只不过其中的 &lt;code&gt;old&lt;/code&gt; 全部被替换为 &lt;code&gt;new&lt;/code&gt; ; 而它的 &lt;code&gt;cdr&lt;/code&gt; 则应该等于 &lt;code&gt;slist&lt;/code&gt; 的 &lt;code&gt;cdr&lt;/code&gt; , 只不过其中的 &lt;code&gt;old&lt;/code&gt; 全部都被替换为 &lt;code&gt;new&lt;/code&gt; 。由于 &lt;code&gt;slist&lt;/code&gt; 的 &lt;code&gt;car&lt;/code&gt; 是 $\SExp$ 的元素 , 因此考虑用 &lt;code&gt;subst-in-s-exp&lt;/code&gt; 解决&#xA;该子问题 ; 由于 &lt;code&gt;slist&lt;/code&gt; 的 &lt;code&gt;cdr&lt;/code&gt; 是 $\SList$ 的元素 , 因此考虑递归调用 &lt;code&gt;subst&lt;/code&gt; 处理它 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : subst : Symbol × Symbol × S-list   → S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (subst   new      old     slist)   = 将 slist 中所有 old 替换为 new&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                           S-list ::= () | (S-exp . S-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;subst&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;subst-in-s-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;subst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;      &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;现在处理 &lt;code&gt;subst-in-s-exp&lt;/code&gt; 。&#xA;由语法可知符号表达式 &lt;code&gt;sexp&lt;/code&gt; 要么是符号要么则是 $\SList$ 。&#xA;如果是符号则检查它与符号 &lt;code&gt;old&lt;/code&gt; 是否一致 :&#xA;若一致则返回值为 &lt;code&gt;new&lt;/code&gt; ,&#xA;否则仍为 &lt;code&gt;sexp&lt;/code&gt; ;&#xA;若 &lt;code&gt;sexp&lt;/code&gt; 是 $\SList$ 则递归调用&lt;code&gt;subst&lt;/code&gt; 求解 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;hl&#34;&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : subst-in-s-exp : Symbol × Symbol × S-exp   → S-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (subst-in-s-exp   new      old     sexp)   = 将 sexp 中所有 old 替换为 new&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                    S-exp ::= Symbol | S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;subst-in-s-exp&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;symbol? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                           &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;subst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;                  &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;由于该过程是严格按照 $\SList$ 和 $\SExp$ 的定义来编写的 , 因此这个递归最终一定会停止 。其中 &lt;code&gt;subst&lt;/code&gt; 和 &lt;code&gt;subst-in-s-exp&lt;/code&gt; 递归调用彼此 , 因此便称之为&lt;strong&gt;互为递归的 mutually recursive&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;把 &lt;code&gt;subst&lt;/code&gt; 拆解为两个过程分别处理一种语法类别是一种重要的技巧 。&#xA;该技巧允许我们每次只专注于一种语法类别 , 从而极大地简化我们对于复杂程序的思考 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.11&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.11&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;subst-in-s-exp&lt;/code&gt; 的最后一行中递归是针对 &lt;code&gt;sexp&lt;/code&gt; 而非更小的子结构 , 为什么它照样可以停机 ?&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;因为实参 &lt;code&gt;subst&lt;/code&gt; 和 &lt;code&gt;subst-in-s-exp&lt;/code&gt; 的长度会不断变小 。&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.12&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.12&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;用 &lt;code&gt;subst-in-s-exp&lt;/code&gt; 的定义替换 &lt;code&gt;subst&lt;/code&gt; 中对自己的调用以将这次调用排除 ,&#xA;然后再简化最终的过程 。在最后的结果中 &lt;code&gt;subst&lt;/code&gt; 应当不需要 &lt;code&gt;subst-in-s-exp&lt;/code&gt; 。&#xA;这种技巧叫&lt;strong&gt;内联 inlining&lt;/strong&gt; , 用于优化编译器 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : subst : Symbol × Symbol × S-list   → S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (subst   new      old     slist)   = 将 slist 中所有 old 替换为 new&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                           S-list ::= () | (S-exp . S-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;subst&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)])&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;symbol? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                       &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;subst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;subst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.13&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.13&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;前面的例子中我们先从排除 $\SList$ 语法内的克莱尼星号开始 。现请依照原本的语法用 &lt;code&gt;map&lt;/code&gt; 重写 &lt;code&gt;subst&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : subst : Symbol × Symbol × S-list   → S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (subst   new      old     slist)   = 将 slist 中所有 old 替换为 new&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                           S-list ::= () | (S-exp . S-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;subst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.16 的 map&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;subst-in-s-exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;old&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;现在我们已拥有编写过程处理归纳数据集的套路 , 让我们把它总结成一句口诀 。&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;遵循语法 !&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;若要基于递归定义的数据集编写过程 , 则过程的结构应与数据集的结构保持一致 。&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;更准确地说：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;为语法中的每个非终结符都编写一个过程 。该过程只负责处理相应非终结符的数据 。&lt;/li&gt;&#xA;&lt;li&gt;在每个过程中为相应非终结符的每一派生式写一分支 。你可能需要创建更多的分支 ,&#xA;但只有这样才能起步 。然后对派生式右侧出现的每个非终结符递归地调用对应过程 。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;S1.3&#34;&gt;&lt;span&gt;1.3 辅助过程和语境参数&lt;/span&gt;&#xA;  &lt;a href=&#34;#S1.3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;前面的&lt;strong&gt;遵循语法&lt;/strong&gt;窍口诀虽然很强大 , 但还是有失效的时候 。现在来考虑过程 &lt;code&gt;number-elements&lt;/code&gt; : 任何形如&#xA;$\texttt{($v_0$ $v_1$ $v_2$ ...)}$ 的列表都会被其变成 $\texttt{((0 $v_0$) (1 $v_1$) (2 $v_2$) ...)}$ 。&lt;/p&gt;&#xA;&lt;p&gt;前面那种直接分解的方法在这里并不奏效 , 因为没有明显的方法可使我们从 &lt;code&gt;(number-elements (cdr lst))&lt;/code&gt; 得出 &lt;code&gt;(number-elements lst)&lt;/code&gt; ( 但是 , 请看&lt;a href=&#34;#Xer1.36&#34;&gt;练习 1.36&lt;/a&gt; ) 。&lt;/p&gt;&#xA;&lt;p&gt;要解决这个问题我们需要考虑更一般的情况 。现在来写一个叫 &lt;code&gt;number-elements-from&lt;/code&gt; 的新过程 : 相较于&#xA;原先的过程 , 它取一个额外实参 $n$ 以指定编号的起始数字 。该过程可以很轻松地写出 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : number-elements-from : List-of-(SchemeValue) × Natural   → List-of-((Natural SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (number-elements-from   &amp;#39;(v0 v1 v2 ...)          n   )   = ((n v0) (n+1 v1) (n+2 v2) ...)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                        List-of-(SchemeValue)           ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                                Natural ::=  0 | (succ Natural)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;number-elements-from&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number-elements-from&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;这里合约告诉我们该过程取一个列表 ( 包含任意 Scheme 值 )&#xA;及一个整数作为实参并返回一个列表 , 列表的各个元素都是包含两个元素的列表 :&#xA;一个是整数 , 而另一个则是 Scheme 值 。&lt;/p&gt;&#xA;&lt;p&gt;一旦定义好了 &lt;code&gt;number-elements-from&lt;/code&gt; 便可很轻松地写出所需的过程 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : number-elements : List-of-(SchemeValue)   → List-of-((Natural SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (number-elements     &amp;#39;(v0 v1 v2 ...))     = ((0 v0) (1 v1) (2 v2) ...)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                   List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;number-elements&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number-elements-from&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;有两个点需要注意 : 首先 &lt;code&gt;number-elements-from&lt;/code&gt; 的定义独立于 &lt;code&gt;number-elements&lt;/code&gt; 。程序员往往需要写一个过程来调用某个辅助过程并固定某个额外的常量作为实参 。除非我们理解辅助过程会对每个实参对应的值施加什么效果 , 否则我们很难理解调用它究竟可以做什么 。这便给了我们一条口诀 :&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;没有神秘的辅助过程 ！&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;定义辅助过程时请指明它对任何可能的实参所进行的处理 , 而不仅仅是初始值 。&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;其次 &lt;code&gt;number-elements-from&lt;/code&gt; 的两个参数各自扮演着不同的角色 :&#xA;第一个参数是待处理的列表 , 其随着每次递归调用不断减小 ;&#xA;而第二个参数则是对我们当前任务的&lt;strong&gt;语境 context&lt;/strong&gt; 的抽象 。本例中 ,&#xA;调用 &lt;code&gt;number-elements&lt;/code&gt; 最终都会变成调用 &lt;code&gt;number-elements-from&lt;/code&gt; 处理原列表的每个子列表 。第二个参数告知我们子列表在原列表中的位置 , 随着递归调用它并不会递减反而是逐渐增加 —— 因为我们每次都会经过原列表的一个元素 。该参数我们称作为&lt;strong&gt;语境参数 context argument&lt;/strong&gt; 或&lt;strong&gt;继承属性 inherited attribute&lt;/strong&gt; 。&lt;/p&gt;&#xA;&lt;p&gt;另一个案例是将向量的各个分量相加 ( 简称对向量求和 ) 。&lt;/p&gt;&#xA;&lt;p&gt;若要算列表中各个元素的和则可遵循语法递归处理列表的 &lt;code&gt;cdr&lt;/code&gt; 。如此我们的过程就应为&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : list-sum : List-of-(Int)   → Int&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (list-sum      loi     )   = loi 里所有整数的和&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :            List-of-(Int) ::= () | (Int . List-of-(Int))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;list-sum&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-sum&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;但是我们无法按照这种方式处理向量 , 因为它们不能直接被拆解 。&lt;/p&gt;&#xA;&lt;p&gt;由于我们无法拆解向量 , 因此现在考虑更一般的问题 : 为向量的一部分求和 。该问题的描述是计算&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\quad \displaystyle\sum_\mathclap{i=0}^\mathclap{i=length(v)-1} v_i\quad$&lt;/p&gt;&#xA;&lt;p&gt;其中 $v$ 是整数构成的向量 。我们可通过将上界修改为一个形参 $n$ 来将问题一般化 , 如此新的任务便是求&lt;/p&gt;&#xA;&lt;p&gt;$\qquad\quad \displaystyle\sum_{i=0}^{i=n} v_i$&lt;/p&gt;&#xA;&lt;p&gt;其中 $0 \leq n &lt; length(v)$ 。对应的过程可以很轻松地写出 , 通过对第二个实参 $n$ 使用归纳法即可完成 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 :  partial-vector-sum : Vector-of-(Int) × Natural → Int&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (partial-vector-sum          v             n  ) = v0 到 vn 的和 , 若 0 &amp;lt;= n &amp;lt; length(v) &lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 : ?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;partial-vector-sum&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zero? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;vector-ref &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;vector-ref &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;partial-vector-sum&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;由于 $n$ 会一直递减到 $0$ , 因此对此程序正确性的证明可以通过对 $n$&#xA;使用归纳法来完成 。由 $0\leq n$ 且 $n\neq 0$ 知 $0\leq n-1$ ,&#xA;故递归调用 &lt;code&gt;partial-vector-sum&lt;/code&gt; 仍可满足其合约 。&lt;/p&gt;&#xA;&lt;p&gt;现在要解决原问题就简单得多了 。&#xA;过程 &lt;code&gt;partial-vector-sum&lt;/code&gt; 无法应用于长度为 $0$ 的向量 ,&#xA;因此我们还得单独处理上述情况 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : vector-sum : Vector-of-(Int)   → Int&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (vector-sum         v      )   = 对向量 v 进行求和&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 : ?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;vector-sum&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;vector-length &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zero? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;partial-vector-sum&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;还有很多情况可通过引入辅助变量来解决或改善 。&#xA;只要能为新过程给出独立的定义 , 就请尽情地尝试吧 !&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.14&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.14&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;基于 $0 \leq n &lt; length(v)$ 证明 &lt;code&gt;partial-vector-sum&lt;/code&gt; 的正确性 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;证 : 对向量 $v$ 的长度 $length(v)$ 进行归纳 。这里不再赘述 。&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;14-习题&#34;&gt;&lt;span&gt;1.4 习题&lt;/span&gt;&#xA;  &lt;a href=&#34;#14-%e4%b9%a0%e9%a2%98&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;想获得编写递归程序的诀窍离不开大量的练习 。那就让我们以一系列习题作为本章的结束把 。&lt;/p&gt;&#xA;&lt;p&gt;在下面的每道练习题中 : &lt;code&gt;s&lt;/code&gt; 为符号 , &lt;code&gt;n&lt;/code&gt; 为非负整数 , &lt;code&gt;lst&lt;/code&gt; 为列表 , &lt;code&gt;loi&lt;/code&gt; 为整数列表 , &lt;code&gt;slist&lt;/code&gt; 为 $\SList$ , &lt;code&gt;x&lt;/code&gt; 为任意 $\ScmVal$ ; 类似地 &lt;code&gt;s1&lt;/code&gt; 为符号 , &lt;code&gt;los2&lt;/code&gt; 为符号列表 , &lt;code&gt;x1&lt;/code&gt; 为 $\ScmVal$ , 等等 。另外假定 &lt;code&gt;pred&lt;/code&gt; 是个谓词 —— 即仅返回 &lt;code&gt;#t&lt;/code&gt; 或 &lt;code&gt;#f&lt;/code&gt; 的过程 。请勿对数据做出额外假设 , 除非问题另有额外限制 。在这些习题中您不需要检查输入是否符合描述 ; 对每个过程我们都假定其输入值是指定集合的成员 。&lt;/p&gt;&#xA;&lt;p&gt;请定义 , 测试并调试每个过程 。你的定义应包含如前面所述的合约和用途注释 。您可以随便定义辅助过程 , 但请为每个辅助过程补充说明 , 正如 &lt;a href=&#34;#S1.3&#34;&gt;1.3 节&lt;/a&gt; 那样 。&lt;/p&gt;&#xA;&lt;p&gt;在测试这些程序时 , 请先尝试给出所有已提供的例子 , 然后再用其他例子测试 ; 因为书本提供的例子不足以涵盖所有可能的错误 。&lt;/p&gt;&#xA;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.15&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.15&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(duple n x)&lt;/code&gt; 返回一个包含 &lt;code&gt;n&lt;/code&gt; 个 &lt;code&gt;x&lt;/code&gt; 的列表 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;duple&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;duple&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;ha&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ha&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ha&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ha&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ha&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;duple&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;blah&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : duple : Natural × S-exp   → List-of-(S-exp)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (duple     n      sexp)   = 将 sexp 重复 n 遍&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :         Natural         ::= 0 | (succ Natural)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;duple&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zero? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;duple&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.16&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.16&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(invert lst)&lt;/code&gt; 会将 &lt;code&gt;lst&lt;/code&gt; 里面每个 $\textrm{2-List}$ 的顺序颠倒 。&#xA;其中 &lt;code&gt;lst&lt;/code&gt; 是由 $\textrm{2-List}$ ( 长度为 $2$ 的列表 ) 构成的列表 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;invert&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : invert : List-of-(2-list)   → List-of-(2-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (invert        lst      )   = 将 lst 中的每个元素颠倒顺序&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :          List-of-(2-list) ::= ({2-list}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;invert&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pair&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;pair&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;pair&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : map :  (A → B) × List-of-(A)   → List-of-(B)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (map    proc         lst   )   = 返回 proc 在 lst 上的像&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                  List-of-(A) ::= () | (A . List-of-(A))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.17&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.17&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(down lst)&lt;/code&gt; 会为 &lt;code&gt;lst&lt;/code&gt; 中的元素再加一层括号 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;down&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;down&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;fine&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;idea&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;fine&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;idea&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;down&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;more&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;complicated&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;more&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;complicated&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : down : List-of-(SchemeValue)   → List-of-(List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (down          lst         )   = 为 lst 中的元素再加一层括号&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :        List-of-(SchemeValue) ::= ({SchemeValue}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;down&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;list&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.16 的 map&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.18&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.18&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(swapper s1 s2 slist)&lt;/code&gt; 会将 &lt;code&gt;slist&lt;/code&gt; 中 &lt;code&gt;s1&lt;/code&gt; 和 &lt;code&gt;s2&lt;/code&gt; 的所有出现都分别换成 &lt;code&gt;s2&lt;/code&gt; 和 &lt;code&gt;s1&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;swapper&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;swapper&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;swapper&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;z&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;z&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : swapper : Symbol × Symbol × S-list   → S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (swapper    s1       s2     slist)   = 将 slist 中所有 s1 和 s2 的出现对调&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                             S-list ::= ({S-exp}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;swapper&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.16 的 map&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;swapper-in-s-sexp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : swapper-in-s-exp : Symbol  ×  Symbol  ×  S-exp   → S-exp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (swapper-in-s-exp    s1         s2       sexp)   = 将 sexp 中所有 s1 和 s2 的出现对调&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                          S-exp ::= Symbol | S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;swapper-in-s-sexp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;cond&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;symbol? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;cond&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                      &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                      &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                      &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;swapper&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.19&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.19&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(list-set lst n x)&lt;/code&gt; 会将 &lt;code&gt;lst&lt;/code&gt; 中的第 &lt;code&gt;n&lt;/code&gt; 个元素 ( 从 &lt;code&gt;0&lt;/code&gt; 算起 ) 设置为 &lt;code&gt;x&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list-ref &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-set&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : list-set : List-of-(SchemeValue) × Natural × SchemeValue   → List-of-(SchemeValue)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (list-set           lst               n          x     )   = 将 lst 中的第 n 个元素设置为 x&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                    Natural               ::=  0 | (succ Natural)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-set&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zero? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-set&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.20&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.20&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(count-occurrences s slist)&lt;/code&gt; 返回 &lt;code&gt;s&lt;/code&gt; 在 &lt;code&gt;slist&lt;/code&gt; 中的出现次数 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;count-occurrences&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;count-occurrences&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;count-occurrences&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;w&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : count-occurences : Symbol × S-list   → Natural&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (count-occurences    s      slist)   = 返回 s 在 slist 中的出现次数&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                             S-list ::= () | (S-exp . S-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;count-occurrences&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;count-occurrences-in-sexp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;count-occurrences&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : count-occurences-in-sexp : Symbol × S-exp   → Natural&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (count-occurences-in-sexp    s       exp)   = 返回 s 在 sexp 中的出现次数&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                     S-exp ::= Symbol | S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;count-occurrences-in-sexp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;symbol? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;count-occurrences&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sexp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.21&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.21&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(product sos1 sos2)&lt;/code&gt; 返回一个元素且皆为 $\textrm{2-List}$ 的列表 , 其代表了&#xA;&lt;code&gt;sos1&lt;/code&gt; 和 &lt;code&gt;sos2&lt;/code&gt; 这两个不含重复元素的列表的笛卡尔积 。元素排列顺序任意 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;filter-in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;number?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;filter-in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;symbol?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 :  product : List-of-(SchemeValue) × List-of-(SchemeValue)   → List-of-(2-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (product            sos1                    sos2       )   = 求 sos1 和 sos2 的笛卡尔积&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                    List-of-(SchemeValue) ::= ({SchemeValue}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;product&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sos1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;sos2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flat-map&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;e1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;e2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.16 的 map&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;e1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;nv&#34;&gt;sos2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nv&#34;&gt;sos1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : flat-map : (List-of-(A) → List-of-(B)) × List-of-(List-of-(A))   → List-of-(B)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (flat-map              proc                      lst         )   = 获得 List-of-(List-of-(B)) 后把列表压扁&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                          List-of-(List-of-(A)) ::= () | (A . List-of-(List-of-(A)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flat-map&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;append &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 注意 : 若是 cons 则效果同 map&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flat-map&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.22&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.22&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(filter-in pred lst)&lt;/code&gt; 利用 &lt;code&gt;pred&lt;/code&gt; 来筛选出 &lt;code&gt;lst&lt;/code&gt; 中所有符合条件的元素 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;filter-in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;number?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;filter-in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;symbol?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 :  filter-in : (SchemeValue → Bool) × List-of-(SchemeValue)   → List-of-(SchemeValue)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (filter-in               pred               lst         )   = 筛选出 lst 中所有满足 `pred` 的元素&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                     List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;filter-in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;head&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;filtered-tail&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;filter-in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))])&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;head&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;filtered-tail&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nv&#34;&gt;filtered-tail&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;下面是第二种解法 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 :  filter-in : (SchemeValue → Bool) × List-of-(SchemeValue)   → List-of-(SchemeValue)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (filter-in               pred               lst         )   = 筛选出 lst 中所有满足 `pred` 的元素&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                     List-of-(SchemeValue) ::= ({SchemeValue}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;filter-in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flat-map&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.21 的 flat-map&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.23&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.23&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(list-index pred lst)&lt;/code&gt; 返回 &lt;code&gt;lst&lt;/code&gt; 中第一个满足 &lt;code&gt;pred&lt;/code&gt; 的元素的索引 ( 从 &lt;code&gt;0&lt;/code&gt; 开始算起 ) 。&#xA;如果 &lt;code&gt;lst&lt;/code&gt; 没有符合条件的元素则返回 &lt;code&gt;#f&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-index&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;number?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-index&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;symbol?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-index&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;symbol?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 :  list-index: (SchemeValue → Bool) × List-of-(SchemeValue)   → N&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (list-index          pred                  ls t         )   = lst 中第一个满足 pred 的元素的索引&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                     List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-index&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;else&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;index&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;list-index&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))])&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;index&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               &lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.24&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.24&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(every? pred lst)&lt;/code&gt; 返回 &lt;code&gt;#t&lt;/code&gt; 仅当 &lt;code&gt;lst&lt;/code&gt; 中的所有元素皆满足 &lt;code&gt;pred&lt;/code&gt; , 否则返回 &lt;code&gt;#f&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;every?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;number?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;every?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;number?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : every? : (SchemeValue → Bool) × List-of-(SchemeValue)   → Bool&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (every?           pred                 lst          )   = 判断 lst 中所有元素是否都满足 pred&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                 List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;every?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;every?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;下面是第二种解法 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : every? : (SchemeValue → Bool) × List-of-(SchemeValue)   → Bool&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (every?           pred                 lst          )   = 判断 lst 中是否存在元素满足 pred&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                 List-of-(SchemeValue) ::= ({SchemeValue}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;every?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foldr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;and &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : foldr : (A -&amp;gt; B -&amp;gt; B) × B × List-of-(A) -&amp;gt; B&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (foldr       f2R        i       xs    ) = ...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                             List-of-(A) = () | (A . List-of-(A))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foldr&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;f2R&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;xs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;xs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;i&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;f2R&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;xs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foldr&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;f2R&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;xs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.25&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.25&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(exists? pred lst)&lt;/code&gt; 返回 &lt;code&gt;#t&lt;/code&gt; 仅当 &lt;code&gt;lst&lt;/code&gt; 中存在元素满足 &lt;code&gt;pred&lt;/code&gt; , 否则返回 &lt;code&gt;#f&lt;/code&gt; 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;exists?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;number?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;exists?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;number?&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : exists? : (SchemeValue → Bool) × List-of-(SchemeValue)   → Bool&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (exists?           pred                   lst        )   = 判断 lst 中是否存在元素满足 pred&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                  List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;exists?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;#t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;exists?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;下面是第二种方案&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : exists? : (SchemeValue → Bool) × List-of-(SchemeValue)   → Bool&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (exists?           pred                   lst        )   = 判断 lst 中是否存在元素满足 pred&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                  List-of-(SchemeValue) ::= ({SchemeValue}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;exists?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foldr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;or &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;no&#34;&gt;#f&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.24 的 foldr&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.26&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.26&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(up lst)&lt;/code&gt; 会移除 &lt;code&gt;lst&lt;/code&gt; 中每个元素最外层的括号 —— 如果可以的话 , 否则则保留元素 。&#xA;注意 : &lt;code&gt;(up (down lst))&lt;/code&gt; 等同于 &lt;code&gt;lst&lt;/code&gt; 但 &lt;code&gt;(down (up lst))&lt;/code&gt; 未必就是 &lt;code&gt;lst&lt;/code&gt; ( 见&lt;a href=&#34;#Xer1.17&#34;&gt;练习 1.17&lt;/a&gt; ) 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : up : List-of-(SchemeValue)   → List-of-(SchemeValue)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (up          lst         )   = 尽可能去掉 lst 元素的一层括号&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :      List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;append &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;下面是第二种解法 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : up : List-of-(SchemeValue)   → List-of-(SchemeValue)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (up          lst         )   = 尽可能去掉 lst 元素的一层括号&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :      List-of-(SchemeValue) ::= () | ({SchemeValue}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foldr&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.24 的 foldr&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;todo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;todo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;append &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;todo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;todo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.27&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.27&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(flatten slist)&lt;/code&gt; 会移除 &lt;code&gt;slist&lt;/code&gt; 中元素的所有括号 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : flatten : S-list   → List-of-(SchemeValue)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (flatten  slist)   = 压扁 slist&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :           S-list ::= () | (S-exp . S-list)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :           S-exp  ::= SchemeValue | S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;append &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;下面是第二种做法 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : flatten : S-list   → List-of-(SchemeValue)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (flatten  slist)   = 压扁 slist&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :           S-list ::= ({S-exp}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :           S-exp  ::= SchemeValue | S-list&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foldr&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.24 的 foldr&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;todo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;todo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;append &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;flatten&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;todo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;todo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;done&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;nv&#34;&gt;slist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.28&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.28&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(merge loi1 loi2)&lt;/code&gt; 会合并递增整数列表 &lt;code&gt;loi1&lt;/code&gt; 和 &lt;code&gt;loi2&lt;/code&gt; 并将结果递增排序 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;35&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;62&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;81&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;91&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;83&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;85&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;35&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;62&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;81&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;83&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;85&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;91&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : merge : List-of-(Int) × List-of-(Int)   → List-of-(Int)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (merge      loi1            loi2    )   = 合并 loi1 和 loi2 并递增排序&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                         List-of-(Int) ::= () | (Int . List-of-(Int))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;lt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                         &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;下面是第二种做法 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : merge : List-of-(Int) × List-of-(Int)   → List-of-(Int)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (merge      loi1            loi2    )   = 合并 loi1 和 loi2 并递增排序&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                         List-of-(Int) ::= ({Int}*)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foldr&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;test&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.24 的 foldr&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;lt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.29&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.29&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(sort loi)&lt;/code&gt; 会对 &lt;code&gt;loi&lt;/code&gt; 进行递增排序 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sort&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : sort : List-of-(Int)   → List-of-(Int)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (sort      loi     )   = 对 loi 进行排序&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :        List-of-(Int) ::= () | (Int . List-of-(Int))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sort&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge-sort&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; merge 见上一题的第二种解法&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge-sort&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge-sort&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cddr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;下面是第二种解法 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : sort : List-of-(Int)   → List-of-(Int)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (sort      loi     )   = 对 loi 进行排序&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :        List-of-(Int) ::= (Int . List-of-(Int))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sort&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sort&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; merge 见上一题的第二种解法&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.30&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.30&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;&lt;code&gt;(sort/predicate pred loi)&lt;/code&gt; 会根据谓词 &lt;code&gt;pred&lt;/code&gt; 对 &lt;code&gt;loi&lt;/code&gt; 进行排序 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sort/predicate&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sort/predicate&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : sort/predicate : (Int → Bool) × List-of-(Int)   → List-of-(Int)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (sort/predicate       pred          loi     )   = 根据 pred 对 loi 进行排序&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                 List-of-(Int) ::= () | (Int . List-of-(Int))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;sort/predicate&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge-sort&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge-sort&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge/predicate&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge-sort&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cddr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))]))&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge-sort&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;list&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 借用练习 1.16 的 map&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : merge/predicate : (Int → Bool) × List-of-(Int) × List-of-(Int)   → List-of-(Int)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (merge/predicate      pred           loi1            loi2    )   = ...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                                                  List-of-(Int) ::= () | (Int . List-of-(Int))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge/predicate&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge/predicate&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;merge/predicate&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;pred&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loi1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;loi2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.31&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.31&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;请提供下述与二叉树 $\Bintree$ ( 见&lt;a href=&#34;#Def1.1.7&#34;&gt;定义 1.1.7&lt;/a&gt; ) 相关的过程 :&#xA;&lt;code&gt;leaf&lt;/code&gt; 和 &lt;code&gt;interior-node&lt;/code&gt; 用于构建二叉树 ,&#xA;&lt;code&gt;leaf?&lt;/code&gt; 用于判断二叉树是否为叶节点 ,&#xA;&lt;code&gt;lson&lt;/code&gt; , &lt;code&gt;rson&lt;/code&gt; 和 &lt;code&gt;contents-of&lt;/code&gt; 则用于提取节点的内容 。&#xA;&lt;code&gt;contents-of&lt;/code&gt; 应对任何节点都有效 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 类型语法 : Bintree ::= Int | (Symbol Bintree Bintree)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 类型构造器 : &lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;                       &lt;span class=&#34;c1&#34;&gt;;; 创建叶节点&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 创建非叶节点&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;rson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 类型谓词 :&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;                   &lt;span class=&#34;c1&#34;&gt;;; 判断节点是否为叶节点&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;number? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 类型观测器 :&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lson&lt;/span&gt;                           &lt;span class=&#34;c1&#34;&gt;;; 获取节点左子树&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nv&#34;&gt;cadr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;rson&lt;/span&gt;                           &lt;span class=&#34;c1&#34;&gt;;; 获取节点右子树&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nv&#34;&gt;caddr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;contents-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;;; 获取节点内容&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.32&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.32&lt;/strong&gt; &lt;code&gt;[*]&lt;/code&gt;&lt;br&gt;&#xA;请给出过程 &lt;code&gt;double-tree&lt;/code&gt; 的定义 :&#xA;其以一个二叉树 ( 见&lt;a href=&#34;#Def1.1.7&#34;&gt;定义 1.1.7&lt;/a&gt; ) 为实参&#xA;并输出一个结构相同的二叉树 —— 只不过这里每个节点的内容数目都翻倍 。&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : double-tree : Bintree   → Bintree&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (double-tree   tree )   = 将 tree 中节点的内容翻倍&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :               Bintree ::= Int | (Symbol Bintree Bintree)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;double-tree&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;maptree&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;* &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : maptree : (A → B) × Bintree   → Bintree(B)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (maptree   proc      tree )   = tree 中所有节点内容都被应用 proc&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                     Bintree ::= Int | (Symbol Bintree Bintree)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;maptree&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;contents-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;maptree&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;maptree&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.33&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.33&lt;/strong&gt; &lt;code&gt;[**]&lt;/code&gt;&lt;br&gt;&#xA;请给出过程 &lt;code&gt;mark-leaves-with-red-depth&lt;/code&gt; 的定义 :&#xA;其以一个二叉树 ( 见&lt;a href=&#34;#Def1.1.7&#34;&gt;定义 1.1.7&lt;/a&gt; ) 为实参&#xA;并输出一个结构相同的二叉树 —— 只不过这里每个节点包含的内容为&#xA;从自身到根节点之间所有带符号 &lt;code&gt;red&lt;/code&gt; 的节点的数目 。举个例子 :&#xA;由&lt;a href=&#34;#Xer1.31&#34;&gt;练习 1.31&lt;/a&gt; 里提到的过程所构建的表达式&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mark-leaves-with-red-depth&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;red&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;bar&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;26&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;red&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;quux&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;117&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;应返回下述 $\Bintree$ :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;red&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bar&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;red&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;quux&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : mark-leaves-with-red-depth : Bintree   → Bintree&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (mark-leaves-with-red-depth   tree )   =   ...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                              Bintree ::= Int | (Symbol Bintree Bintree)     &lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mark-leaves-with-red-depth&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mark&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;eqv? &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;contents-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;red&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;red&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mark&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                          &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mark&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;contents-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                               &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mark&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                               &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mark&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))])))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.34&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.34&lt;/strong&gt; &lt;code&gt;[***]&lt;/code&gt;&lt;br&gt;&#xA;请给出过程 &lt;code&gt;path&lt;/code&gt; 的定义 :&#xA;其以一个整数 &lt;code&gt;n&lt;/code&gt; 以及一个包含 &lt;code&gt;n&lt;/code&gt; 的二叉搜索树 &lt;code&gt;bst&lt;/code&gt; ( 见&lt;a href=&#34;#Def_BST&#34;&gt;此处&lt;/a&gt; ) 作为实参&#xA;并返回一个包含 &lt;code&gt;left&lt;/code&gt; 和 &lt;code&gt;right&lt;/code&gt; 的列表以指示如何才能找到包含 &lt;code&gt;n&lt;/code&gt; 的节点 。&#xA;如果 &lt;code&gt;n&lt;/code&gt; 在根结点处被发现 , 那么其将会返回一个空列表 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;26&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;right&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : path : Int × BinarySearchTree   → List-of-(Symbol)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (path   n          tree     )   = 至内容为 n 的节点的路线&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 : ?&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;value-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;car&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;cadr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;caddr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;cond &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;bst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;eopl:error&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;path&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Element ~s not found&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;= &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;value-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;lt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;value-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;&amp;#39;left&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else &lt;/span&gt;                 &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;&amp;#39;right&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))])))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.35&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.35&lt;/strong&gt; &lt;code&gt;[***]&lt;/code&gt;&lt;br&gt;&#xA;请给出过程 &lt;code&gt;number-leaves&lt;/code&gt; 的定义 :&#xA;其以一个二叉树为实参并输出一个类似的二叉树 ——&#xA;不过这里的节点是按照广度优先搜索从 &lt;code&gt;0&lt;/code&gt; 开始进行标记 。比如&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number-leaves&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;foo&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;bar&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;26&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;baz&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;&amp;#39;quux&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;117&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;应当返回&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;foo&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bar&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;baz&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;quux&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : number-leaves: Bintree   → Bintree&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (number-leaves  tree )   = 根据广度优先搜索对 tree 进行标记&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                Bintree ::= Int | (Symbol Bintree Bintree)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number-leaves&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf?&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;leaf&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let* &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lson-result&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lson-n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lson-result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new-lson&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lson-result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rson-result&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lson-n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rson&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;rson-n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;rson-result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new-rson&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;rson-result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;rson-n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;interior-node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;contents-of&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                    &lt;span class=&#34;nv&#34;&gt;new-lson&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                    &lt;span class=&#34;nv&#34;&gt;new-rson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cadr &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;div class=&#34;fi-row&#34;&gt;&lt;a id=&#34;Xer1.36&#34;&gt;&lt;/a&gt;&lt;/div&gt;&lt;strong&gt;练习 1.36&lt;/strong&gt; &lt;code&gt;[***]&lt;/code&gt;&lt;br&gt;&#xA;请给出辅助过程 &lt;code&gt;g&lt;/code&gt; 以使得前面提到的 &lt;a href=&#34;#S1.3&#34;&gt;&lt;code&gt;number-elements&lt;/code&gt;&lt;/a&gt; 可通过如下方式定义 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : number-elements : List-of-(SchemeValue)   → List-of-((Natural SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (number-elements     &amp;#39;(v0 v1 v2 ...))     = ((0 v0) (1 v1) (2 v2) ...)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                   List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;number-elements&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;number-elements&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;lst&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;div class=&#34;details admonition note&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;答 :&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;div class=&#34;highlight&#34; data-open=&#34;true&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-scheme&#34; data-lang=&#34;scheme&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程合约 : g : SchemeValue × List-of-(SchemeValue)   → List-of-((Int SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 过程用途 : (g      head              tail        )   = ...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; 实参语法 :                   List-of-(SchemeValue) ::= () | (SchemeValue . List-of-(SchemeValue))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;define &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;head&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;tail&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;null? &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;tail&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let* &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;next&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;car &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;tail&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;new-next&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;+ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cons &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;head&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;new-next&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cdr &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;tail&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; 结构有点像 foldr 但并不是 foldr , 除非保证存在一个 f2R 能同时概括 cons 和 new-next&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;</description>
    </item>
    <item>
      <title>Hugo FixIt 主题配置</title>
      <link>http://localhost:1313/posts/config-hugo_fixit/</link>
      <pubDate>Mon, 24 Mar 2025 17:10:04 +0800</pubDate>
      <guid>http://localhost:1313/posts/config-hugo_fixit/</guid>
      <description>&lt;h2 class=&#34;heading-element&#34; id=&#34;数学公式-mathjax-配置&#34;&gt;&lt;span&gt;数学公式 MathJax 配置&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e6%95%b0%e5%ad%a6%e5%85%ac%e5%bc%8f-mathjax-%e9%85%8d%e7%bd%ae&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;配置流程&#34;&gt;&lt;span&gt;配置流程&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e9%85%8d%e7%bd%ae%e6%b5%81%e7%a8%8b&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;下述操作参考链接&lt;a href=&#34;https://github.com/hugo-fixit/FixIt/issues/574&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;在此&lt;/a&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; 。&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;首先将 &lt;code&gt;./themes/FixIt/layouts/partials/assets.html&lt;/code&gt;&#xA;复制到 &lt;code&gt;./layouts/partials/assets.html&lt;/code&gt; ,&lt;br&gt;&#xA;然后将其中与 KaTeX 中的内容删除 , 并把下述内容粘贴进该文件中 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- /* MathJax */ -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $math := .Scratch.Get &amp;#34;math&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- if $math.enable -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;MathJax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;loader&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;[custom]/xypic.js&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;custom&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;https://cdn.jsdelivr.net/gh/sonoisa/XyJax-v3@3.0.1/build/&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;tex&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;packages&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;[+]&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;xypic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;inlineMath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\\(&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;\\)&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;$&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;displayMath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\\[&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;\\]&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$$&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;$$&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;processEscapes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// processEnvironments: true,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;useLabelIds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;options&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;skipHtmlTags&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;script&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;noscript&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;style&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;textarea&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;pre&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;enableMenu&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;text/javascript&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;MathJax-script&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;async&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;nt&#34;&gt;mjx-container&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;display&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;inline&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;overflow-x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;overflow-y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;max-width&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;nt&#34;&gt;mjx-container&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;svg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;display&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;inline&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;grid&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;!important&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;overflow-x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;overflow-y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;max-width&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- end -}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;为使行内公式能正确加载 , 我们还需允许 &lt;a href=&#34;https://gohugo.io/render-hooks/passthrough/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;passthrough render hooks&lt;/code&gt;&lt;/a&gt;&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; 。&#xA;具体配置参考&lt;a href=&#34;https://gohugo.io/render-hooks/passthrough/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;官方文档&lt;/a&gt;&lt;sup id=&#34;fnref1:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; 。&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;测试结果&#34;&gt;&lt;span&gt;测试结果&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e6%b5%8b%e8%af%95%e7%bb%93%e6%9e%9c&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;行间公式测试 :&lt;/p&gt;&#xA;$$&#xA;   \rm\LaTeX\text{ definitions are here.}&#xA;   \let\ph=\phantom&#xA;   \let\vph=\vphantom&#xA;   \def\pila{\vph{fg}}&#xA;   $$&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;行内公式测试 :&lt;/p&gt;&#xA;&lt;p&gt;$c = \pm\sqrt{a^2 + b^2}$ 和&#xA;$\displaystyle f(x)=\int_{-\infty}^{\infty} \hat{f}(\xi) e^{2 \pi i \xi x} d \xi$  以及&#xA;$x^2 +y^2=1$ 、&#xA;$&#xA;   \begin{array}{|l|l|}\hline&#xA;   \cellcolor{LightGreen} \rm Hello &amp; \rm World\pila \\\hline&#xA;   \end{array}&#xA;   $ 。&#xA;$&#xA;   % \begin{array}{l}&#xA;   % \qquad~~\begin{xy}0;p+/r+1cm/:&#xA;   % (-1,+.75)*++&lt;3pt&gt;[F-:&lt;10pt&gt;:Gray][=stateOld]{}=&#34;MaI1&#34;;&#xA;   % (-1,-.75)*[stateOld]{}=&#34;MaIn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}}&#xA;   % ?(.5)=&#34;MaL&#34;*[gray]!L{\small I_a};&#34;MaL&#34;.&#xA;   % &#34;MaIn&#34;.&#34;MaI1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MaI&#34;;&#xA;   % (+1,+.75)*++&lt;3pt&gt;[F=:&lt;10pt&gt;:Gray][=stateOldFin]{}=&#34;MaF1&#34;;&#xA;   % (+1,-.75)*[stateOldFin]{}=&#34;MaFn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}},&#xA;   % ,?(.5)=&#34;MaR&#34;*[gray]!R{\small F_a};&#34;MaR&#34;.&#xA;   % &#34;MaFn&#34;.&#34;MaF1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MaF&#34;;&#xA;   % &#34;MaL&#34;;&#34;MaR&#34;**@{}?(.5)*[gray]{\small M_a}.&#xA;   % &#34;MaF&#34;.&#34;MaI&#34;*+&lt;4pt&gt;[F-:&lt;5pt&gt;]\frm{}=&#34;Ma&#34;;&#xA;   % % -----------------------------------------------------------&#xA;   % &#34;MaI1&#34;!L;&#34;MaIn&#34;!L**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{\ar@[gray]@{-&gt;}@`{c+/l+1.5pc/,c}c};&#xA;   % % -----------------------------------------------------------&#xA;   % (5.15,0);p+/r+1cm/:&#xA;   % % -----------------------------------------------------------&#xA;   % (-1,+.75)*[stateOld]{}=&#34;MbI1&#34;;&#xA;   % (-1,-.75)*[stateOld]{}=&#34;MbIn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}}&#xA;   % ?(.5)=&#34;MbL&#34;*[gray]!L{\small I_b};&#34;MbL&#34;.&#xA;   % &#34;MbIn&#34;.&#34;MbI1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MbI&#34;;&#xA;   % (+1,+.75)*[stateOldFin]{}=&#34;MbF1&#34;;&#xA;   % (+1,-.75)*[stateOldFin]{}=&#34;MbFn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}},&#xA;   % ,?(.5)=&#34;MbR&#34;*[gray]!R{\small F_b};&#34;MbR&#34;.&#xA;   % &#34;MbFn&#34;.&#34;MbF1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MbF&#34;;&#xA;   % &#34;MbL&#34;;&#34;MbR&#34;**@{}?(.5)*[gray]{\small M_b}.&#xA;   % &#34;MbF&#34;.&#34;MbI&#34;*+&lt;4pt&gt;[F-:&lt;5pt&gt;]\frm{}=&#34;Mb&#34;;&#xA;   % % -----------------------------------------------------------&#xA;   % &#34;MbI1&#34;!L;&#34;MbIn&#34;!L**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{\ar@[gray]@{-&gt;}@`{c+/l+1.5pc/,c}c};&#xA;   % \end{xy}&#xA;   % \\&#xA;   % \begin{xy}p+/r+1cm/:p+/u+1cm/::&#xA;   % (-2.5,-1.375)*++&lt;3pt&gt;[F-:&lt;10pt&gt;][=stateNew]{}=&#34;p&#34;,&#xA;   % {\ar@{.&gt;}@`{c+/l+3pc/,&#34;p&#34;}&#34;p&#34;};&#xA;   % % -------------------------------------------------------&#xA;   % (-1,+.75)*++&lt;3pt&gt;[F-:&lt;10pt&gt;:Gray][=stateOld]{}=&#34;MaI1&#34;;&#xA;   % (-1,-.75)*[stateOld]{}=&#34;MaIn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}}&#xA;   % ?(.5)=&#34;MaL&#34;*[gray]!L{\small I_a};&#34;MaL&#34;.&#xA;   % &#34;MaIn&#34;.&#34;MaI1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MaI&#34;;&#xA;   % (+1,+.75)*++&lt;3pt&gt;[F=:&lt;10pt&gt;:Gray][=stateOldFin]{}=&#34;MaF1&#34;;&#xA;   % (+1,-.75)*[stateOldFin]{}=&#34;MaFn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}},&#xA;   % ,?(.5)=&#34;MaR&#34;*[gray]!R{\small F_a};&#34;MaR&#34;.&#xA;   % &#34;MaFn&#34;.&#34;MaF1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MaF&#34;;&#xA;   % &#34;MaL&#34;;&#34;MaR&#34;**@{}?(.5)*[gray]{\small M_a}.&#xA;   % &#34;MaF&#34;.&#34;MaI&#34;*+&lt;4pt&gt;[F-:&lt;5pt&gt;]\frm{}=&#34;Ma&#34;;&#xA;   % % -----------------------------------------------------------&#xA;   % (0,-2.75);p+/r+1cm/:&#xA;   % (-1,+.75)*[stateOld]{}=&#34;MbI1&#34;;&#xA;   % (-1,-.75)*[stateOld]{}=&#34;MbIn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}}&#xA;   % ?(.5)=&#34;MbL&#34;*[gray]!L{\small I_b};&#34;MbL&#34;.&#xA;   % &#34;MbIn&#34;.&#34;MbI1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MbI&#34;;&#xA;   % (+1,+.75)*[stateOldFin]{}=&#34;MbF1&#34;;&#xA;   % (+1,-.75)*[stateOldFin]{}=&#34;MbFn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}},&#xA;   % ,?(.5)=&#34;MbR&#34;*[gray]!R{\small F_b};&#34;MbR&#34;.&#xA;   % &#34;MbFn&#34;.&#34;MbF1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MbF&#34;;&#xA;   % &#34;MbL&#34;;&#34;MbR&#34;**@{}?(.5)*[gray]{\small M_b}.&#xA;   % &#34;MbF&#34;.&#34;MbI&#34;*+&lt;4pt&gt;[F-:&lt;5pt&gt;]\frm{}=&#34;Mb&#34;;&#xA;   % % -----------------------------------------------------------&#xA;   % &#34;MaI1&#34;!L;&#34;MaIn&#34;!L**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{\ar@{&lt;.}@`{c+/l+2pc/,&#34;p&#34;}_(.25){\scriptstyle \epsilon}&#34;p&#34;};&#xA;   % &#34;MbI1&#34;!L;&#34;MbIn&#34;!L**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{\ar@{&lt;.}@`{c+/l+2pc/,&#34;p&#34;}^(.25){\scriptstyle \epsilon}&#34;p&#34;};&#xA;   % \end{xy} \qquad \begin{xy}p+/r+1cm/:p+/u+1cm/::&#xA;   % (+2.5,0)*++&lt;3pt&gt;[F-:&lt;10pt&gt;][=stateNew]{}=&#34;p&#34;;&#xA;   % % -----------------------------------------------------------&#xA;   % (-1,+.75)*++&lt;3pt&gt;[F-:&lt;10pt&gt;:Gray][=stateOld]{}=&#34;MaI1&#34;;&#xA;   % (-1,-.75)*[stateOld]{}=&#34;MaIn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}}&#xA;   % ?(.5)=&#34;MaL&#34;*[gray]!L{\small I_a};&#34;MaL&#34;.&#xA;   % &#34;MaIn&#34;.&#34;MaI1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MaI&#34;;&#xA;   % (+1,+.75)*++&lt;3pt&gt;[F=:&lt;10pt&gt;:Gray][=stateOldFin]{}=&#34;MaF1&#34;;&#xA;   % (+1,-.75)*[stateOldFin]{}=&#34;MaFn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}},&#xA;   % ,?(.5)=&#34;MaR&#34;*[gray]!R{\small F_a};&#34;MaR&#34;.&#xA;   % &#34;MaFn&#34;.&#34;MaF1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MaF&#34;;&#xA;   % &#34;MaL&#34;;&#34;MaR&#34;**@{}?(.5)*[gray]{\small M_a}.&#xA;   % &#34;MaF&#34;.&#34;MaI&#34;*+&lt;4pt&gt;[F-:&lt;5pt&gt;]\frm{}=&#34;Ma&#34;;&#xA;   % % -----------------------------------------------------------&#xA;   % (5,0);p+/r+1cm/:&#xA;   % (-1,+.75)*[stateOld]{}=&#34;MbI1&#34;;&#xA;   % (-1,-.75)*[stateOld]{}=&#34;MbIn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}}&#xA;   % ?(.5)=&#34;MbL&#34;*[gray]!L{\small I_b};&#34;MbL&#34;.&#xA;   % &#34;MbIn&#34;.&#34;MbI1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MbI&#34;;&#xA;   % (+1,+.75)*[stateOldFin]{}=&#34;MbF1&#34;;&#xA;   % (+1,-.75)*[stateOldFin]{}=&#34;MbFn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}},&#xA;   % ,?(.5)=&#34;MbR&#34;*[gray]!R{\small F_b};&#34;MbR&#34;.&#xA;   % &#34;MbFn&#34;.&#34;MbF1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MbF&#34;;&#xA;   % &#34;MbL&#34;;&#34;MbR&#34;**@{}?(.5)*[gray]{\small M_b}.&#xA;   % &#34;MbF&#34;.&#34;MbI&#34;*+&lt;4pt&gt;[F-:&lt;5pt&gt;]\frm{}=&#34;Mb&#34;;&#xA;   % % -----------------------------------------------------------&#xA;   % &#34;MaI1&#34;!L;&#34;MaIn&#34;!L**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{\ar@[gray]@{-&gt;}@`{c+/l+1.5pc/,c}c};&#xA;   % % -----------------------------------------------------------&#xA;   % &#34;MaF1&#34;!R;&#34;MaFn&#34;!R**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{\ar@{.&gt;}@`{c+/r+1pc/,&#34;p&#34;}^(.25){\scriptstyle \epsilon}&#34;p&#34;};&#xA;   % &#34;MbI1&#34;!L;&#34;MbIn&#34;!L**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{\ar@{&lt;.}@`{c+/l+1pc/,&#34;p&#34;}^(.25){\scriptstyle \epsilon}&#34;p&#34;};&#xA;   % % Fig 2 : ---------------------------------------------------&#xA;   % 0;p+/r+1cm/:(0,-2.75);&#xA;   % p+/r+1cm/:p+/u+1cm/::&#xA;   % (0,-2)*++&lt;3pt&gt;[F=:&lt;10pt&gt;][=stateNewFin]{}=&#34;p&#34;,&#xA;   % {\ar@[gray]@{-&gt;}@`{&#34;p&#34;+/d+3pc/,&#34;p&#34;}&#34;p&#34;};&#xA;   % % -----------------------------------------------------------&#xA;   % (-1,+.75)*++&lt;3pt&gt;[F-:&lt;10pt&gt;:Gray][=stateOld]{}=&#34;MaI1&#34;;&#xA;   % (-1,-.75)*[stateOld]{}=&#34;MaIn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}}&#xA;   % ?(.5)=&#34;MaL&#34;*[gray]!L{\small I_a};&#34;MaL&#34;.&#xA;   % &#34;MaIn&#34;.&#34;MaI1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MaI&#34;;&#xA;   % (+1,+.75)*++&lt;3pt&gt;[F=:&lt;10pt&gt;:Gray][=stateOldFin]{}=&#34;MaF1&#34;;&#xA;   % (+1,-.75)*[stateOldFin]{}=&#34;MaFn&#34;**@{}&#xA;   % @={?(.35),?(.5),?(.65)} @@{*{\cdot}},&#xA;   % ,?(.5)=&#34;MaR&#34;*[gray]!R{\small F_a};&#34;MaR&#34;.&#xA;   % &#34;MaFn&#34;.&#34;MaF1&#34;*+&lt;8pt,5pt&gt;[F:&lt;3pt&gt;]\frm{}=&#34;MaF&#34;;&#xA;   % &#34;MaL&#34;;&#34;MaR&#34;**@{}?(.5)*[gray]{\small M_a}.&#xA;   % &#34;MaF&#34;.&#34;MaI&#34;*+&lt;4pt&gt;[F-:&lt;5pt&gt;]\frm{}=&#34;Ma&#34;;&#xA;   % % -----------------------------------------------------------&#xA;   % &#34;MaF1&#34;!R;&#34;MaFn&#34;!R**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{&#xA;   % \PATH ~={**@{.}}~&lt;{^&gt;&gt;*{\scriptstyle \epsilon}}~&gt;{|&gt;*\dir{&gt;}}&#xA;   % `r/5pt c+/r1.5pc/`d/5pt &#34;p&#34; &#34;p&#34;&#xA;   % };&#xA;   % &#34;MaI1&#34;!L;&#34;MaIn&#34;!L**@{}&#xA;   % @={?(0),?(.25),?(.5),?(.75),?(1)} &#xA;   % @@{&#xA;   % \PATH ~={**@{.}}~&lt;{|&lt;*\dir{&lt;}_&gt;&gt;*{\scriptstyle \epsilon}}&#xA;   % `l^/5pt c+/l1.5pc/`d/5pt &#34;p&#34; &#34;p&#34;&#xA;   % };&#xA;   % \end{xy}&#xA;   % \end{array}&#xA;   $&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;短代码-svg-file-配置&#34;&gt;&lt;span&gt;短代码 &lt;code&gt;svg-file&lt;/code&gt; 配置&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e7%9f%ad%e4%bb%a3%e7%a0%81-svg-file-%e9%85%8d%e7%bd%ae&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;该文件便于在博文中插入 &lt;code&gt;.svg&lt;/code&gt; 文件 。与普通插入图片的方式有所不同的是 : 该方法可允许 &lt;code&gt;.svg&lt;/code&gt; 文件在黑暗模式下正常显示 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;配置流程-1&#34;&gt;&lt;span&gt;配置流程&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e9%85%8d%e7%bd%ae%e6%b5%81%e7%a8%8b-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;创建文件 &lt;code&gt;./layouts/shortcodes/svg-file.html&lt;/code&gt; 并将下述内容粘贴进文件中即可 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; title=&#34;svg-file.html&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ $svg := .Get &amp;#34;src&amp;#34; }}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ $svgPath := path.Join &amp;#34;static&amp;#34; $svg }}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ if fileExists $svgPath }}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;svg-container&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    {{ readFile $svgPath | safeHTML }}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;svg-container&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;display&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;inline-block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;width&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;max-width&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{{&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Get&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;max-width&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;height&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;overflow-x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;overflow-y&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;hidden&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;svg-container&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;svg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;width&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;height&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;err&#34;&gt;{{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;.Get&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;fill&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;fill&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;.Get&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;stroke&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;stroke&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ else }}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  {{ errorf &amp;#34;SVG file not found: %s&amp;#34; $svgPath }}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ end }}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;测试结果-1&#34;&gt;&lt;span&gt;测试结果&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e6%b5%8b%e8%af%95%e7%bb%93%e6%9e%9c-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;  &lt;div class=&#34;svg-container&#34;&gt;&#xD;&#xA;    &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;no&#34;?&gt;&#xA;&lt;svg&#xA;   style=&#34;vertical-align: -13.186ex;&#34;&#xA;   width=&#34;90.34ex&#34;&#xA;   height=&#34;16.424ex&#34;&#xA;   role=&#34;img&#34;&#xA;   focusable=&#34;false&#34;&#xA;   viewBox=&#34;0 -1431.4 39930.3 7259.5&#34;&#xA;   aria-hidden=&#34;true&#34;&#xA;   version=&#34;1.1&#34;&#xA;   id=&#34;svg1307&#34;&#xA;   sodipodi:docname=&#34;Xer2.11.svg&#34;&#xA;   inkscape:version=&#34;1.1.1 (3bf5ae0d25, 2021-09-20)&#34;&#xA;   xmlns:inkscape=&#34;http://www.inkscape.org/namespaces/inkscape&#34;&#xA;   xmlns:sodipodi=&#34;http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd&#34;&#xA;   xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34;&#xA;   xmlns=&#34;http://www.w3.org/2000/svg&#34;&#xA;   xmlns:svg=&#34;http://www.w3.org/2000/svg&#34;&gt;&#xA;  &lt;sodipodi:namedview&#xA;     id=&#34;namedview1309&#34;&#xA;     pagecolor=&#34;#ffffff&#34;&#xA;     bordercolor=&#34;#666666&#34;&#xA;     borderopacity=&#34;1.0&#34;&#xA;     inkscape:pageshadow=&#34;2&#34;&#xA;     inkscape:pageopacity=&#34;0.0&#34;&#xA;     inkscape:pagecheckerboard=&#34;0&#34;&#xA;     showgrid=&#34;false&#34;&#xA;     inkscape:zoom=&#34;0.032882297&#34;&#xA;     inkscape:cx=&#34;19965.15&#34;&#xA;     inkscape:cy=&#34;3634.1743&#34;&#xA;     inkscape:window-width=&#34;1920&#34;&#xA;     inkscape:window-height=&#34;992&#34;&#xA;     inkscape:window-x=&#34;-8&#34;&#xA;     inkscape:window-y=&#34;-8&#34;&#xA;     inkscape:window-maximized=&#34;1&#34;&#xA;     inkscape:current-layer=&#34;svg1307&#34; /&gt;&#xA;  &lt;defs&#xA;     id=&#34;defs853&#34;&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-62&#34;&#xA;       d=&#34;M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-61&#34;&#xA;       d=&#34;M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-63&#34;&#xA;       d=&#34;M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-6B&#34;&#xA;       d=&#34;M36 46H50Q89 46 97 60V68Q97 77 97 91T97 124T98 167T98 217T98 272T98 329Q98 366 98 407T98 482T98 542T97 586T97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V463L180 233L240 287Q300 341 304 347Q310 356 310 364Q310 383 289 385H284V431H293Q308 428 412 428Q475 428 484 431H489V385H476Q407 380 360 341Q286 278 286 274Q286 273 349 181T420 79Q434 60 451 53T500 46H511V0H505Q496 3 418 3Q322 3 307 0H299V46H306Q330 48 330 65Q330 72 326 79Q323 84 276 153T228 222L176 176V120V84Q176 65 178 59T189 49Q210 46 238 46H254V0H246Q231 3 137 3T28 0H20V46H36Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-6F&#34;&#xA;       d=&#34;M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-6E&#34;&#xA;       d=&#34;M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-65&#34;&#xA;       d=&#34;M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-72&#34;&#xA;       d=&#34;M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-73&#34;&#xA;       d=&#34;M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-74&#34;&#xA;       d=&#34;M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-20&#34;&#xA;       d=&#34;&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-66&#34;&#xA;       d=&#34;M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-N-76&#34;&#xA;       d=&#34;M338 431Q344 429 422 429Q479 429 503 431H508V385H497Q439 381 423 345Q421 341 356 172T288 -2Q283 -11 263 -11Q244 -11 239 -2Q99 359 98 364Q93 378 82 381T43 385H19V431H25L33 430Q41 430 53 430T79 430T104 429T122 428Q217 428 232 431H240V385H226Q187 384 184 370Q184 366 235 234L286 102L377 341V349Q377 363 367 372T349 383T335 385H331V431H338Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-28&#34;&#xA;       d=&#34;M437 -53Q437 -82 399 -82H394Q377 -82 342 -55Q259 7 213 102T166 306Q166 412 211 507T342 667Q377 694 393 694H399Q437 694 437 665Q437 654 426 643T397 620T356 584T311 525Q301 511 290 488T264 412T250 306Q250 191 300 105T422 -27Q437 -37 437 -53Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D68A&#34;&#xA;       d=&#34;M126 306Q105 306 90 321T74 359Q74 439 211 439Q268 439 276 438Q343 426 383 390T430 306Q431 301 431 190V81Q446 79 465 78T492 76T509 72T521 60T524 38Q524 11 506 3Q502 1 466 1Q426 1 406 5T379 14T355 36L345 30Q284 -6 205 -6Q135 -6 92 39T48 141Q48 182 79 212T158 256T252 278T342 285H347V290Q347 315 325 335T267 362Q258 363 224 363Q189 363 185 362H179L178 358Q178 353 178 352T176 345T174 337T170 330T165 322T158 316T150 311T139 308T126 306ZM132 140Q132 115 157 93T224 70Q269 70 302 87T344 133Q346 139 347 175V211H339Q256 209 194 190T132 140Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-20&#34;&#xA;       d=&#34;&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D68B&#34;&#xA;       d=&#34;M4 573Q4 596 15 603T52 611H90H124Q146 611 155 608T171 591Q173 586 173 491V396L182 402Q217 424 256 431Q280 437 309 437Q376 437 434 379T492 217Q492 162 473 118T422 47T358 8T293 -6Q229 -6 174 38Q171 13 163 7T135 1H131H122Q99 1 90 23L89 279V535H58L27 536Q4 543 4 573ZM409 215Q409 269 377 315T283 361Q255 361 224 344T177 297L173 290V167Q189 124 213 97T278 70Q330 70 369 111T409 215Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D68C&#34;&#xA;       d=&#34;M291 -6Q196 -6 131 60T66 216Q66 296 119 361Q154 403 200 421T273 439Q275 440 293 440H313Q400 440 433 409Q454 388 454 359Q454 335 439 321T402 306Q380 306 365 321T350 357V362L340 363Q339 363 326 363T303 364Q280 364 266 362Q217 352 184 313T151 215Q151 153 199 112T313 70Q341 70 357 85T381 118T394 140Q402 146 424 146Q443 146 447 144Q466 137 466 117Q466 106 457 88T429 47T374 10T291 -6Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-29&#34;&#xA;       d=&#34;M87 664Q87 694 126 694Q138 694 147 690T183 667Q266 605 312 510T358 306Q358 193 307 93T161 -70Q142 -82 126 -82Q105 -82 96 -73T87 -53Q87 -47 88 -44Q92 -36 116 -19T173 34T230 119Q273 206 273 306Q273 408 231 494T109 635Q87 649 87 664Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7F7&#34;&#xA;       d=&#34;M99 461Q99 470 99 474T104 487T120 498T151 502Q213 517 251 596Q264 622 283 622Q308 622 319 597V76H373H401Q428 76 439 69T450 38Q450 11 428 1H127Q104 10 104 38Q104 62 115 69T153 76H181H235V269Q235 461 234 461Q184 426 137 424H133Q124 424 119 425T109 431T99 447V461Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7F8&#34;&#xA;       d=&#34;M52 462Q52 528 110 575T247 622H250Q343 622 407 565T472 421Q472 371 446 324T390 248T308 178Q307 177 275 151T214 101L185 77Q185 76 286 76H388V87Q388 105 397 114T430 123T463 114Q470 107 471 100T472 61V42Q472 24 468 16T450 1H75Q53 10 53 32V38V48Q53 57 63 67T127 122Q153 144 169 157L289 256Q388 345 388 419Q388 473 346 509T231 545H224Q176 545 146 499L144 494Q155 476 155 459Q154 459 155 455T154 444T148 430T136 417T114 408Q113 408 110 408T104 407Q80 407 66 422T52 462Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7F9&#34;&#xA;       d=&#34;M260 546Q233 546 211 541T180 531T171 524L174 514Q177 505 177 497Q177 476 162 461T125 446Q106 446 90 459T73 504Q76 540 98 565T150 601T203 616T239 621Q241 622 265 622Q322 620 362 602T420 558T444 513T451 478Q451 386 369 329L375 326Q381 323 386 320T401 311T419 298T436 283T452 263T466 240T475 212T479 180Q479 99 416 44T259 -11T105 28T44 130Q44 154 59 168T95 183Q117 183 132 169T148 131Q148 119 139 101Q175 65 260 65Q316 65 355 97T395 179Q395 211 375 240Q336 292 253 292H234H215Q194 292 185 299T175 330Q175 350 184 359Q192 368 238 370T309 384Q336 398 351 423T367 474Q367 496 350 513Q321 546 260 546Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D6A1&#34;&#xA;       d=&#34;M35 393Q35 417 46 424T89 432Q95 432 112 432T141 431H223Q238 422 241 415T244 393Q244 389 244 383T237 367T216 355Q209 355 209 354L234 319Q259 286 260 286L308 354Q308 355 301 355Q285 356 278 365T270 384L271 393Q271 420 289 428Q295 431 376 431H459Q460 430 465 427T472 422T476 416T480 407T481 393Q481 368 470 362T434 355H425H392L344 290Q295 225 295 223Q294 223 309 203T350 149L405 77L439 76H453Q474 76 484 69T495 38Q495 10 473 1H303Q281 9 281 32V38Q281 49 282 54T290 67T313 76Q324 76 324 77L259 173L197 77Q202 76 209 76Q225 75 233 68T241 55T242 38Q242 28 242 24T236 12T221 1H51Q29 9 29 32V38Q29 48 29 51T31 59T38 67T51 76H117L171 149Q224 222 224 223L124 355H90H78Q54 355 45 361T35 393Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D6A3&#34;&#xA;       d=&#34;M56 1Q40 7 37 14T34 41Q34 59 36 64Q39 67 43 73Q65 95 191 213T341 355H133V334Q133 306 124 297Q116 289 91 289H83Q60 289 51 308Q49 313 49 361L50 409Q59 427 72 430H78Q83 430 92 430T115 430T144 430T179 431T219 431T262 431H450Q452 430 455 428T459 424T463 422T466 419T468 416T469 413T470 409T471 404T472 398T472 391Q472 374 469 368L462 358Q453 349 315 218Q210 122 164 76H391V103Q391 136 400 146Q409 155 433 155Q464 155 473 135Q475 130 475 78V46Q475 24 472 16T453 1H56Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7FC&#34;&#xA;       d=&#34;M357 536Q357 546 318 546Q258 546 205 497T133 357V353L144 361Q210 402 285 402Q362 402 414 350Q479 285 479 193Q479 111 418 50T263 -11Q234 -11 207 -3T149 26T97 81T60 171T45 301Q45 444 129 533T319 622Q388 622 421 589T454 510Q454 491 442 475T402 458Q373 458 362 475T350 510Q350 520 354 528L357 536ZM319 326T269 326T179 298T136 223Q136 202 143 174T176 112T237 68Q246 66 265 66Q319 66 360 107Q395 146 395 197Q395 250 356 289Q319 326 269 326Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7FD&#34;&#xA;       d=&#34;M204 -10Q162 -10 162 40Q162 146 198 261T310 477Q311 478 321 491T342 517T358 535H128V524Q128 506 119 497Q111 489 86 489H78Q55 489 46 508Q44 513 44 557V580Q44 605 52 616T88 627H93Q114 627 125 611H458Q474 598 477 593T480 573Q480 559 478 553T469 543T446 521T408 477Q252 290 246 49Q246 43 246 37T246 27T245 22Q243 11 233 1T204 -10Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D6A2&#34;&#xA;       d=&#34;M26 393Q26 417 37 424T80 431H134H217Q232 422 235 416T239 393Q239 379 236 371T226 360T214 356T197 355L179 354V353L188 330Q197 306 209 272T235 201T259 133T271 89V84L274 95Q279 122 298 185T335 300T352 354Q352 355 331 355Q312 355 304 358Q288 368 288 393Q288 408 291 415T310 431H478Q479 430 484 427T491 422T495 416T499 407T500 393Q500 376 493 367T479 357T458 355H452Q426 355 425 353Q420 337 351 124T280 -94Q240 -195 168 -220Q147 -228 125 -228Q89 -228 66 -201T42 -139Q42 -116 56 -102T93 -87Q117 -87 130 -102T144 -135V-138H126Q121 -148 121 -150T130 -152Q182 -147 207 -87Q211 -78 223 -40T236 1Q230 10 102 355H75L49 356Q26 363 26 393Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7FE&#34;&#xA;       d=&#34;M58 460Q58 523 117 572T254 621Q290 621 298 620Q376 607 421 560T466 460Q466 441 460 424T443 393T421 370T397 352T374 340T357 332L350 330L356 328Q363 325 371 321T392 310T415 295T439 274T459 249T473 217T479 179Q479 102 418 46T262 -10T106 46T45 179Q45 202 52 222T70 257T96 284T123 305T148 319T167 328L174 330L170 332Q166 333 159 336T145 343Q104 362 81 393T58 460ZM382 458Q382 491 349 518T263 546Q215 546 179 521T142 458Q142 421 178 395T262 368Q315 368 348 396T382 458ZM396 178Q396 223 358 257T263 292Q206 292 167 258T128 178Q128 137 163 102T262 66Q324 66 360 101T396 178Z&#34; /&gt;&#xA;    &lt;path&#xA;       id=&#34;MJX-68-TEX-M-1D7FF&#34;&#xA;       d=&#34;M392 259Q333 210 236 210H233Q163 210 109 262Q46 325 46 411T99 550Q164 622 264 622Q293 622 319 615T376 587T428 532T464 440T479 304Q479 167 400 78T217 -11Q140 -11 105 22T70 101Q70 124 84 138T122 153Q150 153 162 137T174 101Q174 91 168 76Q179 65 216 65Q267 65 300 93Q322 109 339 130T366 173T380 210T388 242T392 259ZM388 389Q388 438 357 492T268 546T185 520Q129 479 129 415Q129 384 138 363Q145 349 156 334T195 302T255 285Q305 285 345 313T388 389Z&#34; /&gt;&#xA;  &lt;/defs&gt;&#xA;  &lt;g&#xA;     data-mml-node=&#34;math&#34;&#xA;     id=&#34;g1303&#34;&#xA;     transform=&#34;matrix(1,0,0,-1,-2568.9982,0)&#34;&#xA;     style=&#34;fill:#000000;stroke:#000000;stroke-width:0&#34;&gt;&#xA;    &lt;g&#xA;       data-mml-node=&#34;mstyle&#34;&#xA;       id=&#34;g857&#34;&gt;&#xA;      &lt;g&#xA;         data-mml-node=&#34;mspace&#34;&#xA;         id=&#34;g855&#34; /&gt;&#xA;    &lt;/g&gt;&#xA;    &lt;g&#xA;       data-mml-node=&#34;mstyle&#34;&#xA;       transform=&#34;translate(2000)&#34;&#xA;       id=&#34;g861&#34;&gt;&#xA;      &lt;g&#xA;         data-mml-node=&#34;mspace&#34;&#xA;         id=&#34;g859&#34; /&gt;&#xA;    &lt;/g&gt;&#xA;    &lt;g&#xA;       data-mml-node=&#34;xypic&#34;&#xA;       data-cmd-id=&#34;0&#34;&#xA;       data-text-mml-ids=&#34;[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]&#34;&#xA;       transform=&#34;translate(4000)&#34;&#xA;       id=&#34;g1301&#34;&gt;&#xA;      &lt;g&#xA;         fill=&#34;none&#34;&#xA;         stroke=&#34;currentColor&#34;&#xA;         stroke-linecap=&#34;round&#34;&#xA;         stroke-width=&#34;0.64&#34;&#xA;         transform=&#34;matrix(62.5,0,0,-62.5,4101.5,250)&#34;&#xA;         id=&#34;g987&#34;&gt;&#xA;        &lt;rect&#xA;           x=&#34;-8&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect863&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;8&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect865&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;162.88&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect867&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;178.88&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect869&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;16&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;162.88&#34;&#xA;           y2=&#34;0&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line871&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(162.88)&#34;&#xA;           id=&#34;g877&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path873&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path875&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(0,-10.25)&#34;&#xA;           id=&#34;g879&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;333.76001&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect881&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;349.76001&#34;&#xA;           y=&#34;-8&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect883&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;186.88&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;333.76001&#34;&#xA;           y2=&#34;0&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line885&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(333.76)&#34;&#xA;           id=&#34;g891&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path887&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path889&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(0,-10.25)&#34;&#xA;           id=&#34;g893&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;357.76001&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;450.72&#34;&#xA;           y2=&#34;0&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line895&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;translate(450.72)&#34;&#xA;           id=&#34;g901&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path897&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path899&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;rect&#xA;           x=&#34;-8&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect903&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;8&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect905&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;0&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;0&#34;&#xA;           y2=&#34;38.400002&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line907&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(90,-19.2,19.2)&#34;&#xA;           id=&#34;g913&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path909&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path911&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;0&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;-32.720001&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line915&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(135,-32.809928,32.809827)&#34;&#xA;           id=&#34;g921&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path917&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path919&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;16&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;48.720001&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line923&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(45,-71.209928,98.523882)&#34;&#xA;           id=&#34;g929&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path925&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path927&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;rect&#xA;           x=&#34;162.88&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect931&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;178.88&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect933&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;170.88&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;170.88&#34;&#xA;           y2=&#34;38.400002&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line935&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(90,66.24,104.64)&#34;&#xA;           id=&#34;g941&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path937&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path939&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;170.88&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;138.16&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line943&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(135,52.630072,68.200233)&#34;&#xA;           id=&#34;g949&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path945&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path947&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;186.88&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;219.60001&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line951&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(45,14.230072,304.79429)&#34;&#xA;           id=&#34;g957&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path953&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path955&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;rect&#xA;           x=&#34;333.76001&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect959&#34; /&gt;&#xA;        &lt;rect&#xA;           x=&#34;349.76001&#34;&#xA;           y=&#34;38.400002&#34;&#xA;           width=&#34;16&#34;&#xA;           height=&#34;16&#34;&#xA;           rx=&#34;0&#34;&#xA;           stroke=&#34;currentColor&#34;&#xA;           id=&#34;rect961&#34; /&gt;&#xA;        &lt;line&#xA;           x1=&#34;341.76001&#34;&#xA;           y1=&#34;0&#34;&#xA;           x2=&#34;341.76001&#34;&#xA;           y2=&#34;38.400002&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line963&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(90,151.68,190.08)&#34;&#xA;           id=&#34;g969&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path965&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path967&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;341.76001&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;309.87&#34;&#xA;           y2=&#34;78.290001&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line971&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(135,138.07007,103.59064)&#34;&#xA;           id=&#34;g977&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path973&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path975&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;        &lt;line&#xA;           x1=&#34;357.76001&#34;&#xA;           y1=&#34;46.400002&#34;&#xA;           x2=&#34;390.48001&#34;&#xA;           y2=&#34;79.120003&#34;&#xA;           stroke-dasharray=&#34;none&#34;&#xA;           id=&#34;line979&#34; /&gt;&#xA;        &lt;g&#xA;           transform=&#34;rotate(45,99.670072,511.0647)&#34;&#xA;           id=&#34;g985&#34;&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,0.32 -7.82,2.35&#34;&#xA;             id=&#34;path981&#34; /&gt;&#xA;          &lt;path&#xA;             d=&#34;M 0,0 Q -3.55,-0.32 -7.82,-2.35&#34;&#xA;             id=&#34;path983&#34; /&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;0&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;0&#34;&#xA;         transform=&#34;translate(4101.5,250)&#34;&#xA;         id=&#34;g997&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g995&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g993&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g991&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g989&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;1&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;1&#34;&#xA;         transform=&#34;translate(5101.5,250)&#34;&#xA;         id=&#34;g1007&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1005&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1003&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1001&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g999&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;10.68&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;2&#34;&#xA;         transform=&#34;translate(14781.5,250)&#34;&#xA;         id=&#34;g1017&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1015&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1013&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1011&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1009&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;11.68&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;3&#34;&#xA;         transform=&#34;translate(15781.5,250)&#34;&#xA;         id=&#34;g1027&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1025&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1023&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1021&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1019&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;4.396087952817069&#34;&#xA;         data-y=&#34;-0.39919953083036164&#34;&#xA;         data-xypic-id=&#34;4&#34;&#xA;         transform=&#34;translate(8497.5,649.2)&#34;&#xA;         id=&#34;g1049&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1047&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1045&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;62&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-62&#34;&#xA;               id=&#34;use1029&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;61&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-61&#34;&#xA;               transform=&#34;translate(556)&#34;&#xA;               id=&#34;use1031&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;63&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-63&#34;&#xA;               transform=&#34;translate(1056)&#34;&#xA;               id=&#34;use1033&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6B&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6B&#34;&#xA;               transform=&#34;translate(1500)&#34;&#xA;               id=&#34;use1035&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;62&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-62&#34;&#xA;               transform=&#34;translate(2028)&#34;&#xA;               id=&#34;use1037&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6F&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6F&#34;&#xA;               transform=&#34;translate(2584)&#34;&#xA;               id=&#34;use1039&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6E&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6E&#34;&#xA;               transform=&#34;translate(3084)&#34;&#xA;               id=&#34;use1041&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;65&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-65&#34;&#xA;               transform=&#34;translate(3640)&#34;&#xA;               id=&#34;use1043&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;21.36&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;5&#34;&#xA;         transform=&#34;translate(25461.5,250)&#34;&#xA;         id=&#34;g1059&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1057&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1055&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1053&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1051&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;22.36&#34;&#xA;         data-y=&#34;0&#34;&#xA;         data-xypic-id=&#34;6&#34;&#xA;         transform=&#34;translate(26461.5,250)&#34;&#xA;         id=&#34;g1069&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1067&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1065&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1063&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1061&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;15.076087952817069&#34;&#xA;         data-y=&#34;-0.39919953083036164&#34;&#xA;         data-xypic-id=&#34;7&#34;&#xA;         transform=&#34;translate(19177.5,649.2)&#34;&#xA;         id=&#34;g1091&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1089&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1087&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;62&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-62&#34;&#xA;               id=&#34;use1071&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;61&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-61&#34;&#xA;               transform=&#34;translate(556)&#34;&#xA;               id=&#34;use1073&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;63&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-63&#34;&#xA;               transform=&#34;translate(1056)&#34;&#xA;               id=&#34;use1075&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6B&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6B&#34;&#xA;               transform=&#34;translate(1500)&#34;&#xA;               id=&#34;use1077&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;62&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-62&#34;&#xA;               transform=&#34;translate(2028)&#34;&#xA;               id=&#34;use1079&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6F&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6F&#34;&#xA;               transform=&#34;translate(2584)&#34;&#xA;               id=&#34;use1081&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;6E&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-6E&#34;&#xA;               transform=&#34;translate(3084)&#34;&#xA;               id=&#34;use1083&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;65&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-N-65&#34;&#xA;               transform=&#34;translate(3640)&#34;&#xA;               id=&#34;use1085&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;28.33862675168815&#34;&#xA;         data-y=&#34;0.24536605307173198&#34;&#xA;         data-xypic-id=&#34;8&#34;&#xA;         transform=&#34;translate(32440.1,4.6)&#34;&#xA;         id=&#34;g1121&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1119&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1117&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mtext&#34;&#xA;               id=&#34;g1115&#34;&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;72&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-72&#34;&#xA;                 id=&#34;use1093&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;65&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-65&#34;&#xA;                 transform=&#34;translate(392)&#34;&#xA;                 id=&#34;use1095&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;73&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-73&#34;&#xA;                 transform=&#34;translate(836)&#34;&#xA;                 id=&#34;use1097&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;74&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-74&#34;&#xA;                 transform=&#34;translate(1230)&#34;&#xA;                 id=&#34;use1099&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;20&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-20&#34;&#xA;                 transform=&#34;translate(1619)&#34;&#xA;                 id=&#34;use1101&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;6F&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-6F&#34;&#xA;                 transform=&#34;translate(1869)&#34;&#xA;                 id=&#34;use1103&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;66&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-66&#34;&#xA;                 transform=&#34;translate(2369)&#34;&#xA;                 id=&#34;use1105&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;20&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-20&#34;&#xA;                 transform=&#34;translate(2675)&#34;&#xA;                 id=&#34;use1107&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;65&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-65&#34;&#xA;                 transform=&#34;translate(2925)&#34;&#xA;                 id=&#34;use1109&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;6E&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-6E&#34;&#xA;                 transform=&#34;translate(3369)&#34;&#xA;                 id=&#34;use1111&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;              &lt;use&#xA;                 data-c=&#34;76&#34;&#xA;                 xlink:href=&#34;#MJX-68-TEX-N-76&#34;&#xA;                 transform=&#34;translate(3925)&#34;&#xA;                 id=&#34;use1113&#34;&#xA;                 x=&#34;0&#34;&#xA;                 y=&#34;0&#34;&#xA;                 width=&#34;100%&#34;&#xA;                 height=&#34;100%&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;1.6653345369377348e-16&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;9&#34;&#xA;         transform=&#34;translate(4101.5,-2650)&#34;&#xA;         id=&#34;g1131&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1129&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1127&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1125&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1123&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;1.0000000000000002&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;10&#34;&#xA;         transform=&#34;translate(5101.5,-2650)&#34;&#xA;         id=&#34;g1141&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1139&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1137&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1135&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1133&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;-3.7600403089594656&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;11&#34;&#xA;         transform=&#34;translate(341.4,-5327.1)&#34;&#xA;         id=&#34;g1161&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1159&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1157&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1143&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D68A&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D68A&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1145&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1147&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D68B&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D68B&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1149&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1151&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D68C&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D68C&#34;&#xA;               transform=&#34;translate(2625)&#34;&#xA;               id=&#34;use1153&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(3150)&#34;&#xA;               id=&#34;use1155&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;1.6045762979144977&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;12&#34;&#xA;         transform=&#34;translate(5706,-5327.1)&#34;&#xA;         id=&#34;g1187&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1185&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1183&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1163&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F7&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F7&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1165&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F7&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F7&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1167&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1169&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F7&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F7&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1171&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F8&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F8&#34;&#xA;               transform=&#34;translate(2625)&#34;&#xA;               id=&#34;use1173&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(3150)&#34;&#xA;               id=&#34;use1175&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F7&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F7&#34;&#xA;               transform=&#34;translate(3675)&#34;&#xA;               id=&#34;use1177&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7F9&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7F9&#34;&#xA;               transform=&#34;translate(4200)&#34;&#xA;               id=&#34;use1179&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(4725)&#34;&#xA;               id=&#34;use1181&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;10.68&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;13&#34;&#xA;         transform=&#34;translate(14781.5,-2650)&#34;&#xA;         id=&#34;g1197&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1195&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1193&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1191&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1189&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;11.68&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;14&#34;&#xA;         transform=&#34;translate(15781.5,-2650)&#34;&#xA;         id=&#34;g1207&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1205&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1203&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1201&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1199&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;7.291190751163471&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;15&#34;&#xA;         transform=&#34;translate(11392.7,-5327.1)&#34;&#xA;         id=&#34;g1223&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1221&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1219&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1209&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D6A1&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D6A1&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1211&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1213&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D6A3&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D6A3&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1215&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1217&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;12.841422888098903&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;16&#34;&#xA;         transform=&#34;translate(16942.9,-5327.1)&#34;&#xA;         id=&#34;g1243&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1241&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1239&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1225&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FC&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FC&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1227&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FC&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FC&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1229&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1231&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FD&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FD&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1233&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FD&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FD&#34;&#xA;               transform=&#34;translate(2625)&#34;&#xA;               id=&#34;use1235&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(3150)&#34;&#xA;               id=&#34;use1237&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;21.36&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;17&#34;&#xA;         transform=&#34;translate(25461.5,-2650)&#34;&#xA;         id=&#34;g1253&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1251&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1249&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1247&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1245&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;22.36&#34;&#xA;         data-y=&#34;2.9&#34;&#xA;         data-xypic-id=&#34;18&#34;&#xA;         transform=&#34;translate(26461.5,-2650)&#34;&#xA;         id=&#34;g1263&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           id=&#34;g1261&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;TeXAtom&#34;&#xA;             data-mjx-texclass=&#34;ORD&#34;&#xA;             id=&#34;g1259&#34;&gt;&#xA;            &lt;g&#xA;               data-mml-node=&#34;mstyle&#34;&#xA;               id=&#34;g1257&#34;&gt;&#xA;              &lt;g&#xA;                 data-mml-node=&#34;TeXAtom&#34;&#xA;                 data-mjx-texclass=&#34;ORD&#34;&#xA;                 id=&#34;g1255&#34; /&gt;&#xA;            &lt;/g&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;17.97119075116347&#34;&#xA;         data-y=&#34;5.52548747854565&#34;&#xA;         data-xypic-id=&#34;19&#34;&#xA;         transform=&#34;translate(22072.7,-5275.5)&#34;&#xA;         id=&#34;g1279&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1277&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1275&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1265&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D6A1&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D6A1&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1267&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1269&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D6A2&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D6A2&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1271&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1273&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;      &lt;g&#xA;         stroke=&#34;currentColor&#34;&#xA;         fill=&#34;currentColor&#34;&#xA;         data-x=&#34;23.521422888098904&#34;&#xA;         data-y=&#34;5.5771062735722685&#34;&#xA;         data-xypic-id=&#34;20&#34;&#xA;         transform=&#34;translate(27622.9,-5327.1)&#34;&#xA;         id=&#34;g1299&#34;&gt;&#xA;        &lt;g&#xA;           data-mml-node=&#34;mstyle&#34;&#xA;           transform=&#34;scale(0.707)&#34;&#xA;           id=&#34;g1297&#34;&gt;&#xA;          &lt;g&#xA;             data-mml-node=&#34;mtext&#34;&#xA;             id=&#34;g1295&#34;&gt;&#xA;            &lt;use&#xA;               data-c=&#34;28&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-28&#34;&#xA;               id=&#34;use1281&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FE&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FE&#34;&#xA;               transform=&#34;translate(525)&#34;&#xA;               id=&#34;use1283&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FE&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FE&#34;&#xA;               transform=&#34;translate(1050)&#34;&#xA;               id=&#34;use1285&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;20&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-20&#34;&#xA;               transform=&#34;translate(1575)&#34;&#xA;               id=&#34;use1287&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FF&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FF&#34;&#xA;               transform=&#34;translate(2100)&#34;&#xA;               id=&#34;use1289&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;1D7FF&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-1D7FF&#34;&#xA;               transform=&#34;translate(2625)&#34;&#xA;               id=&#34;use1291&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;            &lt;use&#xA;               data-c=&#34;29&#34;&#xA;               xlink:href=&#34;#MJX-68-TEX-M-29&#34;&#xA;               transform=&#34;translate(3150)&#34;&#xA;               id=&#34;use1293&#34;&#xA;               x=&#34;0&#34;&#xA;               y=&#34;0&#34;&#xA;               width=&#34;100%&#34;&#xA;               height=&#34;100%&#34; /&gt;&#xA;          &lt;/g&gt;&#xA;        &lt;/g&gt;&#xA;      &lt;/g&gt;&#xA;    &lt;/g&gt;&#xA;  &lt;/g&gt;&#xA;&lt;/svg&gt;&#xA;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;  &lt;style&gt;&#xD;&#xA;    .svg-container {&#xD;&#xA;      display: inline-block;&#xD;&#xA;      width: 100%;&#xD;&#xA;      max-width: 100%;&#xD;&#xA;      height: auto;&#xD;&#xA;      overflow-x: auto;&#xD;&#xA;      overflow-y: hidden;&#xD;&#xA;    }&#xD;&#xA;    .svg-container svg {&#xD;&#xA;      width: auto;&#xD;&#xA;      height: auto;&#xD;&#xA;      &#xD;&#xA;      &#xD;&#xA;    }&#xD;&#xA;  &lt;/style&gt;&#xD;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;短代码-jsxgraph-配置&#34;&gt;&lt;span&gt;短代码 &lt;code&gt;jsxgraph&lt;/code&gt; 配置&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e7%9f%ad%e4%bb%a3%e7%a0%81-jsxgraph-%e9%85%8d%e7%bd%ae&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;一个类似 Geogebra 的小工具 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;配置流程-2&#34;&gt;&lt;span&gt;配置流程&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e9%85%8d%e7%bd%ae%e6%b5%81%e7%a8%8b-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;首先在 &lt;code&gt;./layouts/partials/assets.html&lt;/code&gt; 中加入下述代码 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- /* JSXGraph */ -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- if .Store.Get &amp;#34;hasJSXGraph&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;link&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;text/css&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  {{- $source := $cdn.jsxgraph | default &amp;#34;https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  {{- dict &amp;#34;Source&amp;#34; $source &amp;#34;Fingerprint&amp;#34; $fingerprint &amp;#34;Defer&amp;#34; true | dict &amp;#34;Scratch&amp;#34; .Scratch &amp;#34;Data&amp;#34; | partial &amp;#34;scratch/script.html&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- end -}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;然后创建 &lt;code&gt;./layouts/partials/shortcodes/jsxgraph.html&lt;/code&gt; 并将下述代码粘贴进文件中即可 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; title=&#34;jsxgraph.html&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $options := .Get &amp;#34;width&amp;#34; | default (.Get 0) | dict &amp;#34;width&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $options = .Get &amp;#34;height&amp;#34; | default (.Get 1) | dict &amp;#34;height&amp;#34; | merge $options -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $options = .Get &amp;#34;renderer&amp;#34; | default &amp;#34;svg&amp;#34; | dict &amp;#34;renderer&amp;#34; | merge $options -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- dict &amp;#34;Options&amp;#34; $options &amp;#34;Inner&amp;#34; .Inner | partial &amp;#34;plugin/jsxgraph.html&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- .Page.Store.Set &amp;#34;hasJSXGraph&amp;#34; true -}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;接着创建 &lt;code&gt;./layouts/partials/plugin/jsxgraph.html&lt;/code&gt; 并将下述代码粘贴进文件中即可 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; title=&#34;jsxgraph.html&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- /* JSXGraph support for code fences extended and shortcodes. */ -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $width := .Options.width | default &amp;#34;100%&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $height := .Options.height | default &amp;#34;20rem&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $id := printf &amp;#34;jsxgraph-%d&amp;#34; now.UnixNano -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $attrs := printf `id=&amp;#34;%s&amp;#34; style=&amp;#34;width: %v; height: %v; margin: 2rem 0; border: 1px solid; border-radius: 10px; overflow: hidden; page-break-inside: avoid; break-inside: avoid;&amp;#34;` $id $width $height -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;jsxgraph&amp;#34;&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;attrs&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;safeHTMLAttr&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;}}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;container&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ $id }}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;runUserScript&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// 替换掉 initBoard(...) 中写死的 ID，不管是 box / jxgbox / myboard&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;{{&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Inner&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;replaceRE&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;initBoard\\(\\s*[&amp;#39;\&amp;#34;][^&amp;#39;\&amp;#34;]+[&amp;#39;\&amp;#34;]&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;printf&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;initBoard(&amp;#39;%s&amp;#39;&amp;#34;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;$id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;safeJS&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;readyState&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;loading&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;addEventListener&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;DOMContentLoaded&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;runUserScript&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;runUserScript&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;})();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;最后创建 &lt;code&gt;./layouts/_default/_markup/render-codeblock-jsxgraph.html&lt;/code&gt; 并将下述代码粘贴进文件中即可 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; title=&#34;render-codeblock-jsxgraph.html&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- dict &amp;#34;Options&amp;#34; .Attributes &amp;#34;Inner&amp;#34; .Inner | partial &amp;#34;plugin/jsxgraph.html&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- .Page.Store.Set &amp;#34;hasJSXGraph&amp;#34; true -}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;测试结果-2&#34;&gt;&lt;span&gt;测试结果&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e6%b5%8b%e8%af%95%e7%bb%93%e6%9e%9c-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;提示&lt;/p&gt;&lt;p&gt;如果比例失调 , 可以考虑在 &lt;code&gt;JSXGraph.initBoard&lt;/code&gt; 中加入 &lt;code&gt;keepaspectration: true&lt;/code&gt; 。比如&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;board&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;JXG&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;JSXGraph&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;initBoard&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;jxgbox&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;boundingbox&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;keepaspectratio&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;fi-row&#34;&gt;&#xA;&lt;p&gt;Function term in &lt;em&gt;(x,y)&lt;/em&gt;:&#xA;  &lt;br&gt;&#xA;  &lt;input type&#34;text&#34; id=&#34;plot_input&#34; value=&#34;sin(x * y * r / 4)&#34; style=&#34;width: 10em; margin-top: 1rem;&#34;&gt;&#xA;  &lt;br&gt;&#xA;  &lt;input type=&#34;button&#34; id=&#34;plot_start&#34; value=&#34;plot&#34; onClick=&#34;start_plot();&#34; style=&#34;width: 4em; margin-top: 1rem;&#34;&gt;&#xA;  &lt;input type=&#34;button&#34; id=&#34;plot_reset&#34; value=&#34;reset&#34; onClick=&#34;reset_plot();&#34; style=&#34;width: 4em; margin-top: 1rem;&#34;&gt;&#xA;  &lt;br&gt;&lt;br&gt;&#xA;  (The function might also depend on the slider value &lt;em&gt;r&lt;/em&gt;.)&#xA;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;jsxgraph&#34; id=&#34;jsxgraph-1746962218780578024&#34; style=&#34;width: 100%; height: 20rem; margin: 0.5rem 0; border: 1px solid; border-radius: 10px; overflow: hidden; background-color: white; page-break-inside: avoid; break-inside: avoid;&#34;&gt;&lt;/div&gt;&#xA;&lt;script&gt;&#xA;(function(){&#xA;  var container = document.getElementById(&#39;jsxgraph-1746962218780578024&#39;);&#xA;&#xA;  function runUserScript() {&#xA;    &#xA;    // Define the id of your board in 3dplotter&#xA;&#xA;// Define some colors, optimized for color blinds&#xA;var colors = [JXG.palette.blue,&#xA;        JXG.palette.red,&#xA;        JXG.palette.green,&#xA;        JXG.palette.black,&#xA;        JXG.palette.purple,&#xA;        JXG.palette.yellow,&#xA;        JXG.palette.skyblue&#xA;    ],&#xA;    cnt = 0;&#xA;&#xA;// We make board a global variable.&#xA;// This is necessary just on this platform.&#xA;window.board = JXG.JSXGraph.initBoard(&#39;jsxgraph-1746962218780578024&#39;, {&#xA;    boundingbox: [-8, 8, 8, -8],&#xA;    keepaspectratio: true,&#xA;    axis: false,&#xA;    pan: {&#xA;        enabled: false&#xA;    }&#xA;});&#xA;&#xA;var box = [-5, 5];&#xA;var view = board.create(&#39;view3d&#39;, [&#xA;    [-6, -3],&#xA;    [8, 8],&#xA;    [box, box, box]&#xA;], {&#xA;    xPlaneRear: {visible: false}, yPlaneRear: {visible: false}&#xA;});&#xA;&#xA;// Create a slider which might be used in the function term&#xA;// using the name &#39;r&#39;&#xA;var slider = board.create(&#39;slider&#39;, [[-7, -6], [5, -6], [-3, 1, 4]], { name: &#39;r&#39; });&#xA;&#xA;// Handler for button &#39;plot&#39;&#xA;window.start_plot = function() {&#xA;    var txt = document.getElementById(&#39;plot_input&#39;).value,&#xA;        f = board.jc.snippet(txt, true, &#39;x,y&#39;, true), // JessieCode parsing&#xA;        el;&#xA;&#xA;    el = view.create(&#39;functiongraph3d&#39;, [f, box, box], {&#xA;        strokeColor: colors[cnt],&#xA;        stepsU: 50,&#xA;        stepsV: 50,&#xA;        strokeWidth: 0.5&#xA;    });&#xA;    board.update();&#xA;    // Cycle through the color array&#xA;    cnt = (cnt + 1) % colors.length;&#xA;}&#xA;&#xA;// Handler for button &#39;reset&#39;&#xA;window.reset_plot = function() {&#xA;    // Complete restart of the construction&#xA;    JXG.JSXGraph.freeBoard(board);&#xA;    board = JXG.JSXGraph.initBoard(&#39;jsxgraph-1746962218780578024&#39;, {&#xA;        boundingbox: [-8, 8, 8, -8],&#xA;        keepaspectratio: true,&#xA;    });&#xA;    view = board.create(&#39;view3d&#39;, [&#xA;        [-6, -3],&#xA;        [8, 8],&#xA;        [box, box, box]&#xA;    ]);&#xA;&#xA;    slider = board.create(&#39;slider&#39;, [&#xA;        [-7, -6],&#xA;        [5, -6],&#xA;        [-3, 1, 4]&#xA;    ], {&#xA;        name: &#39;r&#39;&#xA;    });&#xA;    cnt = 0;&#xA;}&#xA;  }&#xA;&#xA;  if (document.readyState === &#39;loading&#39;) {&#xA;    document.addEventListener(&#34;DOMContentLoaded&#34;, runUserScript);&#xA;  } else {&#xA;    runUserScript();&#xA;  }&#xA;})();&#xA;&lt;/script&gt;&lt;div class=&#34;jsxgraph&#34; id=&#34;jsxgraph-1746962218780622489&#34; style=&#34;width: 100%; height: 20rem; margin: 0.5rem 0; border: 1px solid; border-radius: 10px; overflow: hidden; background-color: white; page-break-inside: avoid; break-inside: avoid;&#34;&gt;&lt;/div&gt;&#xA;&lt;script&gt;&#xA;(function(){&#xA;  var container = document.getElementById(&#39;jsxgraph-1746962218780622489&#39;);&#xA;&#xA;  function runUserScript() {&#xA;    &#xA;    var brd = JXG.JSXGraph.initBoard(&#39;jsxgraph-1746962218780622489&#39;, {boundingbox: [-2, 2, 2, -2], keepaspectratio: true});&#xA;solveQ2 = function(x1,x2,x3,off) {&#xA;    var a, b, c, d;&#xA;    a = 0.5;&#xA;    b = -(x1+x2+x3);&#xA;    c = x1*x1+x2*x2+x3*x3-0.5*(x1+x2+x3)*(x1+x2+x3)-off;&#xA;    d = b*b-4*a*c;&#xA;    if (Math.abs(d)&lt;0.00000001) d = 0.0;&#xA;    return [(-b+Math.sqrt(d))/(2.0*a),(-b-Math.sqrt(d))/(2.0*a)];&#xA;}   &#xA;    &#xA;a = brd.create(&#39;segment&#39;,[[0,0],[2,0]],{visible:false});&#xA;p1 = brd.create(&#39;glider&#39;,[1.3,0,a],{name:&#39;Drag me&#39;});&#xA;b0 = -0.5;&#xA;&#xA;c0 = brd.create(&#39;circle&#39;,[[0,0],Math.abs(1.0/b0)],{strokeWidth:1});&#xA;c1 = brd.create(&#39;circle&#39;,[p1,function(){return 2-p1.X();}],{strokeWidth:1});&#xA;&#xA;c2 = brd.create(&#39;circle&#39;,[[function(){return p1.X()-2;},0],function(){return p1.X();}],{strokeWidth:1});&#xA;c0.curvature = function(){ return b0;}; // constant&#xA;c1.curvature = function(){ return 1/(2-p1.X());};&#xA;c2.curvature = function(){ return 1/(p1.X());};&#xA;&#xA;thirdCircleX = function() {&#xA;    var b0,b1,b2,x0,x1,x2, b3,bx3;&#xA;    b0 = c0.curvature();&#xA;    b1 = c1.curvature();&#xA;    b2 = c2.curvature();&#xA;    x0 = c0.midpoint.X();&#xA;    x1 = c1.midpoint.X();&#xA;    x2 = c2.midpoint.X();&#xA;&#xA;    b3 = solveQ2(b0,b1,b2,0);&#xA;    bx3 = solveQ2(b0*x0,b1*x1,b2*x2,2);&#xA;    return bx3[0]/b3[0];&#xA;}&#xA;thirdCircleY = function() {&#xA;    var b0,b1,b2,y0,y1,y2, b3,by3;&#xA;    b0 = c0.curvature();&#xA;    b1 = c1.curvature();&#xA;    b2 = c2.curvature();&#xA;    y0 = c0.midpoint.Y();&#xA;    y1 = c1.midpoint.Y();&#xA;    y2 = c2.midpoint.Y();&#xA;&#xA;    b3 = solveQ2(b0,b1,b2,0);&#xA;    by3 = solveQ2(b0*y0,b1*y1,b2*y2,2);&#xA;    return by3[0]/b3[0];&#xA;}&#xA;thirdCircleRadius = function() {&#xA;    var b0,b1,b2, b3,bx3,by3;&#xA;    b0 = c0.curvature();&#xA;    b1 = c1.curvature();&#xA;    b2 = c2.curvature();&#xA;    b3 = solveQ2(b0,b1,b2,0);&#xA;    return 1.0/b3[0];&#xA;}&#xA;&#xA;c3 = brd.create(&#39;circle&#39;,[[thirdCircleX,thirdCircleY],thirdCircleRadius],{strokeWidth:1});&#xA;c3.curvature = function(){ return 1.0/this.radius;};&#xA;&#xA;otherCirc = function(circs,level) {&#xA;    var c, fx,fy,fr;&#xA;    if (level&lt;=0) return;&#xA;    fx = function() {&#xA;        var b,x,i;&#xA;        b = [];&#xA;        x = [];&#xA;        for (i=0;i&lt;4;i++) {&#xA;            b[i] = circs[i].curvature();&#xA;            x[i] = circs[i].midpoint.X();&#xA;        }&#xA;    &#xA;        b[4] = 2*(b[0]+b[1]+b[2])-b[3];&#xA;        x[4] = (2*(b[0]*x[0]+b[1]*x[1]+b[2]*x[2])-b[3]*x[3])/b[4];&#xA;        return x[4];&#xA;    }&#xA;    fy = function() {&#xA;        var b,y,i;&#xA;        b = [];&#xA;        y = [];&#xA;        for (i=0;i&lt;4;i++) {&#xA;            b[i] = circs[i].curvature();&#xA;            y[i] = circs[i].midpoint.Y();&#xA;        }&#xA;    &#xA;        b[4] = 2*(b[0]+b[1]+b[2])-b[3];&#xA;        y[4] = (2*(b[0]*y[0]+b[1]*y[1]+b[2]*y[2])-b[3]*y[3])/b[4];&#xA;        return y[4];&#xA;    }&#xA;    fr = function() {&#xA;        var b,i;&#xA;        b = [];&#xA;        for (i=0;i&lt;4;i++) {&#xA;            b[i] = circs[i].curvature();&#xA;        }&#xA;        b[4] = 2*(b[0]+b[1]+b[2])-b[3];&#xA;        if (isNaN(b[4])) {&#xA;            return 1000.0;&#xA;        } else {&#xA;            return 1/b[4];&#xA;        }&#xA;    }&#xA;    c = brd.create(&#39;circle&#39;,[[fx,fy],fr],{strokeWidth:1,name:&#39;&#39;,&#xA;                 fillColor:JXG.hsv2rgb(50*level,0.8,0.8),highlightFillColor:JXG.hsv2rgb(50*level,0.5,0.8),fillOpacity:0.5,highlightFillOpacity:0.5});&#xA;    c.curvature = function(){ return 1/this.radius;};&#xA;&#xA;    // Recursion&#xA;    otherCirc([circs[0],circs[1],c,circs[2]],level-1);&#xA;    otherCirc([circs[0],circs[2],c,circs[1]],level-1);&#xA;    otherCirc([circs[1],circs[2],c,circs[0]],level-1);&#xA;    return c;&#xA;}&#xA;&#xA;//-------------------------------------------------------&#xA;brd.suspendUpdate();&#xA;level = 4;&#xA;otherCirc([c0,c1,c2,c3],level);&#xA;otherCirc([c3,c1,c2,c0],level);&#xA;otherCirc([c0,c2,c3,c1],level);&#xA;otherCirc([c0,c1,c3,c2],level);&#xA;brd.unsuspendUpdate();&#xA;  }&#xA;&#xA;  if (document.readyState === &#39;loading&#39;) {&#xA;    document.addEventListener(&#34;DOMContentLoaded&#34;, runUserScript);&#xA;  } else {&#xA;    runUserScript();&#xA;  }&#xA;})();&#xA;&lt;/script&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;短代码-mathbox-配置&#34;&gt;&lt;span&gt;短代码 &lt;code&gt;mathbox&lt;/code&gt; 配置&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e7%9f%ad%e4%bb%a3%e7%a0%81-mathbox-%e9%85%8d%e7%bd%ae&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;高配版的数学绘图工具 。&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;警告&lt;/p&gt;&lt;p&gt;由于用到了 &lt;code&gt;three.js&lt;/code&gt; , 有些图像可能无法正常加载 。&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;配置流程-3&#34;&gt;&lt;span&gt;配置流程&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e9%85%8d%e7%bd%ae%e6%b5%81%e7%a8%8b-3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;首先在 &lt;code&gt;./layouts/partials/assets.html&lt;/code&gt; 中加入下述代码 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- /* MathBox */ -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- if .Store.Get &amp;#34;hasMathBox&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;link&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://cdn.jsdelivr.net/npm/three@0.137.0/build/three.min.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://cdn.jsdelivr.net/npm/three@0.137.0/examples/js/controls/OrbitControls.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  {{- $source := $cdn.mathboxJS | default &amp;#34;https://cdn.jsdelivr.net/npm/mathbox@latest/build/bundle/mathbox.js&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;link&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://cdn.jsdelivr.net/npm/mathbox@latest/build/mathbox.css&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  {{- dict &amp;#34;Source&amp;#34; $source &amp;#34;Fingerprint&amp;#34; $fingerprint &amp;#34;Defer&amp;#34; false | dict &amp;#34;Scratch&amp;#34; .Scratch &amp;#34;Data&amp;#34; | partial &amp;#34;scratch/script.html&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- end -}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;然后创建 &lt;code&gt;./layouts/partials/shortcodes/mathbox.html&lt;/code&gt; 并将下述代码粘贴进文件中即可 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; title=&#34;mathbox.html&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $options := .Get &amp;#34;width&amp;#34; | default (.Get 0) | dict &amp;#34;width&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $options = .Get &amp;#34;height&amp;#34; | default (.Get 1) | dict &amp;#34;height&amp;#34; | merge $options -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{/*  {{- $options = .Get &amp;#34;renderer&amp;#34; | default &amp;#34;svg&amp;#34; | dict &amp;#34;renderer&amp;#34; | merge $options -}}  */}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- dict &amp;#34;Options&amp;#34; $options &amp;#34;Inner&amp;#34; .Inner | partial &amp;#34;plugin/mathbox.html&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- .Page.Store.Set &amp;#34;hasMathBox&amp;#34; true -}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;接着创建 &lt;code&gt;./layouts/partials/plugin/mathbox.html&lt;/code&gt; 并将下述代码粘贴进文件中即可 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; title=&#34;mathbox.html&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- /* MathBox support for code fences extended and shortcodes. */ -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $width := .Options.width | default &amp;#34;100%&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $height := .Options.height | default &amp;#34;20rem&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- $id := printf &amp;#34;mathbox-%d&amp;#34; now.UnixNano -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;{{ $id }}&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mathbox&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: {{ $width }}; height: {{ $height }}; margin: 2rem 0; border: 1px solid; border-radius: 10px; overflow: hidden; position: relative; page-break-inside: avoid; break-inside: avoid;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;container&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ $id }}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;userScript&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;container&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// 注入监控：等待用户 new dat.GUI() 并把它移到容器内&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;oldAppendChild&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;appendChild&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;appendChild&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;classList&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;contains&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;dg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;container&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;appendChild&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// 强制把 GUI 控件放进你想要的地方&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;position&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;absolute&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;1rem&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;right&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;1rem&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;oldAppendChild&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;call&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;{{&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Inner&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;replaceRE&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;MathBox\\.mathBox\\s*\\(\\s*\\{&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;nx&#34;&gt;printf&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;MathBox.mathBox({ element: container,&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;safeJS&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;readyState&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;loading&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;addEventListener&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;DOMContentLoaded&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;userScript&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;container&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;userScript&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;container&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;})();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;最后创建 &lt;code&gt;./layouts/_default/_markup/render-codeblock-mathbox.html&lt;/code&gt; 并将下述代码粘贴进文件中即可 。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; title=&#34;render-codeblock-mathbox.html&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- dict &amp;#34;Options&amp;#34; .Attributes &amp;#34;Inner&amp;#34; .Inner | partial &amp;#34;plugin/mathbox.html&amp;#34; -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- .Page.Store.Set &amp;#34;hasMathBox&amp;#34; true -}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;测试结果-3&#34;&gt;&lt;span&gt;测试结果&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e6%b5%8b%e8%af%95%e7%bb%93%e6%9e%9c-3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;div class=&#34;fi-row&#34;&gt;&#xA;&lt;script type=&#34;application/glsl&#34; id=&#34;rotate4D&#34;&gt;&#xA;uniform float cos1;&#xA;uniform float sin1;&#xA;uniform float cos2;&#xA;uniform float sin2;&#xA;uniform float cos3;&#xA;uniform float sin3;&#xA;uniform float cos4;&#xA;uniform float sin4;&#xA;&#xA;vec4 getRotate4D(vec4 xyzw, inout vec4 stpq) {&#xA;  xyzw.xy = xyzw.xy * mat2(cos1, sin1, -sin1, cos1);&#xA;  xyzw.zw = xyzw.zw * mat2(cos2, sin2, -sin2, cos2);&#xA;  xyzw.xz = xyzw.xz * mat2(cos3, sin3, -sin3, cos3);&#xA;  xyzw.yw = xyzw.yw * mat2(cos4, sin4, -sin4, cos4);&#xA;&#xA;  return xyzw;&#xA;}&#xA;&lt;/script&gt;&#xA;&lt;/div&gt;&#xA;&lt;div id=&#34;mathbox-1746962218782384943&#34; class=&#34;mathbox&#34; style=&#34;width: 100%; height: 20rem; &#xA;margin: 0.5rem 0; border: 1px solid; border-radius: 10px; overflow: hidden; position: relative; &#xA;page-break-inside: avoid; break-inside: avoid;&#34;&gt;&lt;/div&gt;&#xA;&#xA;&lt;script&gt;&#xA;(function(){&#xA;  const container = document.getElementById(&#39;mathbox-1746962218782384943&#39;);&#xA;&#xA;  const userScript = function(container) {&#xA;    &#xA;    const oldAppendChild = document.body.appendChild;&#xA;    document.body.appendChild = function (el) {&#xA;      if (el.classList?.contains(&#39;dg&#39;)) {&#xA;        container.appendChild(el);  &#xA;        el.style.position = &#39;absolute&#39;;&#xA;        el.style.top = &#39;1rem&#39;;&#xA;        el.style.right = &#39;1rem&#39;;&#xA;        return el;&#xA;      }&#xA;      return oldAppendChild.call(this, el);&#xA;    };&#xA;&#xA;    mathbox = MathBox.mathBox({ element: container,&#xA;  plugins: [&#34;core&#34;, &#34;controls&#34;, &#34;cursor&#34;],&#xA;  controls: {&#xA;    klass: THREE.OrbitControls,&#xA;  },&#xA;});&#xA;three = mathbox.three;&#xA;&#xA;three.camera.position.set(2.3, 1, 2);&#xA;three.renderer.setClearColor(new THREE.Color(0xffffff), 1.0);&#xA;&#xA;time = 0;&#xA;angle = 0;&#xA;deform = 0;&#xA;skew = 0;&#xA;&#xA;fa = 6;&#xA;fb = 4;&#xA;&#xA;three.on(&#34;update&#34;, function () {&#xA;  time = three.Time.clock * 0.6;&#xA;  angle = wobbler(time / 5) * 0.6 + MathBox.π / 4 + 0.2;&#xA;  skew = wobbler(time / 16.1) * 0.25;&#xA;  deform = wobbler(time / 7.1);&#xA;&#xA;  if (deform == 0) {&#xA;    fa = (Math.ceil(Math.random() * 2) + 1) * 2;&#xA;    fb = (Math.ceil(Math.random() * 2) + 1) * 2;&#xA;  }&#xA;&#xA;  deform *= cosineEase(time - 2);&#xA;});&#xA;&#xA;clamp = function (x, a, b) {&#xA;  return Math.max(a, Math.min(b, x));&#xA;};&#xA;&#xA;cosineEase = function (t) {&#xA;  return 0.5 - 0.5 * Math.cos(clamp(t, 0, 1) * MathBox.π);&#xA;};&#xA;&#xA;wobbler = function (t) {&#xA;  t = Math.sin(&#xA;    (Math.min(1, Math.max(-1, 0.7 * Math.asin(Math.cos(MathBox.π * t)))) *&#xA;      MathBox.τ) /&#xA;      4&#xA;  );&#xA;  return t * 0.5 - 0.5;&#xA;};&#xA;&#xA;hopf = function (emit, ϕ, θ, γ) {&#xA;  η =&#xA;    θ / 2 +&#xA;    (Math.cos(ϕ * 2 + time) * skew + Math.cos(ϕ * fa)) * 0.15 * deform;&#xA;  ξ1 = ϕ + Math.cos(γ * fb + time) * 0.25 * deform;&#xA;  ξ2 = γ;&#xA;&#xA;  sum = ξ1 + ξ2;&#xA;  diff = ξ1 - ξ2;&#xA;&#xA;  s = Math.sin(η);&#xA;  c = Math.cos(η);&#xA;&#xA;  x = Math.cos(sum) * s;&#xA;  y = Math.sin(sum) * s;&#xA;  z = Math.cos(diff) * c;&#xA;  w = Math.sin(diff) * c;&#xA;&#xA;  emit(z, y, w, x);&#xA;};&#xA;&#xA;view = mathbox&#xA;  .unit({&#xA;    scale: 500,&#xA;  })&#xA;  .stereographic4({&#xA;    range: [&#xA;      [-4, 4],&#xA;      [-4, 4],&#xA;      [-4, 4],&#xA;      [-1, 1],&#xA;    ],&#xA;    scale: [4, 4, 4, 1],&#xA;  });&#xA;&#xA;view.area({&#xA;  rangeX: [-MathBox.π, MathBox.π],&#xA;  rangeY: [-MathBox.π / 2, MathBox.π / 2],&#xA;  width: 127,&#xA;  height: 16,&#xA;  centeredX: false,&#xA;  centeredY: true,&#xA;  expr: function (emit, x, y, i, j) {&#xA;    ϕ = y;&#xA;    θ = angle;&#xA;    hopf(emit, ϕ, θ, x);&#xA;  },&#xA;  channels: 4,&#xA;});&#xA;view.line({&#xA;  color: 0x3080ff,&#xA;  zBias: 10,&#xA;  width: 3,&#xA;});&#xA;&#xA;view.area({&#xA;  rangeX: [-MathBox.π, MathBox.π],&#xA;  rangeY: [-0.6, 0.6],&#xA;  width: 127,&#xA;  height: 63,&#xA;  expr: function (emit, x, y, i, j) {&#xA;    ϕ = y + time;&#xA;    θ = angle;&#xA;    hopf(emit, ϕ, θ, x);&#xA;  },&#xA;  channels: 4,&#xA;});&#xA;view.surface({&#xA;  shaded: true,&#xA;  color: 0x3080ff,&#xA;  zBias: -5,&#xA;});&#xA;&#xA;view.area({&#xA;  rangeX: [-MathBox.π, MathBox.π],&#xA;  rangeY: [-MathBox.π / 2, MathBox.π / 2],&#xA;  width: 127,&#xA;  height: 63,&#xA;  expr: function (emit, x, y, i, j) {&#xA;    ϕ = y;&#xA;    θ = angle;&#xA;    hopf(emit, ϕ, θ, x);&#xA;  },&#xA;  channels: 4,&#xA;});&#xA;view.surface({&#xA;  shaded: true,&#xA;  color: 0xffffff,&#xA;  opacity: 0.5,&#xA;  zBias: -10,&#xA;});&#xA;  };&#xA;&#xA;  if (document.readyState === &#39;loading&#39;) {&#xA;    document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; userScript(container));&#xA;  } else {&#xA;    userScript(container);&#xA;  }&#xA;})();&#xA;&lt;/script&gt;&lt;div id=&#34;mathbox-1746962218782421516&#34; class=&#34;mathbox&#34; style=&#34;width: 100%; height: 20rem; &#xA;margin: 0.5rem 0; border: 1px solid; border-radius: 10px; overflow: hidden; position: relative; &#xA;page-break-inside: avoid; break-inside: avoid;&#34;&gt;&lt;/div&gt;&#xA;&#xA;&lt;script&gt;&#xA;(function(){&#xA;  const container = document.getElementById(&#39;mathbox-1746962218782421516&#39;);&#xA;&#xA;  const userScript = function(container) {&#xA;    &#xA;    const oldAppendChild = document.body.appendChild;&#xA;    document.body.appendChild = function (el) {&#xA;      if (el.classList?.contains(&#39;dg&#39;)) {&#xA;        container.appendChild(el);  &#xA;        el.style.position = &#39;absolute&#39;;&#xA;        el.style.top = &#39;1rem&#39;;&#xA;        el.style.right = &#39;1rem&#39;;&#xA;        return el;&#xA;      }&#xA;      return oldAppendChild.call(this, el);&#xA;    };&#xA;&#xA;    var π = Math.PI;&#xA;var mathbox = MathBox.mathBox({ element: container,&#xA;  plugins: [&#34;core&#34;, &#34;controls&#34;, &#34;cursor&#34;],&#xA;  controls: {&#xA;    klass: THREE.OrbitControls,&#xA;  },&#xA;});&#xA;&#xA;mathbox.three.camera.position.set(0, 0, 3);&#xA;mathbox.three.renderer.setClearColor(new THREE.Color(0xffffff), 1.0);&#xA;&#xA;var red = 0xdf2000;&#xA;var green = 0x20a000;&#xA;var blue = 0x3090ff;&#xA;&#xA;view = mathbox&#xA;  .set({&#xA;    scale: 500,&#xA;  })&#xA;  .clock({&#xA;    speed: 0.25,&#xA;  })&#xA;  .stereographic4()&#xA;  .shader(&#xA;    {&#xA;      code: &#34;#rotate4D&#34;,&#xA;    },&#xA;    {&#xA;      cos1: function (t) {&#xA;        return Math.cos(t * 0.111);&#xA;      },&#xA;      sin1: function (t) {&#xA;        return Math.sin(t * 0.111);&#xA;      },&#xA;      cos2: function (t) {&#xA;        return Math.cos(t * 0.151 + 1);&#xA;      },&#xA;      sin2: function (t) {&#xA;        return Math.sin(t * 0.151 + 1);&#xA;      },&#xA;      cos3: function (t) {&#xA;        return Math.cos(t * 0.071 + Math.sin(t * 0.081));&#xA;      },&#xA;      sin3: function (t) {&#xA;        return Math.sin(t * 0.071 + Math.sin(t * 0.081));&#xA;      },&#xA;      cos4: function (t) {&#xA;        return Math.cos(t * 0.053 + Math.sin(t * 0.066) + 1);&#xA;      },&#xA;      sin4: function (t) {&#xA;        return Math.sin(t * 0.053 + Math.sin(t * 0.066) + 1);&#xA;      },&#xA;    }&#xA;  )&#xA;  .vertex();&#xA;&#xA;var q1 = new THREE.Quaternion();&#xA;var q2 = new THREE.Quaternion();&#xA;&#xA;view.area({&#xA;  rangeX: [-π / 2, π / 2],&#xA;  rangeY: [0, 2 * π],&#xA;  width: 129,&#xA;  height: 65,&#xA;  expr: function (emit, θ, ϕ, i, j) {&#xA;    q1.set(0, 0, Math.sin(θ), Math.cos(θ));&#xA;    q2.set(0, Math.sin(ϕ), 0, Math.cos(ϕ));&#xA;    q1.multiply(q2);&#xA;    emit(q1.x, q1.y, q1.z, q1.w);&#xA;  },&#xA;  live: false,&#xA;  channels: 4,&#xA;});&#xA;view.line({&#xA;  color: blue,&#xA;});&#xA;&#xA;// ===========================================================================&#xA;&#xA;view.area({&#xA;  rangeX: [-π / 2, π / 2],&#xA;  rangeY: [0, 2 * π],&#xA;  width: 129,&#xA;  height: 65,&#xA;  expr: function (emit, θ, ϕ, i, j) {&#xA;    q1.set(0, Math.sin(θ), 0, Math.cos(θ));&#xA;    q2.set(Math.sin(ϕ), 0, 0, Math.cos(ϕ));&#xA;    q1.multiply(q2);&#xA;    emit(q1.x, q1.y, q1.z, q1.w);&#xA;  },&#xA;  live: false,&#xA;  channels: 4,&#xA;});&#xA;view.line({&#xA;  color: green,&#xA;});&#xA;&#xA;// ===========================================================================&#xA;&#xA;view.area({&#xA;  rangeX: [-π / 2, π / 2],&#xA;  rangeY: [0, 2 * π],&#xA;  width: 129,&#xA;  height: 65,&#xA;  expr: function (emit, θ, ϕ, i, j) {&#xA;    q1.set(Math.sin(θ), 0, 0, Math.cos(θ));&#xA;    q2.set(0, 0, Math.sin(ϕ), Math.cos(ϕ));&#xA;    q1.multiply(q2);&#xA;    emit(q1.x, q1.y, q1.z, q1.w);&#xA;  },&#xA;  live: false,&#xA;  channels: 4,&#xA;});&#xA;view.line({&#xA;  color: red,&#xA;});&#xA;&#xA;// ===========================================================================&#xA;  };&#xA;&#xA;  if (document.readyState === &#39;loading&#39;) {&#xA;    document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; userScript(container));&#xA;  } else {&#xA;    userScript(container);&#xA;  }&#xA;})();&#xA;&lt;/script&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;将博文导出为带书签的-pdf&#34;&gt;&lt;span&gt;将博文导出为带书签的 PDF&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e5%b0%86%e5%8d%9a%e6%96%87%e5%af%bc%e5%87%ba%e4%b8%ba%e5%b8%a6%e4%b9%a6%e7%ad%be%e7%9a%84-pdf&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;首先博文在导出为 PDF 的时候 , echarts , jsxgraph 和 mathbox 并不能跟随打印纸张的宽度而自适应 。&lt;/p&gt;&#xA;&lt;p&gt;其次浏览器默认的打印功能不支持为导出的 PDF 添加书签 , 因此借鉴了一下了知乎上两篇分别关于 &lt;a href=&#34;https://zhuanlan.zhihu.com/p/652509474&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Typora&lt;/a&gt;&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt; 和 &lt;a href=&#34;https://zhuanlan.zhihu.com/p/653165462&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Obsidian&lt;/a&gt;&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt; 导出带书签 PDF 的文章 。另外也可以参考这篇 &lt;a href=&#34;https://github.com/Hopding/pdf-lib/issues/127&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Github Issue&lt;/a&gt;&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt; 。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;配置流程-4&#34;&gt;&lt;span&gt;配置流程&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e9%85%8d%e7%bd%ae%e6%b5%81%e7%a8%8b-4&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;创建文件 &lt;code&gt;./layouts/partials/single/print-to-pdf.html&lt;/code&gt; 并将下述内容粘贴进文件中 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;132&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;133&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;134&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;135&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;136&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;137&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;138&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;139&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;140&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;141&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;142&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;143&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;144&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;145&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;146&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;147&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;148&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;149&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;150&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;151&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;152&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;153&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;154&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;155&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- 引入 pdf-lib --&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;print-controls&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;text-align: center; margin: 2rem 0;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;button&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;upload-btn&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    background-color: #444;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    color: white;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    padding: 0.6rem 1.2rem;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    border-radius: 8px;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    border: none;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    cursor: pointer;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    font-size: 0.95rem;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;点此上传本博文对应的 PDF 以自动为 PDF 添加书签&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pdf-upload&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;accept&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;application/pdf&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;display: none;&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;addEventListener&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;DOMContentLoaded&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;upload-btn&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;addEventListener&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;click&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pdf-upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;click&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pdf-upload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;addEventListener&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;change&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;handlePdfUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;addEventListener&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;beforeprint&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;querySelectorAll&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.single-title, .content h2, .content h3, .content h4&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;forEach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;querySelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;a.md-print-anchor&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;createElement&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;href&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`af://n&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;className&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;md-header-anchor md-print-anchor&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;display&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;inline-block&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;height&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0.1pt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;width&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0.1pt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;overflow&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;hidden&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;color&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;transparent&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;insertBefore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;anchor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;firstChild&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;addEventListener&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;afterprint&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;querySelectorAll&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.md-print-anchor&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;forEach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;remove&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;handlePdfUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;alert&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;请先选择一个 PDF 文件&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;arrayBuffer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;arrayBuffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pdfDoc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFDocument&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;arrayBuffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pages&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pdfDoc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getPages&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pdfDoc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;markerMap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pages&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;annots&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pages&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Annots&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;annots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;annots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ann&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;annots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lookup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFDict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;subtype&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ann&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Subtype&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;subtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;asString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/Link&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;action&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ann&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;uri&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;URI&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;asString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;rect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ann&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Rect&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;asRectangle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;match&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sr&#34;&gt;/^af:\/\/(.+)$/&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;anchorId&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;rect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;nx&#34;&gt;markerMap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;anchorId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pageIndex&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;warn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;annotation parse failed&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;headings&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;querySelectorAll&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.single-title, .content h2, .content h3, .content h4&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.single-title&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;parseInt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tagName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;innerText&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;marker&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`n&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;}))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;markerMap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;has&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;marker&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;headings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;alert&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;未在 PDF 中找到任何 af:// 书签标记，请确认已插入锚点并打印。&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;outlineNodes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;headings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;forEach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(({&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;level&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;marker&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pageIndex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;markerMap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;marker&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;page&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pages&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pageIndex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;destArray&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;page&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;XYZ&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFNumber&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFNumber&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFNull&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dict&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;Title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFHexString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fromText&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;Dest&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;destArray&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;outlineNodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;level&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;topLevel&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;outlineNodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;forEach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;node&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;level&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;topLevel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;linkSiblings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Prev&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Next&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;First&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Last&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Count&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFNumber&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;nx&#34;&gt;linkSiblings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;linkSiblings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;topLevel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;outlineDict&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;Type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Outlines&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;First&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;topLevel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;Last&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;topLevel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;topLevel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;Count&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFNumber&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;topLevel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;pdfDoc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;catalog&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Outlines&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;register&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;outlineDict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;pdfDoc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;catalog&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;PageMode&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;PDFLib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PDFName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;UseOutlines&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pdfBytes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pdfDoc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;blob&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Blob&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pdfBytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;application/pdf&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;link&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;createElement&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;link&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;href&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;URL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;createObjectURL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;blob&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;originalName&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sr&#34;&gt;/\.pdf$/i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;link&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;download&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;originalName&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;-带书签.pdf`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;link&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;click&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;将文件 &lt;code&gt;./themes/FixIt/layouts/posts/single.html&lt;/code&gt; 复制到 &lt;code&gt;./layouts/posts/single.html&lt;/code&gt; 并将 &lt;code&gt;Custom block before post footer&lt;/code&gt; 处修改为如下 :&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34; data-open=&#34;false&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- /* Custom block before post footer */ -}}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{- block &amp;#34;custom-post__footer:before&amp;#34; . }}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{ partial &amp;#34;single/print-to-pdf.html&amp;#34; . }} {{ end -}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;测试结果-4&#34;&gt;&lt;span&gt;测试结果&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e6%b5%8b%e8%af%95%e7%bb%93%e6%9e%9c-4&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;页面底部会出现一个按钮 。&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;博客发布&#34;&gt;&lt;span&gt;博客发布&lt;/span&gt;&#xA;  &lt;a href=&#34;#%e5%8d%9a%e5%ae%a2%e5%8f%91%e5%b8%83&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://jianzhnie.github.io/post/hugo_site/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;这里的链接&lt;/a&gt;&lt;sup id=&#34;fnref:6&#34;&gt;&lt;a href=&#34;#fn:6&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;6&lt;/a&gt;&lt;/sup&gt;写的很清楚 。&lt;/p&gt;&#xA;&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;&#xA;&lt;hr&gt;&#xA;&lt;ol&gt;&#xA;&lt;li id=&#34;fn:1&#34;&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/hugo-fixit/FixIt/issues/574&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/hugo-fixit/FixIt/issues/574&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li id=&#34;fn:2&#34;&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://gohugo.io/render-hooks/passthrough/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://gohugo.io/render-hooks/passthrough/&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref1:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li id=&#34;fn:3&#34;&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/652509474&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://zhuanlan.zhihu.com/p/652509474&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li id=&#34;fn:4&#34;&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/653165462&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://zhuanlan.zhihu.com/p/653165462&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li id=&#34;fn:5&#34;&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Hopding/pdf-lib/issues/127&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/Hopding/pdf-lib/issues/127&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li id=&#34;fn:6&#34;&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://jianzhnie.github.io/post/hugo_site/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://jianzhnie.github.io/post/hugo_site/&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:6&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/div&gt;&#xA;</description>
    </item>
  </channel>
</rss>
