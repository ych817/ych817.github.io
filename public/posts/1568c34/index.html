<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>翻译-EOPL-02-数据抽象 - 采石场</title><meta name="author" content="沉积岩">
<meta name="description" content="$$ \rm\LaTeX\textrm{ Definitions are here.} \def\Int{\textrm{Int}} \def\Expression{\textrm{Expression}} \def\SList{\textrm{S-list}} \def\SExp{\textrm{S-exp}} \def\Symbol{\textrm{Symbol}} \def\Bintree{\textrm{Bintree}} \def\LcExp{\textrm{LcExp}} \def\Iden{\textrm{Identifier}} \def\BinSearchTree{\textrm{Binary-search-tree}} \def\InductHyp{\textit{IH}} \def\List{\textrm{List}} \def\ScmVal{\textrm{Scheme\_value}} \def\ListOfInt{\textrm{List-of-Int}} \def\ListOfSymbol{\textrm{List-of-Symbol}} \def\ListOf#1{\textrm{List-of-(#1)}} \def\VectorOf#1{\textrm{Vector-of(#1)}} \def\implement#1{\lceil#1\rceil} \def\DiffTree{\textrm{Diff-Tree}} \def\EnvExp{\textrm{Env-exp}} \def\Var{\textrm{Var}} \def\Bool{\textrm{Bool}} \def\NodeInSeq{\textrm{NodeInSequence}} \def\RedBlueTree{\textrm{Red-blue-tree}} \def\RedBlueSubtree{\textrm{Red-blue-subtree}} \def\PrefixList{\textrm{Prefix-list}} $$2.1 通过接口声明数据 每当我们以某种方式描述集合时 , 一种新数据类型便会随之产生 。 对这些数据类型下的实体而言 , 其值为其外在的表示 , 而基于其的运算便是处理这些实体的过程 。
"><meta name="keywords" content='翻译, EOPL, 函数式编程, Racket, Lisp'>
  <meta itemprop="name" content="翻译-EOPL-02-数据抽象">
  <meta itemprop="description" content="$$ \rm\LaTeX\textrm{ Definitions are here.} \def\Int{\textrm{Int}} \def\Expression{\textrm{Expression}} \def\SList{\textrm{S-list}} \def\SExp{\textrm{S-exp}} \def\Symbol{\textrm{Symbol}} \def\Bintree{\textrm{Bintree}} \def\LcExp{\textrm{LcExp}} \def\Iden{\textrm{Identifier}} \def\BinSearchTree{\textrm{Binary-search-tree}} \def\InductHyp{\textit{IH}} \def\List{\textrm{List}} \def\ScmVal{\textrm{Scheme\_value}} \def\ListOfInt{\textrm{List-of-Int}} \def\ListOfSymbol{\textrm{List-of-Symbol}} \def\ListOf#1{\textrm{List-of-(#1)}} \def\VectorOf#1{\textrm{Vector-of(#1)}} \def\implement#1{\lceil#1\rceil} \def\DiffTree{\textrm{Diff-Tree}} \def\EnvExp{\textrm{Env-exp}} \def\Var{\textrm{Var}} \def\Bool{\textrm{Bool}} \def\NodeInSeq{\textrm{NodeInSequence}} \def\RedBlueTree{\textrm{Red-blue-tree}} \def\RedBlueSubtree{\textrm{Red-blue-subtree}} \def\PrefixList{\textrm{Prefix-list}} $$2.1 通过接口声明数据 每当我们以某种方式描述集合时 , 一种新数据类型便会随之产生 。 对这些数据类型下的实体而言 , 其值为其外在的表示 , 而基于其的运算便是处理这些实体的过程 。">
  <meta itemprop="datePublished" content="2025-04-02T23:11:17+13:00">
  <meta itemprop="dateModified" content="2025-04-02T23:11:17+13:00">
  <meta itemprop="wordCount" content="3850">
  <meta itemprop="keywords" content="翻译,EOPL,函数式编程,Racket,Lisp"><meta property="og:url" content="http://localhost:1313/posts/1568c34/">
  <meta property="og:site_name" content="采石场">
  <meta property="og:title" content="翻译-EOPL-02-数据抽象">
  <meta property="og:description" content="$$ \rm\LaTeX\textrm{ Definitions are here.} \def\Int{\textrm{Int}} \def\Expression{\textrm{Expression}} \def\SList{\textrm{S-list}} \def\SExp{\textrm{S-exp}} \def\Symbol{\textrm{Symbol}} \def\Bintree{\textrm{Bintree}} \def\LcExp{\textrm{LcExp}} \def\Iden{\textrm{Identifier}} \def\BinSearchTree{\textrm{Binary-search-tree}} \def\InductHyp{\textit{IH}} \def\List{\textrm{List}} \def\ScmVal{\textrm{Scheme\_value}} \def\ListOfInt{\textrm{List-of-Int}} \def\ListOfSymbol{\textrm{List-of-Symbol}} \def\ListOf#1{\textrm{List-of-(#1)}} \def\VectorOf#1{\textrm{Vector-of(#1)}} \def\implement#1{\lceil#1\rceil} \def\DiffTree{\textrm{Diff-Tree}} \def\EnvExp{\textrm{Env-exp}} \def\Var{\textrm{Var}} \def\Bool{\textrm{Bool}} \def\NodeInSeq{\textrm{NodeInSequence}} \def\RedBlueTree{\textrm{Red-blue-tree}} \def\RedBlueSubtree{\textrm{Red-blue-subtree}} \def\PrefixList{\textrm{Prefix-list}} $$2.1 通过接口声明数据 每当我们以某种方式描述集合时 , 一种新数据类型便会随之产生 。 对这些数据类型下的实体而言 , 其值为其外在的表示 , 而基于其的运算便是处理这些实体的过程 。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-02T23:11:17+13:00">
    <meta property="article:modified_time" content="2025-04-02T23:11:17+13:00">
    <meta property="article:tag" content="翻译">
    <meta property="article:tag" content="EOPL">
    <meta property="article:tag" content="函数式编程">
    <meta property="article:tag" content="Racket">
    <meta property="article:tag" content="Lisp">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="翻译-EOPL-02-数据抽象">
  <meta name="twitter:description" content="$$ \rm\LaTeX\textrm{ Definitions are here.} \def\Int{\textrm{Int}} \def\Expression{\textrm{Expression}} \def\SList{\textrm{S-list}} \def\SExp{\textrm{S-exp}} \def\Symbol{\textrm{Symbol}} \def\Bintree{\textrm{Bintree}} \def\LcExp{\textrm{LcExp}} \def\Iden{\textrm{Identifier}} \def\BinSearchTree{\textrm{Binary-search-tree}} \def\InductHyp{\textit{IH}} \def\List{\textrm{List}} \def\ScmVal{\textrm{Scheme\_value}} \def\ListOfInt{\textrm{List-of-Int}} \def\ListOfSymbol{\textrm{List-of-Symbol}} \def\ListOf#1{\textrm{List-of-(#1)}} \def\VectorOf#1{\textrm{Vector-of(#1)}} \def\implement#1{\lceil#1\rceil} \def\DiffTree{\textrm{Diff-Tree}} \def\EnvExp{\textrm{Env-exp}} \def\Var{\textrm{Var}} \def\Bool{\textrm{Bool}} \def\NodeInSeq{\textrm{NodeInSequence}} \def\RedBlueTree{\textrm{Red-blue-tree}} \def\RedBlueSubtree{\textrm{Red-blue-subtree}} \def\PrefixList{\textrm{Prefix-list}} $$2.1 通过接口声明数据 每当我们以某种方式描述集合时 , 一种新数据类型便会随之产生 。 对这些数据类型下的实体而言 , 其值为其外在的表示 , 而基于其的运算便是处理这些实体的过程 。">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/1568c34/" title="翻译-EOPL-02-数据抽象 - 采石场" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/5cce8df/" title="翻译-EOPL-01-递归的数据集" /><link rel="next" type="text/html" href="http://localhost:1313/posts/a3b7a27/" title="翻译-EOPL-03" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/posts/1568c34/index.md" title="翻译-EOPL-02-数据抽象 - 采石场"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "翻译-EOPL-02-数据抽象",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/1568c34\/"
    },"genre": "posts","keywords": "翻译, EOPL, 函数式编程, Racket, Lisp","wordcount":  3850 ,
    "url": "http:\/\/localhost:1313\/posts\/1568c34\/","datePublished": "2025-04-02T23:11:17+13:00","dateModified": "2025-04-02T23:11:17+13:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "沉积岩"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="采石场"><span class="header-title-text">采石场</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/"><i class="fa-solid fa-home fa-fw fa-sm" aria-hidden="true"></i> 主页</a></li><li class="menu-item">
              <a class="menu-link" href="/posts/"><i class="fa-solid fa-feather fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li class="menu-item">
              <a class="menu-link" href="/archives/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 归档</a></li><li class="menu-item">
              <a class="menu-link" href="/collections/"><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden="true"></i> 合集</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a class="menu-link" href="/about"><i class="fa-solid fa-circle-user fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="采石场"><span class="header-title-text">采石场</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/"><i class="fa-solid fa-home fa-fw fa-sm" aria-hidden="true"></i> 主页</a></li><li class="menu-item"><a class="menu-link" href="/posts/"><i class="fa-solid fa-feather fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li class="menu-item"><a class="menu-link" href="/archives/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 归档</a></li><li class="menu-item"><a class="menu-link" href="/collections/"><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden="true"></i> 合集</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item"><a class="menu-link" href="/about"><i class="fa-solid fa-circle-user fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item" data-separator="/"><a href="/" title="采石场">主页</a></li><li class="breadcrumb-item" data-separator="/"><a href="/posts/" title="Posts">文章</a></li><li class="breadcrumb-item active" data-separator="/" aria-current="page">翻译-EOPL-02-数据抽象</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"><div class="details collection-details open">
      <div class="details-summary collection-summary">
        <i class="fa-solid fa-layer-group fa-fw" aria-hidden="true"></i>
        <span class="collection-name" title="合集">翻译-EOPL</span>
        <span class="collection-count">5</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content collection-content">
        <nav>
          <ul class="collection-list"><li class="collection-item"><a href="/posts/d83fb0b/" title="翻译-EOPL-05">翻译-EOPL-05</a></li><li class="collection-item"><a href="/posts/a588704/" title="翻译-EOPL-04">翻译-EOPL-04</a></li><li class="collection-item"><a href="/posts/a3b7a27/" title="翻译-EOPL-03">翻译-EOPL-03</a></li><li class="collection-item"><span class="active" title="翻译-EOPL-02-数据抽象">翻译-EOPL-02-数据抽象</span></li><li class="collection-item"><a href="/posts/5cce8df/" title="翻译-EOPL-01-递归的数据集">翻译-EOPL-01-递归的数据集</a></li></ul>
          <div class="collection-nav-simple"><a href="/posts/a3b7a27/" class="collection-nav-item" rel="prev" title="翻译-EOPL-03"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i></a><span class="text-secondary">4/5</span><a href="/posts/5cce8df/" class="collection-nav-item" rel="next" title="翻译-EOPL-01-递归的数据集"><i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
        </nav>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="转载" class="icon-repost"><i class="fa-solid fa-share fa-fw" aria-hidden="true"></i></span><span>翻译-EOPL-02-数据抽象</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      沉积岩</span></span><span class="post-included-in">&nbsp;收录于 <a href="/collections/%E7%BF%BB%E8%AF%91-eopl/" class="post-collection" title="合集 - 翻译-EOPL"><i class="fa-solid fa-layer-group fa-fw" aria-hidden="true"></i> 翻译-EOPL</a></span></div><div class="post-meta-line"><span title="发布于 2025-04-02 23:11:17"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-04-02">2025-04-02</time></span>&nbsp;<span title="3850 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 3900 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 19 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#S2.1">2.1 通过接口声明数据</a></li>
    <li><a href="#S2.2">2.2 数据类型的表示策略</a>
      <ul>
        <li><a href="#S2.2.1">2.2.1 环境的接口</a></li>
        <li><a href="#S2.2.2">2.2.2 数据结构表示法</a></li>
        <li><a href="#S2.2.3">2.2.3 过程表示法</a></li>
      </ul>
    </li>
    <li><a href="#S2.3">2.3 递归数据类型的接口</a></li>
    <li><a href="#2.4">2.4 一个定义递归数据类型的工具</a></li>
    <li><a href="#S2.5">2.5 抽象语法及其表示</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="End.">$$
\rm\LaTeX\textrm{ Definitions are here.}
\def\Int{\textrm{Int}}
\def\Expression{\textrm{Expression}}
\def\SList{\textrm{S-list}}
\def\SExp{\textrm{S-exp}}
\def\Symbol{\textrm{Symbol}}
\def\Bintree{\textrm{Bintree}}
\def\LcExp{\textrm{LcExp}}
\def\Iden{\textrm{Identifier}}
\def\BinSearchTree{\textrm{Binary-search-tree}}
\def\InductHyp{\textit{IH}}
\def\List{\textrm{List}}
\def\ScmVal{\textrm{Scheme\_value}}
\def\ListOfInt{\textrm{List-of-Int}}
\def\ListOfSymbol{\textrm{List-of-Symbol}}
\def\ListOf#1{\textrm{List-of-(#1)}}
\def\VectorOf#1{\textrm{Vector-of(#1)}}
\def\implement#1{\lceil#1\rceil}
\def\DiffTree{\textrm{Diff-Tree}}
\def\EnvExp{\textrm{Env-exp}}
\def\Var{\textrm{Var}}
\def\Bool{\textrm{Bool}}
\def\NodeInSeq{\textrm{NodeInSequence}}
\def\RedBlueTree{\textrm{Red-blue-tree}}
\def\RedBlueSubtree{\textrm{Red-blue-subtree}}
\def\PrefixList{\textrm{Prefix-list}}
$$<h2 class="heading-element" id="S2.1"><span>2.1 通过接口声明数据</span>
  <a href="#S2.1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>每当我们以某种方式描述集合时 , 一种新数据类型便会随之产生 。
对这些数据类型下的实体而言 ,
其值为其外在的表示 ,
而基于其的运算便是处理这些实体的过程 。</p>
<p>这些实体的表示通常会很复杂 。如果允许的话 , 我们不会关心它们具体的实现细节 ,
但是我们可能会改变数据的表示 。完美的表示往往难以实现 ,
因此我们会先尝试一些简单的实现 , 只有在系统整体性能与之攸关时才改用更高效的表示 。
如果决定要改变某些数据的表示方式 , 我们需要能定位出程序中所有依赖该表示的部分 。
这就需要借助<strong>数据抽象 data abstraction</strong> 技术 。</p>
<p>数据抽象将数据类型分为两部分 : <strong>接口 interface</strong> 和<strong>实现 implementation</strong> 。接口告诉我们类型表示什么数据 ,
数据可进行什么操作 ,
这些操作可得出什么性质 , 等等 ;
而实现则会给出数据的具体表示以及处理数据表示的代码 。</p>
<p>这样抽象出的数据类型称作<strong>抽象数据类型 abstract data type</strong> 。程序的其余部分 ( 即数据类型
的<strong>用户 client</strong> ) 只能通过接口中指定的操作来处理新数据 。这样一来如果希望改变数据的表示
我们只需改变数据处理接口的实现即可 。</p>
<p>这一想法并不陌生 : 我们写程序处理文件时一般只关心能否调用过程以对文件进行打开 , 关闭 ,
读取或其他操作 。同样地在大多数时候我们并不关心整数在机器中究竟怎样表示 , 只关心能否
可靠地执行算术操作 。</p>
<p>如果数据类型下的项只能通过接口提供的过程进行处理, 那么我们便可将代码称作<strong>表示无关的 representation independent</strong> —— 因为这些代码不依赖这些项的值的表示  。</p>
<p>如此所有关于数据表示的信息必然在实现对应的代码之中 ; 实现中最重要的部分便是声明数据
的表示方式 。我们用记号 $\implement v$ 表示 &quot; $v$ 的表示 &quot; 。</p>
<p>为使这一切更明了 , 考虑一个简单的例子 —— 自然数类型 :  待表示数据为自然数 , 接口由四个
过程组成 : <code>zero</code> , <code>is-zero?</code> , <code>successor</code> , <code>predecessor</code> ; 当然不是随便几个过程都能够
作为该接口的实现 , 一组过程只有同时满足下述四个方程才可作为下述接口的实现 :</p>
<p>$\qquad \begin{aligned}[t]
&\texttt{(zero)} 
&{}={}
&\implement 0 
\\
&\texttt{(is-zero? \implement {$n$})}
&{}={}
&\begin{cases}
\texttt{\#t} & n=0 \\
\texttt{\#f} & n\neq 0
\end{cases}
\\
&\texttt{(successor \implement {$n$})}
&{}={}
&\implement{n+1} & (n\geq 0) 
\\
&\texttt{(predecessor \implement {$n+1$})}
&{}={}
&\implement{n} & (n\geq 0)
\end{aligned}$</p>
<p>该定义并未指明自然数应当如何表示 , 它只要求这些过程产生指定的行为 —— 如 <code>zero</code> 必须
返回 <code>0</code> 的表示 , <code>successor</code> 须返回 <code>n+1</code> 的表示 , 等等 ;  该定义并没有对 <code>zero</code> 做出说明 ,
所以按照该定义任何行为都是可接受的 。</p>
<p>现在我们可以写出处理自然数的用户程序 ,
并且不论用哪种表示方式都可以保证得出正确结果 。如 ,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">plus</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">is-zero?</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">y</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nf">successor</span> <span class="p">(</span><span class="nf">plus</span> <span class="p">(</span><span class="nf">predecessor</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">y</span><span class="p">)))))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>都将满足 $\texttt{(plus \implement {$x$}  \implement {$y$})} = \implement {x+y}$ , 无论采用的表示方式为如何 。</p>
<p>大多数接口都包含若干用于创建数据类型的元素的<strong>构造器 constructor</strong> 及若干用于从数据类型
的元素中提取信息的<strong>观测器 observer</strong> 。这里也不例外 : 有三个构造器 <code>zero</code> , <code>successor</code> 及
<code>predecessor</code> 外加一个观测器 <code>is-zero?</code> 。</p>
<p>可以用多种方式表示这套接口 。我们考虑其中三种 :</p>
<ol>
<li>
<p><strong>一元表示法 Unary representation</strong> :
在一元表示法中自然数 <code>n</code> 表示为 <code>n</code> 个 <code>#t</code> 构成的列表 ; 如此</p>
<p>$\qquad \begin{aligned}[t]
   &\implement 0 
   &{}={}
   &\texttt{()}
   \\
   &\implement 1
   &{}={}
   &\texttt{(\#t)}
   \\
   &\implement 2
   &{}={}
   &\texttt{(\#t \#t)}
   \end{aligned}$</p>
<p>如此便可递归定义该表示法 :</p>
<p>$\qquad \begin{aligned}[t]
   &\implement 0 
   &{}={}
   &\texttt{()}
   \\
   &\implement {n+1}
   &{}={}
   &\texttt{(\#t . n)}
   \\
   \end{aligned}$</p>
<p>在该表示法中我们可通过下述代码实现接口</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">zero</span>        <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>  <span class="o">&#39;</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">is-zero?</span>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">n</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">successor</span>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="no">#t</span> <span class="nv">n</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">predecessor</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">n</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>Scheme 数字表示法 Scheme number representation</strong> :
该表示仅涉及 Scheme 内置的数字表示法 ( 本身可能十分复杂 ! ) 。
如果令 $\implement n$ 为 Scheme 整数 $n$ , 则所需的四个过程可以定义为：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(define zero        (lambda ()  0))
</span></span><span class="line"><span class="cl">(define is-zero?    (lambda (n) (zero? n)))
</span></span><span class="line"><span class="cl">(define successor   (lambda (n) (+ n 1)))
</span></span><span class="line"><span class="cl">(define predecessor (lambda (n) (- n 1)))</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>大数表示法 Bignum representation</strong> :
此表示法中数值以 $N$ 进制表示 , 其中 $N$ 是某个整数 ; 该方法以 $0$ 到 $N-1$ 之间的数字 (
有时不称数位而称<strong>大位 bigit</strong> ) 组成的表来表示数值 , 这就很容易表示那些远超机器字长
的整数 。为了便使用 , 这里把最低位放在列表最前端 。该表示法可通过归纳法如下定义 :</p>
<p>$\qquad \begin{aligned}[t]
   &\implement n 
   &{}={}
   & 0 && \textrm{若 $n=0$} \\
   &&
   & \texttt{(r . \implement {$q$})} &&\textrm{若 $n=qN+r$ 且 $0\leq r &lt; N$}
   \end{aligned}$</p>
<p>因此若 $N=16$ 则 $\implement {33}=\texttt{(1 2)}$ 且 $\implement {258} =\texttt{(2 0 1)}$ —— 因为</p>
<p>$\qquad 258 = 2\times 16^0+0\times 16^1+1\times 16^2$</p>
</li>
</ol>
<p>上述表示法都没有强制数据抽象 ,
没有东西可以阻止用户程序查验表示法用的究竟是列表还是 Scheme 整数 。
有些语言对数据抽象有直接支持 , 它们允许程序员创建新接口并确保只能通过
接口提供的过程处理新数据 。若类型表示被隐藏且不会因任何操作而暴露 ( 包括打印 ) 则称作<strong>模糊 opaque</strong> 的 , 否则称为<strong>透明 transparent</strong> 的 。</p>
<p>Scheme 并未提供标准机制来创建新的模糊类型 , 因此我们采取一种折衷的抽象级别 —— 定义
接口并劳烦用户程序的作者谨慎行事 , 只使用接口中定义的过程 。</p>
<p>在第 8 章 ( 模块 ) 将会研究一些方法以强化语言的这种行为准则 。</p>
<p><div class="fi-row"><a id="Xer2.1"></a></div><strong>练习 2.1</strong> <code>[*]</code><br>
尝试实现大数表示法的四种接口并用你的实现求 10 的阶乘 。执行时间将会随着参数 / 进制
的改变如何变化 ? 请解释原因 。</p>
<div class="details admonition note">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-pencil-alt" aria-hidden="true"></i>答 :<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content"><div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="c1">;; 设置大数表示法的基底</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">base</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">set-base!</span> <span class="nv">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">set! </span><span class="nv">base</span> <span class="nv">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; 下面是大数表示法的四个接口</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">zero</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">is-zero?</span> <span class="nv">null?</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">successor</span> <span class="nv">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">cond </span><span class="p">[(</span><span class="nf">is-zero?</span> <span class="nv">n</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">car </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">base</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">car </span><span class="nv">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                                      <span class="p">(</span><span class="nb">cdr </span><span class="nv">n</span><span class="p">))]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="mi">0</span> <span class="p">(</span><span class="nf">successor</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">n</span><span class="p">)))]))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">predecessor</span> <span class="nv">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">cond </span><span class="p">[(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nb">car </span><span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nf">zero</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                           <span class="p">(</span><span class="nb">cons </span><span class="mi">0</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">n</span><span class="p">)))]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nb">car </span><span class="nv">n</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">car </span><span class="nv">n</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">n</span><span class="p">))]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">- </span><span class="nv">base</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">predecessor</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">n</span><span class="p">)))]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; 整数与大数表示法的互相转换</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">integer-&gt;bigits</span> <span class="nv">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">zero</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">successor</span> <span class="p">(</span><span class="nf">integer-&gt;bigits</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">bigits-&gt;integer</span> <span class="nv">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">is-zero?</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">bigits-&gt;integer</span> <span class="p">(</span><span class="nf">predecessor</span> <span class="nv">n</span><span class="p">)))))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; 加法和乘法</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">plus</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">is-zero?</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">y</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">successor</span> <span class="p">(</span><span class="nf">plus</span> <span class="p">(</span><span class="nf">predecessor</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">y</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">multiply</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">cond </span><span class="p">[(</span><span class="nf">is-zero?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">zero</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[(</span><span class="nf">is-zero?</span> <span class="p">(</span><span class="nf">predecessor</span> <span class="nv">x</span><span class="p">))</span> <span class="nv">y</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="k">else </span><span class="p">(</span><span class="nf">plus</span> <span class="nv">y</span> <span class="p">(</span><span class="nf">multiply</span> <span class="p">(</span><span class="nf">predecessor</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">y</span><span class="p">))]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; 阶乘</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">is-zero?</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">successor</span> <span class="p">(</span><span class="nf">zero</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">multiply</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">factorial</span> <span class="p">(</span><span class="nf">predecessor</span> <span class="nv">n</span><span class="p">)))))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; 测试</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">with-base</span> <span class="nv">n</span> <span class="nv">thunk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">let </span><span class="p">[(</span><span class="nf">orig-base</span> <span class="nv">base</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">begin</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">set-base!</span> <span class="nv">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">thunk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">set-base!</span> <span class="nv">orig-base</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">print-factorial</span> <span class="nv">base</span> <span class="nv">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">with-base</span>
</span></span><span class="line"><span class="cl">    <span class="nv">base</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">collect-garbage</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">eopl:printf</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;Base ~s: ~s! = ~s~%&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">base</span>
</span></span><span class="line"><span class="cl">        <span class="nv">n</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nf">bigits-&gt;integer</span> <span class="p">(</span><span class="nf">factorial</span> <span class="p">(</span><span class="nf">integer-&gt;bigits</span> <span class="nv">n</span><span class="p">)))))))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>注意到 :</p>
<ul>
<li><code>(factorial n)</code> 中的 <code>n</code> 与执行时间成正比 ( 原因在于阶乘运算本身的时间复杂度 ) ;</li>
<li><code>(set-base! n)</code> 中的 <code>n</code> 与执行时间成反比 ( 大基数在表示数字时所需的位数更少 ) 。</li>
</ul></div>
  </div>
</div><p><div class="fi-row"><a id="Xer2.2"></a></div><strong>练习 2.2</strong> <code>[**]</code><br>
详细分析上述表示法 : 从满足数据类型定义的角度来说 , 在何种程度上它们是成功 / 失败的 ?</p>
<div class="details admonition note">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-pencil-alt" aria-hidden="true"></i>答 :<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content"><table>
  <thead>
      <tr>
          <th>表示法</th>
          <th>优点</th>
          <th>缺点</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>一元</td>
          <td>实现简单 , 完全符合规范 , 仅受物理内存容量的限制</td>
          <td>性能差 , 另外在表示大数字时几乎不可读</td>
      </tr>
      <tr>
          <td>Scheme  数字</td>
          <td>实现简单 , 表示方式易于阅读 , 性能良好 ( 完全由底层具体的 Scheme 实现决定 )</td>
          <td>对于没有内建大数支持的 Scheme 实现计算结果可能会溢出，因此不能完全符合规范</td>
      </tr>
      <tr>
          <td>大数</td>
          <td>完全符合规范 , 性能相对较好 ( 较大的基数会带来更好的性能 )</td>
          <td>依赖于基数 , 不容易实现</td>
      </tr>
  </tbody>
</table></div>
  </div>
</div><p><div class="fi-row"><a id="Xer2.3"></a></div><strong>练习 2.3</strong> <code>[**]</code><br>
用差分树表示所有整数 ( 负数和非负数 ) 。差分树是一个列表 , 对应的语法定义如下：</p>
<p>$\qquad \begin{aligned}[t]\DiffTree ::={}& \texttt{(one)} \mid \texttt{(diff \DiffTree  \DiffTree)}\end{aligned}$</p>
<p>列表 $\texttt{(one)}$ 表示 $1$ ; 另外若 $t_1$ 表示 $n_1$ 且 $t_2$ 表示 $n_2$ 则 $\texttt{(diff $t_1$ $t_2$)}$ 表示 $n_1 - n_2$ 。</p>
<p>故 $\texttt{(one)}$ 和 $\texttt{(diff (one) (diff (one) (one)))}$ 都表示 $1$ ;
而 $\texttt{(diff (diff (one) (one)) (one))}$ 表示的数则是 $-1$ 。</p>
<ol>
<li>
<p>证明此系统中的每个数都有无限种表示方式 。</p>
<div class="details admonition note">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-pencil-alt" aria-hidden="true"></i>证 : 反证法 。<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content"><p>假如 $S$ 为自然数 $n$ 的所有表示所构成的集 , 那么对任意 $x\in S$ 我们定义集合 $S'$ 为满足下述两条推理规则的集合 :</p>
<ol>
<li>
<p>$\begin{prooftree}\AXC{}\UIC{\(x\in S'\)}\end{prooftree}$</p>
</li>
<li>
<p>$\begin{prooftree}\AXC{\(y\in S'\)}\UIC{\(\texttt{(diff \(y\) (diff (one) (one)))}\)}\end{prooftree}$</p>
</li>
</ol>
<p>不难看出 $S'$ 是无穷集 ; 而 $S'\subseteq S$ , 故 $S$ 亦为无穷集 。</p></div>
  </div>
</div></li>
<li>
<p>完整实现这种整数表示法  ——  即写出整数定义的 <code>zero</code> , <code>is-zero?</code> , <code>successor</code>
和 <code>predecessor</code> 。此外还要能表示负数 。此表示法中整数的任何合法表示都可以
作为你过程的参数 : 如过程 <code>successor</code> 可接受无限多种 <code>1</code> 的合法表示且最终都能
给出一个 <code>2</code> 的合法表示 ; 对 <code>1</code> 的不同合法表示皆可给出对应的 <code>2</code> 的合法表示 。</p>
<div class="details admonition note">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-pencil-alt" aria-hidden="true"></i>答 : <mark class="mark-default">TODO</mark><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content"><div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div></li>
<li>
<p>写出过程 <code>diff-tree-plus</code> 并用这种表示做加法 。你的过程应针对不同的差分树
进行优化并在常数时间内得出结果 ( 即与输入大小无关 ) 。注意本题不能使用递归 。</p>
</li>
</ol>
<h2 class="heading-element" id="S2.2"><span>2.2 数据类型的表示策略</span>
  <a href="#S2.2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>一旦使用了数据抽象 , 程序便拥有了表示无关性 —— 其与用来实现抽象数据类型的具体的
表示方式无关 。我们甚至还可以通过重新定义接口中的一小部分来改变数据的表示 。在
后面的章节会经常用到此性质 。</p>
<p>本节将介绍几种数据类型的表示策略 : 我们将通过<strong>环境 environment</strong> 数据类型对这些策略
进行探究 ; 环境会将有限个变量与这些变量对应的值逐个关联起来 。在编程语言的实现中
环境可用来维系变量与值之间的关系 , 编译器也可借由环境将变量名与变量信息关联起来 。</p>
<p>变量可用任何我们喜欢的方式来表示 , 只要能够检查两个变量是否相等即可 。这里我们用
Scheme 符号表示变量 , 但在没有符号数据类型的语言中变量也可用字符串 、哈希表引用
甚至是数字来表示 ( 见 <a href="/posts/a3b7a27/#S3.6">3.6 节</a> ) 。</p>
<h3 class="heading-element" id="S2.2.1"><span>2.2.1 环境的接口</span>
  <a href="#S2.2.1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>环境是个函数 , 其定义域为变量构成的有限集 , 值域为所有 Scheme 值构成的集 。数学中
有限函数常被解释为由有序对组成的有限集 ;  而本书决定采用该释义 , 因此就必须表示出
所有形如 $\texttt{(($var_1$,$val_1$),...,($var_n$,$val_n$))}$ 的集 ,  其中 $var_i$ 为某一变量而 $val_i$ 为任意的
Scheme 值 。有时也将环境 $env$ 中变量 $var$ 的值 $val$ 称作是 $var$ 在 $env$ 中的<strong>绑定 binding</strong> 。</p>
<p>该数据类型的接口有三个过程 , 定义如下 :</p>
<p>$\qquad\begin{aligned}[t]
&\texttt{(empty-env)}
&{}={}
&\implement \varnothing
\\
&\texttt{(apply-env \implement {$f$}  $var$)}
&{}={}
&f(var)
\\
&\texttt{(extend-env $var$ $val$ \implement {$f$})}
&{}={}
&\implement g , &其中~
g(var_1) ={}
\begin{cases}
val      & 如果~ var_1=var\\
f(var_1) & 否则
\end{cases}
\end{aligned}$</p>
<p>过程 <code>empty-env</code> 不接受参数并返回空环境的表示 ;  <code>apply-env</code> 将环境 $\implement f$ 应用到 $env$ ;
组合式 $\texttt{(extend-env $var$ $val$ $env$)}$ 将产生一个行为同 $env$ 的新环境 ,  只不过新环境里
变量 $var$ 的值会被设为 $val$ 。例如 : 表达式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">e</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">extend-env</span> <span class="ss">&#39;d</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">extend-env</span> <span class="ss">&#39;y</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">extend-env</span> <span class="ss">&#39;x</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nf">extend-env</span> <span class="ss">&#39;y</span> <span class="mi">14</span><span class="p">)))))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>定义了一个环境 $e$ 满足 $e(\texttt{d}) = 6$ , $e(\texttt{x}) = 7$ , $e(\texttt{y}) = 8$ 并且 $e$ 对任何其他变量都是未定义的 ;
当然这只是生成该环境的众多方法之一 。在刚才的例子中 , $\tt y$ 先被绑定到 $14$ 后被绑定到 $8$ 。</p>
<p>与上一个例子类似 , 我们可将接口的过程分为构造器和观测器 ; 本例中的 <code>empty-env</code> 以及
<code>extend-env</code> 是构造器 , 而 <code>apply-env</code> 则是唯一的观测器 。</p>
<p><div class="fi-row"><a id="Xer2.4"></a></div><strong>练习 2.4</strong> <code>[**]</code><br>
考虑<strong>栈 stack</strong> 数据类型 , 其接口有 <code>empty-stack</code> , <code>push</code> , <code>pop</code> , <code>top</code> , <code>empty-stack?</code> 。
请模仿示例中的方式写出这些过程的定义 。另外上述过程中哪些是构造器 , 哪些是观测器 ?</p>
<h3 class="heading-element" id="S2.2.2"><span>2.2.2 数据结构表示法</span>
  <a href="#S2.2.2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>易知每个环境都是从空环境开始搭建并由 $n$ 次调用 <code>extend-env</code> 以获得 , 其中 $n\geq 0$ 。如</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">extend-env</span> <span class="nv">varn</span> <span class="nv">valn</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">extend-env</span> <span class="nv">var1</span> <span class="nv">val1</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">empty-env</span><span class="p">))</span> <span class="o">...</span> <span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>由此便可获得环境的一种表示方法 。</p>
<p>$\qquad \begin{aligned}[t]
\EnvExp 
::={} & \texttt{(empty-env)} \\
::={} & \texttt{(extend-env \Iden  \ScmVal  \EnvExp)}
\end{aligned}$</p>
<p>我们可用描述列表集合 $\List$ 的递归语法来描述环境 , 如此便可获得<a href="#G2.1">图 2.1</a> 中的实现 。过程
<code>apply-env</code> 会查看表示环境的数据结构以判断它表示哪种环境并做出适当操作 : 若它表示
空环境则会报错 ; 若它表示的是由 <code>extend-env</code> 生成的环境则判断待查找的变量是否会与
环境中绑定的某一变量相同 : 如果是则返回保存的值 , 否则则在保存的环境中查找变量 。</p>
<p>这是种常见的代码模式 , 我们管它叫<strong>解释器配方 interpreter recipe</strong> :</p>
<blockquote>
<p><strong>解释器配方</strong></p>
<ol>
<li>查看一段数据 。</li>
<li>判断它表示什么样的数据 。</li>
<li>提取数据的各个部分并对它们做适当操作 。</li>
</ol></blockquote>
<p>下方为图 2.1 —— 环境的数据结构表示 。<div class="fi-row"><a id="G2.1"></a></div></p>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="c1">;; Env = (empty-env) | (extend-env Var SchemeVal Env)</span>
</span></span><span class="line"><span class="cl"><span class="c1">;; Var = Sym</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; empty-env : () → Env</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">empty-env</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> 
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">list </span><span class="ss">&#39;empty-env</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; extend-env : Var × SchemeVal × Env → Env</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">extend-env</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">var</span> <span class="nv">val</span> <span class="nv">env</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">list </span><span class="ss">&#39;extend-env</span> <span class="nv">var</span> <span class="nv">val</span> <span class="nv">env</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; apply-env : Env × Var → SchemeVal</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">apply-env</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">env</span> <span class="nv">search-var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">cond</span>
</span></span><span class="line"><span class="cl">      <span class="p">[(</span><span class="nb">eqv? </span><span class="p">(</span><span class="nb">car </span><span class="nv">env</span><span class="p">)</span> <span class="ss">&#39;empty-env</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nf">report-no-binding-found</span> <span class="nv">search-var</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[(</span><span class="nb">eqv? </span><span class="p">(</span><span class="nb">car </span><span class="nv">env</span><span class="p">)</span> <span class="ss">&#39;extend-env</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">saved-var</span> <span class="p">(</span><span class="nb">cadr </span><span class="nv">env</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">             <span class="p">(</span><span class="nf">saved-val</span> <span class="p">(</span><span class="nb">caddr </span><span class="nv">env</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">             <span class="p">(</span><span class="nf">saved-env</span> <span class="p">(</span><span class="nb">cadddr </span><span class="nv">env</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eqv? </span><span class="nv">search-var</span> <span class="nv">saved-var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">             <span class="nv">saved-val</span>
</span></span><span class="line"><span class="cl">             <span class="p">(</span><span class="nf">apply-env</span> <span class="nv">saved-env</span> <span class="nv">search-var</span><span class="p">)))]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nv">else</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nf">report-invalid-env</span> <span class="nv">env</span><span class="p">)])))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">report-no-binding-found</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">search-var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">eopl:error</span> <span class="ss">&#39;apply-env</span> <span class="s">&#34;No binding for ~s&#34;</span> <span class="nv">search-var</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">report-invalid-env</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">env</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">eopl:error</span> <span class="ss">&#39;apply-env</span> <span class="s">&#34;Bad environment: ~s&#34;</span> <span class="nv">env</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p><div class="fi-row"><a id="Xer2.5"></a></div><strong>练习 2.5</strong> <code>[*]</code><br>
我们可以用任何数据结构表示空环境 —— 只要能区分空 / 非空环境并且可以从后者中提取出
数据片段 。请按下述要求实现环境 : 空环境由空列表表示 , 而 <code>extend-env</code> 将生成如下环境：
$
% \qquad \begin{xy}0;p+/r+10pt/:p+/u+10pt/::
% (0,0)*+=<10pt>[F-]{}="point-to-var1-pair";
% (1,0)*+=<10pt>[F-]{}="point-to-env1"     ;
% {\ar{-};(1,0);p!R+/r+1.5cm/|(1.6){saved-env}};
% "point-to-var1-pair"+/d+1.5cm/;p+/r+10pt/:p+/d+10pt/::
% (0,0)*+=<10pt>[F-]{}="var1-pair-var";
% (1,0)*+=<10pt>[F-]{}="var1-pair-val";
% {\ar{-};0;"var1-pair-var"};
% {\ar{-};(0,0);p!R+/dl+1.5cm/|(1.2){saved-var}};
% {\ar{-};(1,0);p!R+/dr+1.5cm/|(1.2){saved-val}};
% \end{xy}
$</p>




  <div class="svg-container">
    <svg style="vertical-align: -13.069ex;" xmlns="http://www.w3.org/2000/svg" width="32.004ex" height="15.105ex" role="img" focusable="false" viewBox="0 -900 14145.9 6676.5" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><defs><path id="MJX-60-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-60-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-60-TEX-I-1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path><path id="MJX-60-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJX-60-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-60-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-60-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-60-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-60-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mspace"></g></g><g data-mml-node="xypic" data-cmd-id="0" data-text-mml-ids="[0,1,2,3,4,5,6]" transform="translate(2000,0)"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="0.64" transform="translate(4468.1,250) scale(62.5, -62.5)"><rect x="-8" y="-8" width="16" height="16" rx="0" stroke="currentColor"></rect><rect x="8" y="-8" width="16" height="16" rx="0" stroke="currentColor"></rect><line x1="16" y1="0" x2="60.84" y2="0" stroke-dasharray=""></line><g transform="translate(62.4,0) rotate(0) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="-8" y="38.4" width="16" height="16" rx="0" stroke="currentColor"></rect><rect x="8" y="38.4" width="16" height="16" rx="0" stroke="currentColor"></rect><line x1="0" y1="0" x2="0" y2="38.4" stroke-dasharray=""></line><g transform="translate(0,38.4) rotate(90) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><line x1="0" y1="46.4" x2="-32.72" y2="79.12" stroke-dasharray=""></line><g transform="translate(-32.81,79.21) rotate(135) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><line x1="16" y1="46.4" x2="48.72" y2="79.12" stroke-dasharray=""></line><g transform="translate(48.81,79.21) rotate(45) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g></g><g stroke="currentColor" fill="currentColor" data-x="0" data-y="0" data-xypic-id="0" transform="translate(4468.1,250)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="1" data-y="0" data-xypic-id="1" transform="translate(5468.1,250)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="3.9436508319334727" data-y="0.2163746750430835" data-xypic-id="2" transform="translate(8411.7,33.6)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-60-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(469,0)"><use data-c="1D44E" xlink:href="#MJX-60-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(998,0)"><use data-c="1D463" xlink:href="#MJX-60-TEX-I-1D463"></use></g><g data-mml-node="mi" transform="translate(1483,0)"><use data-c="1D452" xlink:href="#MJX-60-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(1949,0)"><use data-c="1D451" xlink:href="#MJX-60-TEX-I-1D451"></use></g><g data-mml-node="mo" transform="translate(2469,0)"><use data-c="2212" xlink:href="#MJX-60-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(3247,0)"><use data-c="1D452" xlink:href="#MJX-60-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(3713,0)"><use data-c="1D45B" xlink:href="#MJX-60-TEX-I-1D45B"></use></g><g data-mml-node="mi" transform="translate(4313,0)"><use data-c="1D463" xlink:href="#MJX-60-TEX-I-1D463"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="1.6653345369377348e-16" data-y="2.9" data-xypic-id="3" transform="translate(4468.1,-2650)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="1.0000000000000002" data-y="2.9" data-xypic-id="4" transform="translate(5468.1,-2650)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="-4.126675175004691" data-y="5.5771062735722685" data-xypic-id="5" transform="translate(341.4,-5327.1)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-60-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(469,0)"><use data-c="1D44E" xlink:href="#MJX-60-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(998,0)"><use data-c="1D463" xlink:href="#MJX-60-TEX-I-1D463"></use></g><g data-mml-node="mi" transform="translate(1483,0)"><use data-c="1D452" xlink:href="#MJX-60-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(1949,0)"><use data-c="1D451" xlink:href="#MJX-60-TEX-I-1D451"></use></g><g data-mml-node="mo" transform="translate(2469,0)"><use data-c="2212" xlink:href="#MJX-60-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(3247,0)"><use data-c="1D463" xlink:href="#MJX-60-TEX-I-1D463"></use></g><g data-mml-node="mi" transform="translate(3732,0)"><use data-c="1D44E" xlink:href="#MJX-60-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(4261,0)"><use data-c="1D45F" xlink:href="#MJX-60-TEX-I-1D45F"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="1.84888169081445" data-y="5.5771062735722685" data-xypic-id="6" transform="translate(6317,-5327.1)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-60-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(469,0)"><use data-c="1D44E" xlink:href="#MJX-60-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(998,0)"><use data-c="1D463" xlink:href="#MJX-60-TEX-I-1D463"></use></g><g data-mml-node="mi" transform="translate(1483,0)"><use data-c="1D452" xlink:href="#MJX-60-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(1949,0)"><use data-c="1D451" xlink:href="#MJX-60-TEX-I-1D451"></use></g><g data-mml-node="mo" transform="translate(2469,0)"><use data-c="2212" xlink:href="#MJX-60-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(3247,0)"><use data-c="1D463" xlink:href="#MJX-60-TEX-I-1D463"></use></g><g data-mml-node="mi" transform="translate(3732,0)"><use data-c="1D44E" xlink:href="#MJX-60-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(4261,0)"><use data-c="1D459" xlink:href="#MJX-60-TEX-I-1D459"></use></g></g></g></g></g></g></svg>
  </div>
  <style>
    .svg-container {
      display: inline-block;
      width: 100%;
      max-width: 100%;
      height: auto;
      overflow-x: auto;
      overflow-y: hidden;
    }
    .svg-container svg {
      width: auto;
      height: auto;
      
      
    }
  </style>

<p>这叫做<strong>关联列表 association-list 表示法</strong>或 <strong>a-list 表示法</strong> 。</p>
<p><div class="fi-row"><a id="Xer2.6"></a></div><strong>练习 2.6</strong> <code>[*]</code><br>
请发明至少三种环境接口表示 , 并给出它们具体的实现 。</p>
<p><div class="fi-row"><a id="Xer2.7"></a></div><strong>练习 2.7</strong> <code>[*]</code><br>
重写<a href="#G2.1">图 2.1</a> 中的 <code>apply-env</code> 并给出更详细的错误信息 。</p>
<p><div class="fi-row"><a id="Xer2.8"></a></div><strong>练习 2.8</strong> <code>[*]</code><br>
为环境接口添加观测器 <code>empty-env?</code> 并用 a-list 表示法实现它 。</p>
<p><div class="fi-row"><a id="Xer2.9"></a></div><strong>练习 2.9</strong> <code>[*]</code><br>
为环境接口添加观测器 <code>has-binding?</code> : 其取一个环境 $env$ 以及一个变量 $s$ 并判断 $s$ 在
$env$ 中是否有绑定值 。请用 a-list 表示法实现它 。</p>
<p><div class="fi-row"><a id="Xer2.10"></a></div><strong>练习 2.10</strong> <code>[**]</code><br>
为环境接口添加构造器 <code>extend-env*</code> 并用 a-list 表示法实现它 : 该构造器接受的参数有 :
一个变量列表 , 一个长度相等的值列表以及一个环境 。其定义为 :</p>
<p>$\qquad \texttt{(extended-env* ($var_1$ ... $var_k$) ($val_1$ ... $val_k$) \implement {$f$})} = \implement g$ , 其中</p>
<p>$\qquad g = \begin{cases}
val_i & \textrm{若存在 $i$ 满足 $1\leq i\leq k$ 且 $var=var_i$} \\
f(var)& \textrm{否则}
\end{cases}$</p>
<p><div class="fi-row"><a id="Xer2.11"></a></div><strong>练习 2.11</strong> <code>[**]</code><br>
考虑前一题中 <code>extend-env*</code> 较为拙劣的实现 , 其运行时间与 $k$ 成正比 。有一种表示可使得
<code>extend-env*</code> 的运行时间为常数 : 及用空列表表示空环境并用下面的数据结构表示非空环境 :
$
%\qquad \qquad \begin{xy}0;p+/r+10pt/:p+/d+10pt/::
%(0,0)="var1-pair-c"*+=<10pt>[F-]{}="var1-pair";
%(1,0)="env1-c"     *+=<10pt>[F-]{}="env1"     ;
%"env1"+/r+5cm/;p+/r+10pt/:p+/d+10pt/::
%(0,0)="var2-pair-c"*+=<10pt>[F-]{}="var2-pair";
%(1,0)="env2-c"     *+=<10pt>[F-]{}="env2"     ;
%{\ar{-};"env1-c";"var2-pair"^{\text{backbone}}};
%"env2"+/r+5cm/;p+/r+10pt/:p+/d+10pt/::
%(0,0)="var3-pair-c"*+=<10pt>[F-]{}="var3-pair";
%(1,0)="env3-c"     *+=<10pt>[F-]{}="env3"     ;
%{\ar{-};"env2-c";"var3-pair"^{\text{backbone}}};
%{\ar{-};"env3-c";p!R+/r+3cm/|(1.3){{\text{rest of env}}}};
%"var1-pair"+/d+1.5cm/;p+/r+10pt/:p+/d+10pt/::
%(0,0)*+=<10pt>[F-]{}="var1-pair-var";
%(1,0)*+=<10pt>[F-]{}="var1-pair-val";
%{\ar{-};"var1-pair-c";"var1-pair-var"};
%{\ar{-};(0,0);p!R+/dl+1.5cm/|(1.2){\texttt{(a b c)}}};
%{\ar{-};(1,0);p!R+/dr+1.5cm/|(1.2){\texttt{(11 12 13)}}};
%"var2-pair"+/d+1.5cm/;p+/r+10pt/:p+/d+10pt/::
%(0,0)*+=<10pt>[F-]{}="var2-pair-var";
%(1,0)*+=<10pt>[F-]{}="var2-pair-val";
%{\ar{-};"var2-pair-c";"var2-pair-var"};
%{\ar{-};(0,0);p!R+/dl+1.5cm/|(1.2){\texttt{(x z)}}};
%{\ar{-};(1,0);p!R+/dr+1.5cm/|(1.2){\texttt{(66 77)}}};
%"var3-pair"+/d+1.5cm/;p+/r+10pt/:p+/d+10pt/::
%(0,0)*+=<10pt>[F-]{}="var3-pair-var";
%(1,0)*+=<10pt>[F-]{}="var3-pair-val";
%{\ar{-};"var3-pair-c";"var3-pair-var"};
%{\ar{-};(0,0);p!R+/dl+1.5cm/|(1.2){\texttt{(x y)}}};
%{\ar{-};(1,0);p!R+/dr+1.5cm/|(1.2){\texttt{(88 99)}}};
%\end{xy}
$</p>




  <div class="svg-container">
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   style="vertical-align: -13.186ex;"
   width="90.34ex"
   height="16.424ex"
   role="img"
   focusable="false"
   viewBox="0 -1431.4 39930.3 7259.5"
   aria-hidden="true"
   version="1.1"
   id="svg1307"
   sodipodi:docname="Xer2.11.svg"
   inkscape:version="1.1.1 (3bf5ae0d25, 2021-09-20)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1309"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     showgrid="false"
     inkscape:zoom="0.032882297"
     inkscape:cx="19965.15"
     inkscape:cy="3634.1743"
     inkscape:window-width="1920"
     inkscape:window-height="992"
     inkscape:window-x="-8"
     inkscape:window-y="-8"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg1307" />
  <defs
     id="defs853">
    <path
       id="MJX-68-TEX-N-62"
       d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z" />
    <path
       id="MJX-68-TEX-N-61"
       d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z" />
    <path
       id="MJX-68-TEX-N-63"
       d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z" />
    <path
       id="MJX-68-TEX-N-6B"
       d="M36 46H50Q89 46 97 60V68Q97 77 97 91T97 124T98 167T98 217T98 272T98 329Q98 366 98 407T98 482T98 542T97 586T97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V463L180 233L240 287Q300 341 304 347Q310 356 310 364Q310 383 289 385H284V431H293Q308 428 412 428Q475 428 484 431H489V385H476Q407 380 360 341Q286 278 286 274Q286 273 349 181T420 79Q434 60 451 53T500 46H511V0H505Q496 3 418 3Q322 3 307 0H299V46H306Q330 48 330 65Q330 72 326 79Q323 84 276 153T228 222L176 176V120V84Q176 65 178 59T189 49Q210 46 238 46H254V0H246Q231 3 137 3T28 0H20V46H36Z" />
    <path
       id="MJX-68-TEX-N-6F"
       d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" />
    <path
       id="MJX-68-TEX-N-6E"
       d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" />
    <path
       id="MJX-68-TEX-N-65"
       d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z" />
    <path
       id="MJX-68-TEX-N-72"
       d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z" />
    <path
       id="MJX-68-TEX-N-73"
       d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" />
    <path
       id="MJX-68-TEX-N-74"
       d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z" />
    <path
       id="MJX-68-TEX-N-20"
       d="" />
    <path
       id="MJX-68-TEX-N-66"
       d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z" />
    <path
       id="MJX-68-TEX-N-76"
       d="M338 431Q344 429 422 429Q479 429 503 431H508V385H497Q439 381 423 345Q421 341 356 172T288 -2Q283 -11 263 -11Q244 -11 239 -2Q99 359 98 364Q93 378 82 381T43 385H19V431H25L33 430Q41 430 53 430T79 430T104 429T122 428Q217 428 232 431H240V385H226Q187 384 184 370Q184 366 235 234L286 102L377 341V349Q377 363 367 372T349 383T335 385H331V431H338Z" />
    <path
       id="MJX-68-TEX-M-28"
       d="M437 -53Q437 -82 399 -82H394Q377 -82 342 -55Q259 7 213 102T166 306Q166 412 211 507T342 667Q377 694 393 694H399Q437 694 437 665Q437 654 426 643T397 620T356 584T311 525Q301 511 290 488T264 412T250 306Q250 191 300 105T422 -27Q437 -37 437 -53Z" />
    <path
       id="MJX-68-TEX-M-1D68A"
       d="M126 306Q105 306 90 321T74 359Q74 439 211 439Q268 439 276 438Q343 426 383 390T430 306Q431 301 431 190V81Q446 79 465 78T492 76T509 72T521 60T524 38Q524 11 506 3Q502 1 466 1Q426 1 406 5T379 14T355 36L345 30Q284 -6 205 -6Q135 -6 92 39T48 141Q48 182 79 212T158 256T252 278T342 285H347V290Q347 315 325 335T267 362Q258 363 224 363Q189 363 185 362H179L178 358Q178 353 178 352T176 345T174 337T170 330T165 322T158 316T150 311T139 308T126 306ZM132 140Q132 115 157 93T224 70Q269 70 302 87T344 133Q346 139 347 175V211H339Q256 209 194 190T132 140Z" />
    <path
       id="MJX-68-TEX-M-20"
       d="" />
    <path
       id="MJX-68-TEX-M-1D68B"
       d="M4 573Q4 596 15 603T52 611H90H124Q146 611 155 608T171 591Q173 586 173 491V396L182 402Q217 424 256 431Q280 437 309 437Q376 437 434 379T492 217Q492 162 473 118T422 47T358 8T293 -6Q229 -6 174 38Q171 13 163 7T135 1H131H122Q99 1 90 23L89 279V535H58L27 536Q4 543 4 573ZM409 215Q409 269 377 315T283 361Q255 361 224 344T177 297L173 290V167Q189 124 213 97T278 70Q330 70 369 111T409 215Z" />
    <path
       id="MJX-68-TEX-M-1D68C"
       d="M291 -6Q196 -6 131 60T66 216Q66 296 119 361Q154 403 200 421T273 439Q275 440 293 440H313Q400 440 433 409Q454 388 454 359Q454 335 439 321T402 306Q380 306 365 321T350 357V362L340 363Q339 363 326 363T303 364Q280 364 266 362Q217 352 184 313T151 215Q151 153 199 112T313 70Q341 70 357 85T381 118T394 140Q402 146 424 146Q443 146 447 144Q466 137 466 117Q466 106 457 88T429 47T374 10T291 -6Z" />
    <path
       id="MJX-68-TEX-M-29"
       d="M87 664Q87 694 126 694Q138 694 147 690T183 667Q266 605 312 510T358 306Q358 193 307 93T161 -70Q142 -82 126 -82Q105 -82 96 -73T87 -53Q87 -47 88 -44Q92 -36 116 -19T173 34T230 119Q273 206 273 306Q273 408 231 494T109 635Q87 649 87 664Z" />
    <path
       id="MJX-68-TEX-M-1D7F7"
       d="M99 461Q99 470 99 474T104 487T120 498T151 502Q213 517 251 596Q264 622 283 622Q308 622 319 597V76H373H401Q428 76 439 69T450 38Q450 11 428 1H127Q104 10 104 38Q104 62 115 69T153 76H181H235V269Q235 461 234 461Q184 426 137 424H133Q124 424 119 425T109 431T99 447V461Z" />
    <path
       id="MJX-68-TEX-M-1D7F8"
       d="M52 462Q52 528 110 575T247 622H250Q343 622 407 565T472 421Q472 371 446 324T390 248T308 178Q307 177 275 151T214 101L185 77Q185 76 286 76H388V87Q388 105 397 114T430 123T463 114Q470 107 471 100T472 61V42Q472 24 468 16T450 1H75Q53 10 53 32V38V48Q53 57 63 67T127 122Q153 144 169 157L289 256Q388 345 388 419Q388 473 346 509T231 545H224Q176 545 146 499L144 494Q155 476 155 459Q154 459 155 455T154 444T148 430T136 417T114 408Q113 408 110 408T104 407Q80 407 66 422T52 462Z" />
    <path
       id="MJX-68-TEX-M-1D7F9"
       d="M260 546Q233 546 211 541T180 531T171 524L174 514Q177 505 177 497Q177 476 162 461T125 446Q106 446 90 459T73 504Q76 540 98 565T150 601T203 616T239 621Q241 622 265 622Q322 620 362 602T420 558T444 513T451 478Q451 386 369 329L375 326Q381 323 386 320T401 311T419 298T436 283T452 263T466 240T475 212T479 180Q479 99 416 44T259 -11T105 28T44 130Q44 154 59 168T95 183Q117 183 132 169T148 131Q148 119 139 101Q175 65 260 65Q316 65 355 97T395 179Q395 211 375 240Q336 292 253 292H234H215Q194 292 185 299T175 330Q175 350 184 359Q192 368 238 370T309 384Q336 398 351 423T367 474Q367 496 350 513Q321 546 260 546Z" />
    <path
       id="MJX-68-TEX-M-1D6A1"
       d="M35 393Q35 417 46 424T89 432Q95 432 112 432T141 431H223Q238 422 241 415T244 393Q244 389 244 383T237 367T216 355Q209 355 209 354L234 319Q259 286 260 286L308 354Q308 355 301 355Q285 356 278 365T270 384L271 393Q271 420 289 428Q295 431 376 431H459Q460 430 465 427T472 422T476 416T480 407T481 393Q481 368 470 362T434 355H425H392L344 290Q295 225 295 223Q294 223 309 203T350 149L405 77L439 76H453Q474 76 484 69T495 38Q495 10 473 1H303Q281 9 281 32V38Q281 49 282 54T290 67T313 76Q324 76 324 77L259 173L197 77Q202 76 209 76Q225 75 233 68T241 55T242 38Q242 28 242 24T236 12T221 1H51Q29 9 29 32V38Q29 48 29 51T31 59T38 67T51 76H117L171 149Q224 222 224 223L124 355H90H78Q54 355 45 361T35 393Z" />
    <path
       id="MJX-68-TEX-M-1D6A3"
       d="M56 1Q40 7 37 14T34 41Q34 59 36 64Q39 67 43 73Q65 95 191 213T341 355H133V334Q133 306 124 297Q116 289 91 289H83Q60 289 51 308Q49 313 49 361L50 409Q59 427 72 430H78Q83 430 92 430T115 430T144 430T179 431T219 431T262 431H450Q452 430 455 428T459 424T463 422T466 419T468 416T469 413T470 409T471 404T472 398T472 391Q472 374 469 368L462 358Q453 349 315 218Q210 122 164 76H391V103Q391 136 400 146Q409 155 433 155Q464 155 473 135Q475 130 475 78V46Q475 24 472 16T453 1H56Z" />
    <path
       id="MJX-68-TEX-M-1D7FC"
       d="M357 536Q357 546 318 546Q258 546 205 497T133 357V353L144 361Q210 402 285 402Q362 402 414 350Q479 285 479 193Q479 111 418 50T263 -11Q234 -11 207 -3T149 26T97 81T60 171T45 301Q45 444 129 533T319 622Q388 622 421 589T454 510Q454 491 442 475T402 458Q373 458 362 475T350 510Q350 520 354 528L357 536ZM319 326T269 326T179 298T136 223Q136 202 143 174T176 112T237 68Q246 66 265 66Q319 66 360 107Q395 146 395 197Q395 250 356 289Q319 326 269 326Z" />
    <path
       id="MJX-68-TEX-M-1D7FD"
       d="M204 -10Q162 -10 162 40Q162 146 198 261T310 477Q311 478 321 491T342 517T358 535H128V524Q128 506 119 497Q111 489 86 489H78Q55 489 46 508Q44 513 44 557V580Q44 605 52 616T88 627H93Q114 627 125 611H458Q474 598 477 593T480 573Q480 559 478 553T469 543T446 521T408 477Q252 290 246 49Q246 43 246 37T246 27T245 22Q243 11 233 1T204 -10Z" />
    <path
       id="MJX-68-TEX-M-1D6A2"
       d="M26 393Q26 417 37 424T80 431H134H217Q232 422 235 416T239 393Q239 379 236 371T226 360T214 356T197 355L179 354V353L188 330Q197 306 209 272T235 201T259 133T271 89V84L274 95Q279 122 298 185T335 300T352 354Q352 355 331 355Q312 355 304 358Q288 368 288 393Q288 408 291 415T310 431H478Q479 430 484 427T491 422T495 416T499 407T500 393Q500 376 493 367T479 357T458 355H452Q426 355 425 353Q420 337 351 124T280 -94Q240 -195 168 -220Q147 -228 125 -228Q89 -228 66 -201T42 -139Q42 -116 56 -102T93 -87Q117 -87 130 -102T144 -135V-138H126Q121 -148 121 -150T130 -152Q182 -147 207 -87Q211 -78 223 -40T236 1Q230 10 102 355H75L49 356Q26 363 26 393Z" />
    <path
       id="MJX-68-TEX-M-1D7FE"
       d="M58 460Q58 523 117 572T254 621Q290 621 298 620Q376 607 421 560T466 460Q466 441 460 424T443 393T421 370T397 352T374 340T357 332L350 330L356 328Q363 325 371 321T392 310T415 295T439 274T459 249T473 217T479 179Q479 102 418 46T262 -10T106 46T45 179Q45 202 52 222T70 257T96 284T123 305T148 319T167 328L174 330L170 332Q166 333 159 336T145 343Q104 362 81 393T58 460ZM382 458Q382 491 349 518T263 546Q215 546 179 521T142 458Q142 421 178 395T262 368Q315 368 348 396T382 458ZM396 178Q396 223 358 257T263 292Q206 292 167 258T128 178Q128 137 163 102T262 66Q324 66 360 101T396 178Z" />
    <path
       id="MJX-68-TEX-M-1D7FF"
       d="M392 259Q333 210 236 210H233Q163 210 109 262Q46 325 46 411T99 550Q164 622 264 622Q293 622 319 615T376 587T428 532T464 440T479 304Q479 167 400 78T217 -11Q140 -11 105 22T70 101Q70 124 84 138T122 153Q150 153 162 137T174 101Q174 91 168 76Q179 65 216 65Q267 65 300 93Q322 109 339 130T366 173T380 210T388 242T392 259ZM388 389Q388 438 357 492T268 546T185 520Q129 479 129 415Q129 384 138 363Q145 349 156 334T195 302T255 285Q305 285 345 313T388 389Z" />
  </defs>
  <g
     data-mml-node="math"
     id="g1303"
     transform="matrix(1,0,0,-1,-2568.9982,0)"
     style="fill:#000000;stroke:#000000;stroke-width:0">
    <g
       data-mml-node="mstyle"
       id="g857">
      <g
         data-mml-node="mspace"
         id="g855" />
    </g>
    <g
       data-mml-node="mstyle"
       transform="translate(2000)"
       id="g861">
      <g
         data-mml-node="mspace"
         id="g859" />
    </g>
    <g
       data-mml-node="xypic"
       data-cmd-id="0"
       data-text-mml-ids="[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]"
       transform="translate(4000)"
       id="g1301">
      <g
         fill="none"
         stroke="currentColor"
         stroke-linecap="round"
         stroke-width="0.64"
         transform="matrix(62.5,0,0,-62.5,4101.5,250)"
         id="g987">
        <rect
           x="-8"
           y="-8"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect863" />
        <rect
           x="8"
           y="-8"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect865" />
        <rect
           x="162.88"
           y="-8"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect867" />
        <rect
           x="178.88"
           y="-8"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect869" />
        <line
           x1="16"
           y1="0"
           x2="162.88"
           y2="0"
           stroke-dasharray="none"
           id="line871" />
        <g
           transform="translate(162.88)"
           id="g877">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path873" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path875" />
        </g>
        <g
           transform="translate(0,-10.25)"
           id="g879" />
        <rect
           x="333.76001"
           y="-8"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect881" />
        <rect
           x="349.76001"
           y="-8"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect883" />
        <line
           x1="186.88"
           y1="0"
           x2="333.76001"
           y2="0"
           stroke-dasharray="none"
           id="line885" />
        <g
           transform="translate(333.76)"
           id="g891">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path887" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path889" />
        </g>
        <g
           transform="translate(0,-10.25)"
           id="g893" />
        <line
           x1="357.76001"
           y1="0"
           x2="450.72"
           y2="0"
           stroke-dasharray="none"
           id="line895" />
        <g
           transform="translate(450.72)"
           id="g901">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path897" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path899" />
        </g>
        <rect
           x="-8"
           y="38.400002"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect903" />
        <rect
           x="8"
           y="38.400002"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect905" />
        <line
           x1="0"
           y1="0"
           x2="0"
           y2="38.400002"
           stroke-dasharray="none"
           id="line907" />
        <g
           transform="rotate(90,-19.2,19.2)"
           id="g913">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path909" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path911" />
        </g>
        <line
           x1="0"
           y1="46.400002"
           x2="-32.720001"
           y2="79.120003"
           stroke-dasharray="none"
           id="line915" />
        <g
           transform="rotate(135,-32.809928,32.809827)"
           id="g921">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path917" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path919" />
        </g>
        <line
           x1="16"
           y1="46.400002"
           x2="48.720001"
           y2="79.120003"
           stroke-dasharray="none"
           id="line923" />
        <g
           transform="rotate(45,-71.209928,98.523882)"
           id="g929">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path925" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path927" />
        </g>
        <rect
           x="162.88"
           y="38.400002"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect931" />
        <rect
           x="178.88"
           y="38.400002"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect933" />
        <line
           x1="170.88"
           y1="0"
           x2="170.88"
           y2="38.400002"
           stroke-dasharray="none"
           id="line935" />
        <g
           transform="rotate(90,66.24,104.64)"
           id="g941">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path937" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path939" />
        </g>
        <line
           x1="170.88"
           y1="46.400002"
           x2="138.16"
           y2="79.120003"
           stroke-dasharray="none"
           id="line943" />
        <g
           transform="rotate(135,52.630072,68.200233)"
           id="g949">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path945" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path947" />
        </g>
        <line
           x1="186.88"
           y1="46.400002"
           x2="219.60001"
           y2="79.120003"
           stroke-dasharray="none"
           id="line951" />
        <g
           transform="rotate(45,14.230072,304.79429)"
           id="g957">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path953" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path955" />
        </g>
        <rect
           x="333.76001"
           y="38.400002"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect959" />
        <rect
           x="349.76001"
           y="38.400002"
           width="16"
           height="16"
           rx="0"
           stroke="currentColor"
           id="rect961" />
        <line
           x1="341.76001"
           y1="0"
           x2="341.76001"
           y2="38.400002"
           stroke-dasharray="none"
           id="line963" />
        <g
           transform="rotate(90,151.68,190.08)"
           id="g969">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path965" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path967" />
        </g>
        <line
           x1="341.76001"
           y1="46.400002"
           x2="309.87"
           y2="78.290001"
           stroke-dasharray="none"
           id="line971" />
        <g
           transform="rotate(135,138.07007,103.59064)"
           id="g977">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path973" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path975" />
        </g>
        <line
           x1="357.76001"
           y1="46.400002"
           x2="390.48001"
           y2="79.120003"
           stroke-dasharray="none"
           id="line979" />
        <g
           transform="rotate(45,99.670072,511.0647)"
           id="g985">
          <path
             d="M 0,0 Q -3.55,0.32 -7.82,2.35"
             id="path981" />
          <path
             d="M 0,0 Q -3.55,-0.32 -7.82,-2.35"
             id="path983" />
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="0"
         data-y="0"
         data-xypic-id="0"
         transform="translate(4101.5,250)"
         id="g997">
        <g
           data-mml-node="mstyle"
           id="g995">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g993">
            <g
               data-mml-node="mstyle"
               id="g991">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g989" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="1"
         data-y="0"
         data-xypic-id="1"
         transform="translate(5101.5,250)"
         id="g1007">
        <g
           data-mml-node="mstyle"
           id="g1005">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1003">
            <g
               data-mml-node="mstyle"
               id="g1001">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g999" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="10.68"
         data-y="0"
         data-xypic-id="2"
         transform="translate(14781.5,250)"
         id="g1017">
        <g
           data-mml-node="mstyle"
           id="g1015">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1013">
            <g
               data-mml-node="mstyle"
               id="g1011">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1009" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="11.68"
         data-y="0"
         data-xypic-id="3"
         transform="translate(15781.5,250)"
         id="g1027">
        <g
           data-mml-node="mstyle"
           id="g1025">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1023">
            <g
               data-mml-node="mstyle"
               id="g1021">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1019" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="4.396087952817069"
         data-y="-0.39919953083036164"
         data-xypic-id="4"
         transform="translate(8497.5,649.2)"
         id="g1049">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1047">
          <g
             data-mml-node="mtext"
             id="g1045">
            <use
               data-c="62"
               xlink:href="#MJX-68-TEX-N-62"
               id="use1029"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="61"
               xlink:href="#MJX-68-TEX-N-61"
               transform="translate(556)"
               id="use1031"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="63"
               xlink:href="#MJX-68-TEX-N-63"
               transform="translate(1056)"
               id="use1033"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="6B"
               xlink:href="#MJX-68-TEX-N-6B"
               transform="translate(1500)"
               id="use1035"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="62"
               xlink:href="#MJX-68-TEX-N-62"
               transform="translate(2028)"
               id="use1037"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="6F"
               xlink:href="#MJX-68-TEX-N-6F"
               transform="translate(2584)"
               id="use1039"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="6E"
               xlink:href="#MJX-68-TEX-N-6E"
               transform="translate(3084)"
               id="use1041"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="65"
               xlink:href="#MJX-68-TEX-N-65"
               transform="translate(3640)"
               id="use1043"
               x="0"
               y="0"
               width="100%"
               height="100%" />
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="21.36"
         data-y="0"
         data-xypic-id="5"
         transform="translate(25461.5,250)"
         id="g1059">
        <g
           data-mml-node="mstyle"
           id="g1057">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1055">
            <g
               data-mml-node="mstyle"
               id="g1053">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1051" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="22.36"
         data-y="0"
         data-xypic-id="6"
         transform="translate(26461.5,250)"
         id="g1069">
        <g
           data-mml-node="mstyle"
           id="g1067">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1065">
            <g
               data-mml-node="mstyle"
               id="g1063">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1061" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="15.076087952817069"
         data-y="-0.39919953083036164"
         data-xypic-id="7"
         transform="translate(19177.5,649.2)"
         id="g1091">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1089">
          <g
             data-mml-node="mtext"
             id="g1087">
            <use
               data-c="62"
               xlink:href="#MJX-68-TEX-N-62"
               id="use1071"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="61"
               xlink:href="#MJX-68-TEX-N-61"
               transform="translate(556)"
               id="use1073"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="63"
               xlink:href="#MJX-68-TEX-N-63"
               transform="translate(1056)"
               id="use1075"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="6B"
               xlink:href="#MJX-68-TEX-N-6B"
               transform="translate(1500)"
               id="use1077"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="62"
               xlink:href="#MJX-68-TEX-N-62"
               transform="translate(2028)"
               id="use1079"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="6F"
               xlink:href="#MJX-68-TEX-N-6F"
               transform="translate(2584)"
               id="use1081"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="6E"
               xlink:href="#MJX-68-TEX-N-6E"
               transform="translate(3084)"
               id="use1083"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="65"
               xlink:href="#MJX-68-TEX-N-65"
               transform="translate(3640)"
               id="use1085"
               x="0"
               y="0"
               width="100%"
               height="100%" />
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="28.33862675168815"
         data-y="0.24536605307173198"
         data-xypic-id="8"
         transform="translate(32440.1,4.6)"
         id="g1121">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1119">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1117">
            <g
               data-mml-node="mtext"
               id="g1115">
              <use
                 data-c="72"
                 xlink:href="#MJX-68-TEX-N-72"
                 id="use1093"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="65"
                 xlink:href="#MJX-68-TEX-N-65"
                 transform="translate(392)"
                 id="use1095"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="73"
                 xlink:href="#MJX-68-TEX-N-73"
                 transform="translate(836)"
                 id="use1097"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="74"
                 xlink:href="#MJX-68-TEX-N-74"
                 transform="translate(1230)"
                 id="use1099"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="20"
                 xlink:href="#MJX-68-TEX-N-20"
                 transform="translate(1619)"
                 id="use1101"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="6F"
                 xlink:href="#MJX-68-TEX-N-6F"
                 transform="translate(1869)"
                 id="use1103"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="66"
                 xlink:href="#MJX-68-TEX-N-66"
                 transform="translate(2369)"
                 id="use1105"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="20"
                 xlink:href="#MJX-68-TEX-N-20"
                 transform="translate(2675)"
                 id="use1107"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="65"
                 xlink:href="#MJX-68-TEX-N-65"
                 transform="translate(2925)"
                 id="use1109"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="6E"
                 xlink:href="#MJX-68-TEX-N-6E"
                 transform="translate(3369)"
                 id="use1111"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
              <use
                 data-c="76"
                 xlink:href="#MJX-68-TEX-N-76"
                 transform="translate(3925)"
                 id="use1113"
                 x="0"
                 y="0"
                 width="100%"
                 height="100%" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="1.6653345369377348e-16"
         data-y="2.9"
         data-xypic-id="9"
         transform="translate(4101.5,-2650)"
         id="g1131">
        <g
           data-mml-node="mstyle"
           id="g1129">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1127">
            <g
               data-mml-node="mstyle"
               id="g1125">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1123" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="1.0000000000000002"
         data-y="2.9"
         data-xypic-id="10"
         transform="translate(5101.5,-2650)"
         id="g1141">
        <g
           data-mml-node="mstyle"
           id="g1139">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1137">
            <g
               data-mml-node="mstyle"
               id="g1135">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1133" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="-3.7600403089594656"
         data-y="5.5771062735722685"
         data-xypic-id="11"
         transform="translate(341.4,-5327.1)"
         id="g1161">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1159">
          <g
             data-mml-node="mtext"
             id="g1157">
            <use
               data-c="28"
               xlink:href="#MJX-68-TEX-M-28"
               id="use1143"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D68A"
               xlink:href="#MJX-68-TEX-M-1D68A"
               transform="translate(525)"
               id="use1145"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="20"
               xlink:href="#MJX-68-TEX-M-20"
               transform="translate(1050)"
               id="use1147"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D68B"
               xlink:href="#MJX-68-TEX-M-1D68B"
               transform="translate(1575)"
               id="use1149"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="20"
               xlink:href="#MJX-68-TEX-M-20"
               transform="translate(2100)"
               id="use1151"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D68C"
               xlink:href="#MJX-68-TEX-M-1D68C"
               transform="translate(2625)"
               id="use1153"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="29"
               xlink:href="#MJX-68-TEX-M-29"
               transform="translate(3150)"
               id="use1155"
               x="0"
               y="0"
               width="100%"
               height="100%" />
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="1.6045762979144977"
         data-y="5.5771062735722685"
         data-xypic-id="12"
         transform="translate(5706,-5327.1)"
         id="g1187">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1185">
          <g
             data-mml-node="mtext"
             id="g1183">
            <use
               data-c="28"
               xlink:href="#MJX-68-TEX-M-28"
               id="use1163"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7F7"
               xlink:href="#MJX-68-TEX-M-1D7F7"
               transform="translate(525)"
               id="use1165"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7F7"
               xlink:href="#MJX-68-TEX-M-1D7F7"
               transform="translate(1050)"
               id="use1167"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="20"
               xlink:href="#MJX-68-TEX-M-20"
               transform="translate(1575)"
               id="use1169"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7F7"
               xlink:href="#MJX-68-TEX-M-1D7F7"
               transform="translate(2100)"
               id="use1171"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7F8"
               xlink:href="#MJX-68-TEX-M-1D7F8"
               transform="translate(2625)"
               id="use1173"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="20"
               xlink:href="#MJX-68-TEX-M-20"
               transform="translate(3150)"
               id="use1175"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7F7"
               xlink:href="#MJX-68-TEX-M-1D7F7"
               transform="translate(3675)"
               id="use1177"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7F9"
               xlink:href="#MJX-68-TEX-M-1D7F9"
               transform="translate(4200)"
               id="use1179"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="29"
               xlink:href="#MJX-68-TEX-M-29"
               transform="translate(4725)"
               id="use1181"
               x="0"
               y="0"
               width="100%"
               height="100%" />
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="10.68"
         data-y="2.9"
         data-xypic-id="13"
         transform="translate(14781.5,-2650)"
         id="g1197">
        <g
           data-mml-node="mstyle"
           id="g1195">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1193">
            <g
               data-mml-node="mstyle"
               id="g1191">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1189" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="11.68"
         data-y="2.9"
         data-xypic-id="14"
         transform="translate(15781.5,-2650)"
         id="g1207">
        <g
           data-mml-node="mstyle"
           id="g1205">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1203">
            <g
               data-mml-node="mstyle"
               id="g1201">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1199" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="7.291190751163471"
         data-y="5.5771062735722685"
         data-xypic-id="15"
         transform="translate(11392.7,-5327.1)"
         id="g1223">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1221">
          <g
             data-mml-node="mtext"
             id="g1219">
            <use
               data-c="28"
               xlink:href="#MJX-68-TEX-M-28"
               id="use1209"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D6A1"
               xlink:href="#MJX-68-TEX-M-1D6A1"
               transform="translate(525)"
               id="use1211"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="20"
               xlink:href="#MJX-68-TEX-M-20"
               transform="translate(1050)"
               id="use1213"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D6A3"
               xlink:href="#MJX-68-TEX-M-1D6A3"
               transform="translate(1575)"
               id="use1215"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="29"
               xlink:href="#MJX-68-TEX-M-29"
               transform="translate(2100)"
               id="use1217"
               x="0"
               y="0"
               width="100%"
               height="100%" />
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="12.841422888098903"
         data-y="5.5771062735722685"
         data-xypic-id="16"
         transform="translate(16942.9,-5327.1)"
         id="g1243">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1241">
          <g
             data-mml-node="mtext"
             id="g1239">
            <use
               data-c="28"
               xlink:href="#MJX-68-TEX-M-28"
               id="use1225"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7FC"
               xlink:href="#MJX-68-TEX-M-1D7FC"
               transform="translate(525)"
               id="use1227"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7FC"
               xlink:href="#MJX-68-TEX-M-1D7FC"
               transform="translate(1050)"
               id="use1229"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="20"
               xlink:href="#MJX-68-TEX-M-20"
               transform="translate(1575)"
               id="use1231"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7FD"
               xlink:href="#MJX-68-TEX-M-1D7FD"
               transform="translate(2100)"
               id="use1233"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7FD"
               xlink:href="#MJX-68-TEX-M-1D7FD"
               transform="translate(2625)"
               id="use1235"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="29"
               xlink:href="#MJX-68-TEX-M-29"
               transform="translate(3150)"
               id="use1237"
               x="0"
               y="0"
               width="100%"
               height="100%" />
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="21.36"
         data-y="2.9"
         data-xypic-id="17"
         transform="translate(25461.5,-2650)"
         id="g1253">
        <g
           data-mml-node="mstyle"
           id="g1251">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1249">
            <g
               data-mml-node="mstyle"
               id="g1247">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1245" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="22.36"
         data-y="2.9"
         data-xypic-id="18"
         transform="translate(26461.5,-2650)"
         id="g1263">
        <g
           data-mml-node="mstyle"
           id="g1261">
          <g
             data-mml-node="TeXAtom"
             data-mjx-texclass="ORD"
             id="g1259">
            <g
               data-mml-node="mstyle"
               id="g1257">
              <g
                 data-mml-node="TeXAtom"
                 data-mjx-texclass="ORD"
                 id="g1255" />
            </g>
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="17.97119075116347"
         data-y="5.52548747854565"
         data-xypic-id="19"
         transform="translate(22072.7,-5275.5)"
         id="g1279">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1277">
          <g
             data-mml-node="mtext"
             id="g1275">
            <use
               data-c="28"
               xlink:href="#MJX-68-TEX-M-28"
               id="use1265"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D6A1"
               xlink:href="#MJX-68-TEX-M-1D6A1"
               transform="translate(525)"
               id="use1267"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="20"
               xlink:href="#MJX-68-TEX-M-20"
               transform="translate(1050)"
               id="use1269"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D6A2"
               xlink:href="#MJX-68-TEX-M-1D6A2"
               transform="translate(1575)"
               id="use1271"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="29"
               xlink:href="#MJX-68-TEX-M-29"
               transform="translate(2100)"
               id="use1273"
               x="0"
               y="0"
               width="100%"
               height="100%" />
          </g>
        </g>
      </g>
      <g
         stroke="currentColor"
         fill="currentColor"
         data-x="23.521422888098904"
         data-y="5.5771062735722685"
         data-xypic-id="20"
         transform="translate(27622.9,-5327.1)"
         id="g1299">
        <g
           data-mml-node="mstyle"
           transform="scale(0.707)"
           id="g1297">
          <g
             data-mml-node="mtext"
             id="g1295">
            <use
               data-c="28"
               xlink:href="#MJX-68-TEX-M-28"
               id="use1281"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7FE"
               xlink:href="#MJX-68-TEX-M-1D7FE"
               transform="translate(525)"
               id="use1283"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7FE"
               xlink:href="#MJX-68-TEX-M-1D7FE"
               transform="translate(1050)"
               id="use1285"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="20"
               xlink:href="#MJX-68-TEX-M-20"
               transform="translate(1575)"
               id="use1287"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7FF"
               xlink:href="#MJX-68-TEX-M-1D7FF"
               transform="translate(2100)"
               id="use1289"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="1D7FF"
               xlink:href="#MJX-68-TEX-M-1D7FF"
               transform="translate(2625)"
               id="use1291"
               x="0"
               y="0"
               width="100%"
               height="100%" />
            <use
               data-c="29"
               xlink:href="#MJX-68-TEX-M-29"
               transform="translate(3150)"
               id="use1293"
               x="0"
               y="0"
               width="100%"
               height="100%" />
          </g>
        </g>
      </g>
    </g>
  </g>
</svg>

  </div>
  <style>
    .svg-container {
      display: inline-block;
      width: 100%;
      max-width: 100%;
      height: auto;
      overflow-x: auto;
      overflow-y: hidden;
    }
    .svg-container svg {
      width: auto;
      height: auto;
      
      
    }
  </style>

<p>该表示法称作是<strong>肋排 ribcage</strong> 表示法 , 环境由名为<strong>肋骨 rib</strong> 的有序对列表表示 , 每根左肋指向
变量列表而右肋则指向变量列表对应的值的列表 。</p>
<h3 class="heading-element" id="S2.2.3"><span>2.2.3 过程表示法</span>
  <a href="#S2.2.3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>注意到环境接口有一个重要性质 : 它的观测器只有一个 , 即 <code>apply-env</code>  。
这意味着仅利用以变量为实参并返回绑定值的 Scheme 过程便可以表示环境 。</p>
<p>若要使用此方式表示环境则 <code>empty-env</code> 和 <code>extend-env</code> 就应该返回一个过程 :
这个过程在被调用时行为将和<a href="#G2.1">上一节提到的 <code>apply-env</code></a> 一样 。
如此我们便可得出下述实现 :</p>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="c1">;; Env = Var -&gt; SchemeVal</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; empty-env : () -&gt; Env</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">empty-env</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">search-var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">report-no-binding-found</span> <span class="nv">search-var</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; extend-env : Var × SchemeVal × Env → Env</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">extend-env</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">saved-var</span> <span class="nv">saved-val</span> <span class="nv">saved-env</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">search-var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eqv? </span><span class="nv">search-var</span> <span class="nv">saved-var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="nv">saved-val</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">apply-env</span> <span class="nv">saved-env</span> <span class="nv">search-var</span><span class="p">)))))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">;; apply-env : Env × Var → SchemeVal</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">apply-env</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">env</span> <span class="nv">search-var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">env</span> <span class="nv">search-var</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>如果空环境由 <code>empty-env</code> 所创建且被传入了任何可能的参数 , 那么该环境便会抛出错误并
指明给定的变量不位于该环境中 。过程 <code>extend-env</code> 返回的过程则是代表了被扩充的环境 :
若该环境被传入变量 <code>search-var</code>  则该环境会检查该变量是否与环境中已绑定的变量相同 :
如果是则返回保存的值 , 否则则在已保存的环境中查找它 。</p>
<p>上述表示法称作<strong>过程表示法 procedual representation</strong> , 其中的数据皆被表示为 <code>apply-env</code>
所执行的动作 。</p>
<p>只有一个观测器的数据类型并非大家所想的那般罕见 , 如 : 当数据被表示为一组函数时 , 那么
它们就可以用自身被应用的这个动作作为表示 。这种情况下可以遵循下述步骤提取出对应的
接口以及对应过程的表示 :</p>
<ol>
<li>找出用户代码中那些返回结果类型为指定类型的 $\texttt{lambda}$ 演算表达式 , 并为每个这样的
$\texttt{lambda}$ 演算表达式都写一个构造器过程 :   构造器过程接收的参数将会是 $\texttt{lambda}$ 演算
表达式中的自由变量 。在用户代码中用构造器调用替换对应的 $\texttt{lambda}$ 演算表达式 。</li>
<li>像定义 <code>apply-env</code> 那样去定义一个 <code>apply-</code> 过程 。找出用户代码中所有有用到指定
类型值的地方 , 包括构造器过程的主体 。所有用到指定类型值的地方都改用  <code>apply-</code> 过程 。</li>
</ol>
<p>一旦完成上面的步骤 , 那么接口将只含构造器过程以及 <code>apply-</code> 过程 , 并且用户代码将会是
表示无关的 : 它将不再依赖表示 , 我们可以随意换用其他接口的实现 —— 正如 <a href="S2.2.2">2.2.2 节</a>所述 。</p>
<p>若用于实现的语言不支持高阶过程则得再做进一步处理 : 用数据结构表示法和解释器配方来
实现所需的接口 , 就像<a href="#G2.1">上一节</a>所描述的那样 。这样的操作叫做<strong>去函数化 defunctionalization</strong> ,
环境的各种不同的数据结构表示法都是去函数化的简单例子 。过程表示法与去函数化表示法
间的关系将会是本书反复出现的主题 。</p>
<p><div class="fi-row"><a id="Xer2.12"></a></div><strong>练习 2.12</strong> <code>[*]</code><br>
用过程表示法实现<a href="#Xer2.4">练习 2.4</a> 中的栈数据类型 。</p>
<p><div class="fi-row"><a id="Xer2.13"></a></div><strong>练习 2.13</strong> <code>[**]</code><br>
扩展过程表示法以实现 <code>empty-env?</code> —— 利用两个过程组成的列表来表示环境 :
一个过程像前面那样返回变量所对应的绑定值 , 另一个则判断环境是否为空环境 。</p>
<p><div class="fi-row"><a id="Xer2.14"></a></div><strong>练习 2.14</strong> <code>[**]</code><br>
扩展上题中的表示法 , 加入第三个过程并用它实现 <code>has-binding?</code> ( 见<a href="#Xer2.9">练习 2.9</a> ) 。</p>
<h2 class="heading-element" id="S2.3"><span>2.3 递归数据类型的接口</span>
  <a href="#S2.3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>第一章我们都在操纵递归数据类型 , 比如 : 在<a href="/posts/5cce8df/#Def1.1.8">定义 1.1.8</a> 给出了 $\texttt{lambda}$ 演算表达式的语法 :</p>
<p>$\qquad \begin{aligned}[t]
\LcExp   ::={}& 
\Iden \\ ::={}&
\texttt{(lambda (\Iden) \LcExp)} \\::={}&
\texttt{(\LcExp  \LcExp)}
\end{aligned}$</p>
<p>并且还给出了如 <code>occurs-free?</code> 这样的过程 。正如当时所述 , <a href="/posts/5cce8df/#S1.2.4">1.2.4 节</a>的 <code>occurs-free?</code>
的定义可能并非那么易懂 , 如 : 我们很难猜到 <code>(car (cadr exp))</code> 指代的是 $\texttt{lambda}$ 演算
表达式的变量声明 , 以及 <code>(caddr exp)</code> 指代的是 $\texttt{lambda}$ 演算表达式的主体 , 等等 。</p>
<p>我们可通过为 $\texttt{lambda}$ 演算表达式添加一套接口以改善这种现状 : 我们的接口将会有一系列
构造器以及两种观测器 : <strong>谓词 predicate</strong> 和<strong>提取器 extractor</strong> 。</p>
<p>构造器有 :</p>
<p>$\qquad\begin{aligned}[t]
&\texttt{var-exp}
&{}:{}
&\Var\to \LcExp 
\\
&\texttt{lambda-exp}
&{}:{}
&\Var\times\LcExp \to \LcExp
\\
&\texttt{app-exp}
&{}:{}
&\LcExp\times\LcExp \to \LcExp
\end{aligned}$</p>
<p>谓词有 :</p>
<p>$\qquad\begin{aligned}[t]
&\texttt{var-exp?}
&{}:{}
&\LcExp \to \Bool
\\
&\texttt{lambda-exp?}
&{}:{}
&\LcExp \to \Bool
\\
&\texttt{app-exp?}
&{}:{}
&\LcExp \to \Bool
\end{aligned}$</p>
<p>最后 , 提取器有 :</p>
<p>$\qquad\begin{aligned}[t]
&\texttt{var-exp->var}
&{}:{}
&\LcExp \to \Var
\\
&\texttt{lambda-exp->bound-var}
&{}:{}
&\LcExp \to \Var
\\
&\texttt{lambda-exp->body}
&{}:{}
&\LcExp \to \LcExp
\\
&\texttt{app-exp->rator}
&{}:{}
&\LcExp \to \LcExp
\\
&\texttt{app-exp->rand}
&{}:{}
&\LcExp \to \LcExp
\end{aligned}$</p>
<p>各个提取器对应 $\texttt{lambda}$ 演算表达式中的各个组成部分 。
我们现在可以写出一个仅依赖接口的 <code>occurs-free?</code> :<div class="fi-row"><a id="S2.3-occurs-free"></a></div></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="c1">;; occurs-free? : Sym × LcExp -&gt; Bool</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">occurs-free?</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">search-var</span> <span class="nv">exp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">cond </span><span class="p">[(</span><span class="nf">var-exp?</span> <span class="nv">exp</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nb">eqv? </span><span class="nv">search-var</span> <span class="p">(</span><span class="nf">var-exp-&gt;var</span> <span class="nv">exp</span><span class="p">))]</span>
</span></span><span class="line"><span class="cl">          <span class="p">[(</span><span class="nf">lambda-exp?</span> <span class="nv">exp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">eqv? </span><span class="nv">search-var</span> <span class="p">(</span><span class="nf">lambda-exp-&gt;bound-var</span> <span class="nv">exp</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="p">(</span><span class="nf">lambda-exp-&gt;body</span> <span class="nv">exp</span><span class="p">)))]</span>
</span></span><span class="line"><span class="cl">          <span class="p">[</span><span class="nv">else</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="p">(</span><span class="nf">app-exp-&gt;rator</span> <span class="nv">exp</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="p">(</span><span class="nf">app-exp-&gt;rand</span>  <span class="nv">exp</span><span class="p">)))])))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这对任何的 $\texttt{lambda}$ 演算表达式的表示法都行得通 —— 只要它们是通过上述构造器构建的 。</p>
<p>我们可以写出设计递归数据类型接口的通用步骤 :</p>
<blockquote>
<p><strong>为递归数据类型设计接口</strong></p>
<ol>
<li>为数据类型的每种变体添加一个构造器 。</li>
<li>为数据类型的每种变体添加一个谓词 。</li>
<li>为每段传入数据类型构造器的数据都添加一个提取器 。</li>
</ol></blockquote>
<p><div class="fi-row"><a id="Xer2.15"></a></div><strong>练习 2.15</strong> <code>[*]</code><br>
请实现上述 $\texttt{lambda}$ 演算表达式表示法的各个接口 。</p>
<p><div class="fi-row"><a id="Xer2.16"></a></div><strong>练习 2.16</strong> <code>[*]</code><br>
修改实现以使其适用于另一种表示法 —— 其中 $\texttt{lambda}$ 演算表达式中绑定变量周围不带括号 。</p>
<p><div class="fi-row"><a id="Xer2.17"></a></div><strong>练习 2.17</strong> <code>[*]</code><br>
请发明至少两种表示法来呈现 $\LcExp$ 数据类型并实现它们 。</p>
<p><div class="fi-row"><a id="Xer2.18"></a></div><strong>练习 2.18</strong> <code>[*]</code><br>
我们通常将值的序列呈现为列表 , 如此允许我们轻松地从序列的一个元素移动到下一个元素 ;
但是若不借助语境参数我们很难实现上述操作 。请实现非空的双向整数序列 , 对应的语法为</p>
<p>$\qquad \begin{aligned}[t]\NodeInSeq ::={}& \texttt{(\Int  \ListOf{\Int} \ListOf{\Int})}\end{aligned}$</p>
<p>第一个整数列表是当前元素之前的序列 , 反向排列 ; 第二个列表是当前元素之后的序列 。例 :
<code>(6 (5 4 3 2 1) (7 8 9))</code> 表示列表 <code>(1 2 3 4 5 6 7 8 9)</code> , 当前元素为 <code>6</code> 。</p>
<p>对于此表示法 , 请实现过程 <code>number-&gt;sequence</code> —— 它取一数字并生成只含该数字的序列 。
然后再实现 <code>current-element</code> , <code>move-to-left</code> ,  <code>move-to-right</code> , <code>insert-to-left</code> ,
<code>insert-to-right</code> , <code>at-left-end?</code> , <code>at-right-end?</code> 。</p>
<p>例如 :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">number-&gt;sequence</span> <span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">7</span> <span class="p">()</span> <span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">current-element</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">6</span> <span class="p">(</span><span class="mi">5</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">move-to-left</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">6</span> <span class="p">(</span><span class="mi">5</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">5</span> <span class="p">(</span><span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">insert-to-left</span>  <span class="mi">13</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">6</span> <span class="p">(</span><span class="mi">5</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">6</span> <span class="p">(</span><span class="mi">13</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">insert-to-right</span> <span class="mi">13</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">6</span> <span class="p">(</span><span class="mi">5</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">6</span> <span class="p">(</span><span class="mi">5</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">13</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>如果参数在序列的最右端那么过程 <code>move-to-right</code> 应失败 ;
如果参数在序列的最左端那么过程 <code>move-to-left</code> 应失败 。</p>
<p><div class="fi-row"><a id="Xer2.19"></a></div><strong>练习 2.19</strong> <code>[*]</code><br>
无叶节点的二叉树以及非叶节点全被整数标记的二叉树可表示为下述递归语法</p>
<p>$\qquad \begin{aligned}[t]
\BinSearchTree ::={}& \texttt{()} \mid \texttt{(\Int  \BinSearchTree  \BinSearchTree)}
\end{aligned}$</p>
<p>对于此表示法 , 请实现过程 <code>number-&gt;bintree</code> —— 其取一个整数并产生一颗新的二叉树 ,
该树的唯一节点被该数字标记 ; 接着实现 <code>current-element</code> , <code>move-to-left-son</code> 以及
<code>move-to-right-son</code> , <code>at-leaf?</code> , <code>insert-to-left</code> 和 <code>insert-to-right</code> 。例如：</p>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">number-&gt;bintree</span> <span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">13</span> <span class="p">()</span> <span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="k">define </span><span class="nv">t1</span> <span class="p">(</span><span class="nf">insert-to-right</span> <span class="mi">14</span> 
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nf">insert-to-left</span> <span class="mi">12</span> 
</span></span><span class="line"><span class="cl">              	<span class="p">(</span><span class="nf">insert-to-left</span> <span class="mi">13</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="nv">t1</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">13</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">12</span> <span class="p">()</span> <span class="p">())</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">14</span> <span class="p">()</span> <span class="p">()))</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">move-to-left</span> <span class="nv">t1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">12</span> <span class="p">()</span> <span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">current-element</span> <span class="p">(</span><span class="nf">move-to-left</span> <span class="nv">t1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">at-leaf?</span> <span class="p">(</span><span class="nf">move-to-right</span> <span class="p">(</span><span class="nf">move-to-left</span> <span class="nv">t1</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="no">#t</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">insert-to-left</span> <span class="mi">15</span> <span class="nv">t1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">13</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">15</span> <span class="p">(</span><span class="mi">12</span> <span class="p">()</span> <span class="p">())</span>  <span class="p">())</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="mi">14</span> <span class="p">()</span> <span class="p">()))</span></span></span></code></pre></td></tr></table>
</div>
</div><p><div class="fi-row"><a id="Xer2.20"></a></div><strong>练习 2.20</strong> <code>[***]</code><br>
在<a href="#Xer2.18">上一道练习</a>的二叉树中我们很容易从父节点移动到某个子节点 ; 但若无语境参数的辅助
无法从子节点移动到父节点 。请扩展<a href="#Xer2.18">练习 2.18</a> 中的列表表示法使其表示二叉树中的节点 。
提示 : 二叉树中当前节点上方的部分可以考虑试着用逆序列表来表示 , 正如<a href="#Xer2.18">练习 2.18</a> 那样 。</p>
<p>对于此表示法 , 请实现<a href="#Xer2.19">练习 2.19</a> 中的过程 , 然后实现 <code>move-up</code> , <code>at-root?</code> 及 <code>at-leaf?</code> 。</p>
<h2 class="heading-element" id="2.4"><span>2.4 一个定义递归数据类型的工具</span>
  <a href="#2.4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>对复杂的数据类型应用上述步骤设计接口很容易让人疲乏 。本节将我们将引入一个工具
用于自动构建和实现诸如上述 Scheme 接口 : 该工具生成的接口虽然与上一节的非常相似 ,
但它们并非完全一致 。</p>
<p>同样考虑<a href="#S2.3">上一节的 $\texttt{lambda}$ 演算表达式数据类型</a> , 我们可以如下实现 $\texttt{lambda}$ 演算表达式
类型的接口 : <div class="fi-row"><a id="S2.4-lc-exp"></a></div></p>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">define-datatype</span> <span class="nv">lc-exp</span> <span class="nv">lc-exp?</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nf">var-exp</span>
</span></span><span class="line"><span class="cl">    	<span class="p">(</span><span class="nf">var</span> <span class="nv">identifier?</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nf">lambda-exp</span>
</span></span><span class="line"><span class="cl">    	<span class="p">(</span><span class="nf">bound-var</span> <span class="nv">identifier?</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    	<span class="p">(</span><span class="nf">body</span>      <span class="nv">lc-exp?</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nf">app-exp</span>
</span></span><span class="line"><span class="cl">    	<span class="p">(</span><span class="nf">rator</span> <span class="nv">lc-exp?</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    	<span class="p">(</span><span class="nf">rand</span>  <span class="nv">lc-exp?</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里的 <code>var-exp</code> , <code>var</code> , <code>bound-var</code> , <code>app-exp</code> , <code>rator</code> 以及 <code>rand</code> 分别为下述单词
的缩写 : <strong>变量表达式 variable expression</strong> , <strong>变量 variable</strong> , <strong>绑定变量 bound variable</strong> , 以及
<strong>应用表达式 application expression</strong> , <strong>操作符 operator</strong> 以及<strong>操作数 operand</strong> 。</p>
<p>该表示法声明了三种构造器 : <code>var-exp</code> , <code>lambda-exp</code> , <code>app-exp</code> 及一个谓词 <code>lc-exp?</code> 。
三个构造器用谓词 <code>identifier?</code> 和 <code>lc-exp?</code> 以实现对实参合法性的检查 , 故若 $\LcExp$
仅通过这几个构造器构建 , 我们就可确保其及其所有子表达式都是合法的 $\LcExp$ 。这允许
我们在处理 $\texttt{lambda}$ 演算表达式时跳过许多检查 。</p>
<p>相较于各种谓词和提词器 , 我们还是采用 <code>cases</code> 形式来判断数据类型的实例属于哪种变体
并提取出它们的组件 。为解释该形式 ,
我们将用 $\LcExp$ 数据类型重写<a href="#S2.3-occurs-free">过程 <code>occurs-free?</code> (
代码在第 43 页</a> ) :</p>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="c1">;; occurs-free? : Sym × LcExp -&gt; Bool</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">occurs-free?</span> 
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">search-var</span> <span class="nv">exp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">cases</span> <span class="nv">lc-exp</span> <span class="nv">exp</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">var-exp</span> <span class="p">(</span><span class="nf">var</span><span class="p">)</span> <span class="p">(</span><span class="nb">eqv? </span><span class="nv">var</span> <span class="nv">search-var</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">lambda-exp</span> <span class="p">(</span><span class="nf">bound-var</span> <span class="nv">body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                       <span class="p">(</span><span class="nf">and</span>
</span></span><span class="line"><span class="cl">                        <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">eqv? </span><span class="nv">search-var</span> <span class="nv">bound-var</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                        <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">body</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">app-exp</span> <span class="p">(</span><span class="nf">rator</span> <span class="nv">rand</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">(</span><span class="nf">or</span>
</span></span><span class="line"><span class="cl">                     <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">rator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                     <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">rand</span><span class="p">))))))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>要明白这一切 , 需假设 <code>exp</code> 是个由 <code>app-exp</code> 构建的 $\texttt{lambda}$ 演算表达式 :  对于这样的
<code>exp</code> 的值 , 分支 <code>app-exp</code> 将被选中并且 <code>rator</code> 和 <code>rand</code> 则会被绑定到两个子表达式 ;
紧接着表达式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">or</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">rator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">rand</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>将会被求值 , 就如同代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">app-exp?</span> <span class="nv">exp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">rator</span> <span class="p">(</span><span class="nf">app-exp-&gt;rator</span> <span class="nv">exp</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">rand</span> <span class="p">(</span><span class="nf">app-exp-&gt;rand</span> <span class="nv">exp</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">or</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">rator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">rand</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>最后 <code>occurs-free?</code> 的递归调用也将以类似的方式完成计算 。</p>
<p>一般情况下 <code>define-datatype</code> 声明具有如下形式 :<div class="fi-row"><a id="S2.4-define-datatype"></a></div></p>
<p>$\qquad 
\begin{aligned}[t]
\texttt{(define-datatype \textit{type-name} \textit{type-predicate-name}}\\
\texttt{${\texttt{(\textit{variant-name}
$\{\texttt{(\textit{field-name ~predicate})}\}^*$
)}}^+$)}
\end{aligned}$</p>
<p>这便定义了一种名为 $\textit{type-name}$ 的数据类型 , 它有一些<strong>变体 variant</strong> : 每个变体有变体名
以及 $0$ 或多个字段 , 每个字段都有相应的字段名及谓词 。任两个类型都不允许同名并且
任两个变体都不允许同名 —— 即便它们可能属于同一个类型 。类型名不可被用作变体名 。
每个字段的谓词必须是一个 Scheme 谓词 。</p>
<p>对每个变体都会有一个新的构造器被创建 , 其将用于创建该变体下的项 。如果一个变体
有 $n$ 个字段那么它的构造器将取 $n$ 个实参 , 将它们分别交给对应的谓词进行处理并返回
变体值 —— 值的第 $i$ 个字段为第 $i$ 个参数值 。</p>
<p>$\textit{type-predicate-name}$ 被绑定到一个谓词上 。该谓词判断实参的值是否属于相应的类型 。</p>
<p><strong>记录表 record</strong> 为仅含有单种变体的数据类型 。为了区分这种只含单种变体的数据类型
我们将遵循下述惯例 : 若只有一个变体则以 $\texttt{a-}\textit{type-name}$ 或 $\texttt{an-}\textit{type-name}$ 命名构造器 ,
否则将以 $\textit{variant-name-type-name}$ 命名构造器 。</p>
<p>通过 <code>define-datatype</code> 生成的数据结构可能是互为递归的 , 如 <a href="/posts/5cce8df/#Def1.1.6">1.1 节提到的 $\SList$</a> :</p>
<p>$\qquad\begin{aligned}[t]
\SList ::={}& \texttt{(${\SExp}^*$)} \\
\SExp  ::={}& \Symbol \mid \SList
\end{aligned}$</p>
<p>$\SList$ 中的数据可通过数据类型 <code>s-list</code> 如下表示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">define-datatype</span> <span class="nv">s-list</span> <span class="nv">s-list?</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">empty-s-list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">non-empty-s-list</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">first</span> <span class="nv">s-exp?</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">rest</span>  <span class="nv">s-list?</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nf">define-datatype</span> <span class="nv">s-exp</span> <span class="nv">s-exp?</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">symbol-s-exp</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">sym</span> <span class="nv">symbol?</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">s-list-s-exp</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">slst</span> <span class="nv">s-list?</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>数据类型 <code>s-list</code> 通过 <code>(empty-s-list)</code> 和 <code>non-empty-s-list</code> 而非 <code>()</code> 和 <code>cons</code>
来实现自己特有的列表表示方式 。如果我们依然想用 Scheme 列表表示 , 那么可以写成</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">define-datatype</span> <span class="nv">s-list</span> <span class="nv">s-list?</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">an-s-list</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">sexps</span> <span class="p">(</span><span class="nf">list-of</span> <span class="nv">s-exp?</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">list-of</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pred</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">null? </span><span class="nv">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nf">pred</span> <span class="p">(</span><span class="nb">car </span><span class="nv">val</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">               <span class="p">((</span><span class="nf">list-of</span> <span class="nv">pred</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">val</span><span class="p">)))))))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里 $\texttt{(list-of \textit{pred})}$ 将生成一个谓词 , 该谓词用来检查实参是否构成一个列表 , 并且
列表每个元素是否都满足 $\textit{pred}$ 。</p>
<p><code>cases</code> 语法的一般形式为</p>
<p>$\qquad
\begin{aligned}[t]
&\texttt{(cases \textit{type-name} \textit{expression}}\\
&\texttt{\ \ \(\{\texttt{(}\textit{variant-name}\ \,\texttt{(}\{\textit{field-name}\}^*\texttt{)}\ \,\textit{consequent}\texttt{)}\}^*\)} \\
&\texttt{\ \ (else \textit{default}))}
\end{aligned}$</p>
<p>该形式声明类型 , 一个待求值待检查的表达式以及一些语句 ; 每个语句都以指定类型的
某一变体名以及相应字段名作为标识 。<code>else</code> 语句可省略 。首先 $\textit{expression}$ 会被求值 ,
如此便得到 $\textit{type-name}$ 的某个值 $v$ ; 如果 $v$ 对应于名为 $\textit{variant-name}$ 的变体 , 那么就
选中对应的语句 。各个 $\textit{field-name}$ 会被绑定到 $v$ 中对应的字段值 。此后 $\textit{consequent}$
的值会在这些绑定的作用域内求值并被返回 。若 $v$ 不属于任何变体且出现 <code>else</code> 语句
则求取并返回 $\textit{de\!fault}$ 的值 ; 若没有 <code>else</code> 语句则必须为指定数据类型的每一个变体都
指定一个语句 。</p>
<p><code>cases</code> 形式根据位置绑定变量 : 第 $i$ 个变量绑定到第 $i$ 个字段 ; 因此我们就可以这样写</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">app-exp</span> <span class="p">(</span><span class="nf">exp1</span> <span class="nv">exp2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">or</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">exp1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">exp2</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>而不是这样</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">app-exp</span> <span class="p">(</span><span class="nf">rator</span> <span class="nv">rand</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">or</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">rator</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">occurs-free?</span> <span class="nv">search-var</span> <span class="nv">rand</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>define-datatype</code> 和 <code>cases</code> 形式提供了一种简洁的方式来定义递归数据类型 , 但
但这种方式并不是唯一的 。其他应用场景可能需要更专门的表示方式 : 它们更紧凑且
更高效 , 可以利用上数据的特殊性质 。这些优势的代价是必须手动实现接口中的过程 。</p>
<p><code>define-datatype</code> 形式是<strong>领域特定语言 domain-specific language</strong> 的其中一个例子 。
此种语言是一种小巧的语言 , 用于描述一系列小而明确的任务中的单一任务 。本例中
我们的任务是定义一种递归数据类型 。这种语言可能存在于用途更广泛的语言中 , 就
如同 <code>define-datatype</code> 一样 ; 也有可能是独自构成一门单独的语言 , 别有一套工具 。
一般来说创造这类语言首先需找出任务的各种变体 , 然后再设计语言并描述这些变体 。
这种策略通常非常有效 。</p>
<p><div class="fi-row"><a id="Xer2.21"></a></div><strong>练习 2.21</strong> <code>[*]</code><br>
请用 <code>define-datatype</code> 实现如 <a href="#G2.1">2.2.2 节中提到的环境数据类型</a> ,
然后实现<a href="#Xer2.9">练习 2.9 中的 <code>has-binding?</code></a> 。</p>
<p><div class="fi-row"><a id="Xer2.22"></a></div><strong>练习 2.22</strong> <code>[*]</code><br>
请用 <code>define-datatype</code> 实现<a href="#Xer2.4">练习 2.4 中的栈数据类型</a> 。</p>
<p><div class="fi-row"><a id="Xer2.23"></a></div><strong>练习 2.23</strong> <code>[*]</code><br>
<code>lc-exp</code> 的定义忽略了<a href="/posts/5cce8df/#Def1.1.8">定义 1.1.8</a> 中的要求 : &quot; $\Iden$ 表示任何非 $\texttt{lambda}$ 的符号 &quot; ;
修改 <code>identifier?</code> 的定义以满足这一需求 。提示 : 任何谓词 ( 包括你自己定义的 ) ,
都可以在 <code>define-datatype</code> 中使用 。</p>
<p><div class="fi-row"><a id="Xer2.24"></a></div><strong>练习 2.24</strong> <code>[*]</code><br>
下面是用 <code>define-datatype</code> 表示的二叉树 :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">define-datatype</span> <span class="nv">bintree</span> <span class="nv">bintree?</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">leaf-node</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">num</span> <span class="nv">integer?</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">interior-node</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">key</span> <span class="nv">symbol?</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">left</span> <span class="nv">bintree?</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">right</span> <span class="nv">bintree?</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>实现 <code>bintree-to-list</code> 以操作二叉树 , 如此 <code>(bintree-to-list (interior-node </code>
<code>'a (leaf-node 3) (leaf-node 4)))</code> 应返回列表</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">interior-node</span>
</span></span><span class="line"><span class="cl"> <span class="nv">a</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="nf">leaf-node</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="nf">leaf-node</span> <span class="mi">4</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div><p><div class="fi-row"><a id="Xer2.25"></a></div><strong>练习 2.25</strong> <code>[**]</code><br>
用 <code>cases</code> 写出 <code>max-interior</code> : 它以一个含至少一个非叶节点的整数二叉树 ( 如同上题 )
作为实参并返回叶节点标签之和最大的内部节点所对应的标签 。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="k">define </span><span class="nv">tree-1</span> <span class="p">(</span><span class="nf">interior-node</span> <span class="ss">&#39;foo</span> <span class="p">(</span><span class="nf">leaf-node</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">leaf-node</span> <span class="mi">3</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="k">define </span><span class="nv">tree-2</span> <span class="p">(</span><span class="nf">interior-node</span> <span class="ss">&#39;bar</span> <span class="p">(</span><span class="nf">leaf-node</span> <span class="mi">-1</span><span class="p">)</span> <span class="nv">tree-1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="k">define </span><span class="nv">tree-3</span> <span class="p">(</span><span class="nf">interior-node</span> <span class="ss">&#39;baz</span> <span class="nv">tree-2</span> <span class="p">(</span><span class="nf">leaf-node</span> <span class="mi">1</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">max-interior</span> <span class="nv">tree-2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">foo</span>
</span></span><span class="line"><span class="cl"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">max-interior</span> <span class="nv">tree-3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">baz</span></span></span></code></pre></td></tr></table>
</div>
</div><p>最后一次调用 <code>max-interior</code> 也可能返回 <code>foo</code>，因为 <code>foo</code> 和 <code>baz</code> 的叶节点之和都为 $5$ 。</p>
<p><div class="fi-row"><a id="Xer2.26"></a></div><strong>练习 2.26</strong> <code>[**]</code><br>
下面是<a href="/posts/5cce8df/#Xer1.33">练习 1.33</a> 的另一种版本 。考虑下述树的定义 :</p>
<p>$\qquad\begin{aligned}[t]
\RedBlueTree    &::={} \RedBlueSubtree \\
\RedBlueSubtree &::={} \texttt{(red-node \RedBlueSubtree  \RedBlueSubtree)} \\
                &::={} \texttt{(blue-node ${\RedBlueSubtree}^*$)} \\
                &::={} \texttt{(leaf-node \Int)}
\end{aligned}$</p>
<p>用 <code>define-datatype</code> 写出等价的定义并用所得到的接口写一个过程 : 它取一棵树并生成
形状相同的另一棵树 , 但是把每片叶子的值改为从当前叶子节点到树根之间红色节点的数目 。</p>
<h2 class="heading-element" id="S2.5"><span>2.5 抽象语法及其表示</span>
  <a href="#S2.5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>语法通常声明的是递归数据类型的某一具体表示 : 后者使用前者生成的字符串或值 。这样的
表示叫做<strong>具体语法 concrete syntax</strong> 或<strong>外在 external</strong> 表示 。</p>
<p>考虑<a href="/posts/5cce8df/#Def1.1.8">定义 1.1.8</a> 提到的所有 $\texttt{lambda}$ 演算表达式构成的集 :  这里用的就是 $\texttt{lambda}$ 演算表达式
的具体语法 。我们也可以用其他具体的语法来表示 $\texttt{lambda}$ 演算表达式 , 比如可以用</p>
<p>$\qquad \begin{aligned}[t]
\LcExp   ::={}& 
\Iden \\ ::={}&
\texttt{(proc \Iden  => \LcExp)} \\::={}&
\texttt{\LcExp  (\LcExp)}
\end{aligned}$</p>
<p>来将 $\texttt{lambda}$ 演算表达式定义为另一种不同的字符串集合 。</p>
<p>为了处理这样的数据 , 我们需要将其转换为<strong>内在 internal</strong> 表示 。<code>define-datatype</code> 形式便提供了一种简洁的方式来定义这样的内在表示 ,
这样的表示称作 <strong>abstract syntax</strong> 。
抽象语法中像括号这样的终结符不需要被储存 , 因为它们不传递信息 。
另一方面我们想确保数据结构可允许我们
判断其所代表的 $\texttt{lambda}$ 演算表达式并提取出各个部分 。
<a href="#S2.4-lc-exp">第 46 页提到的 <code>lc-exp</code></a>
数据类型可允许我们轻松实现上述需求 。</p>
<p>将内在表示可视化为<strong>抽象语法树 abstract syntax tree</strong> 是很有效的 。<a href="#G2.2">图 2.2</a> 是一棵抽象语法树 ,
对应于 <code>lc-exp</code> 类型下的 $\texttt{lambda}$ 演算表达式 <code>(lambda (x) (f (f x)))</code> 。抽象语法树中
每个非叶节点都被标注了对应的派生式的名称 , 每个枝干上都被标注了对应的非终结符的出现 ,
每个叶节点则对应于终结符 。</p>
<p>下方为图 2.2 —— <code>(lambda (x) (f (f x)))</code> 所对应的抽象语法树 。
$
%\qquad \begin{xy}0;p+/r1cm/:p+/d1cm/::
%(0,0)*+<10pt,0pt>[F-][=code]\texttt{lambda-exp}="t";
%"t";p+/r2cm/:p+/d2cm/::
%(-1,+1)*[code]{\texttt{x}\vphantom{\tt fg}}="t0";{\ar"t0"|{\texttt{bound-var}\vphantom{\tt fg}}};
%(+1,+1)*[code]{\texttt{app-exp}\vphantom{\tt fg}}="t1";{\ar"t1"|{\texttt{body}}};
%"t1";p+/r2cm/:p+/d2cm/::
%(-1,+1)*[code]{\texttt{var-exp}\vphantom{\tt fg}}="t10";{\ar"t10"|{\texttt{rator}}};
%(+1,+1)*[code]{\texttt{app-exp}\vphantom{\tt fg}}="t11";{\ar"t11"|{\texttt{rand}}};
%"t10";p+/r2cm/:p+/d2cm/::
%(+0,+1)*[code]{\texttt{f}\vphantom{\tt fg}}="t100";{\ar"t100"|{\texttt{var}}};
%"t11";p+/r2cm/:p+/d2cm/::
%(-1,+1)*[code]{\texttt{var-exp}\vphantom{\tt fg}}="t110";
%{\ar"t110"|{\texttt{rator}}};
%(+1,+1)*[code]{\texttt{var-exp}\vphantom{\tt fg}}="t111";{
%\ar"t111"|{\texttt{rand}}};
%"t110";p+/r2cm/:p+/d2cm/::
%(+0,+1)*[code]{\texttt{f}\vphantom{\tt fg}}="t1100";{\ar"t1100"|{\texttt{var}}};
%"t111";p+/r2cm/:p+/d2cm/::
%(+0,+1)*[code]{\texttt{x}\vphantom{\tt fg}}="t1110";{\ar"t1110"|{\texttt{var}}};
%\end{xy}
$ <div class="fi-row"><a id="G2.2"></a></div></p>




  <div class="svg-container">
    <svg style="vertical-align: -36.432ex;" xmlns="http://www.w3.org/2000/svg" width="48.371ex" height="38.731ex" role="img" focusable="false" viewBox="0 -1016 21380 17119" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><defs><path id="MJX-135-TEX-M-1D695" d="M51 573Q51 602 73 610H76Q79 610 84 610T97 610T113 610T133 611T155 611T179 611H282Q301 598 304 586V76H452Q466 67 470 60T474 38Q474 10 452 1H73Q51 9 51 32V38Q51 54 54 60T73 76H220V535H146L73 536Q51 545 51 567V573Z"></path><path id="MJX-135-TEX-M-1D68A" d="M126 306Q105 306 90 321T74 359Q74 439 211 439Q268 439 276 438Q343 426 383 390T430 306Q431 301 431 190V81Q446 79 465 78T492 76T509 72T521 60T524 38Q524 11 506 3Q502 1 466 1Q426 1 406 5T379 14T355 36L345 30Q284 -6 205 -6Q135 -6 92 39T48 141Q48 182 79 212T158 256T252 278T342 285H347V290Q347 315 325 335T267 362Q258 363 224 363Q189 363 185 362H179L178 358Q178 353 178 352T176 345T174 337T170 330T165 322T158 316T150 311T139 308T126 306ZM132 140Q132 115 157 93T224 70Q269 70 302 87T344 133Q346 139 347 175V211H339Q256 209 194 190T132 140Z"></path><path id="MJX-135-TEX-M-1D696" d="M133 76Q156 74 164 67T172 38Q172 9 151 1H11Q-12 8 -12 38Q-12 61 5 73Q10 75 28 76H45V355H28Q10 356 5 358Q-12 370 -12 393Q-12 419 11 431H52H70Q91 431 100 427T116 405Q163 436 200 436Q255 436 281 390L285 394Q289 398 292 400T301 407T314 415T329 423T346 429T366 434T389 436H392Q425 436 448 411Q469 390 474 360T480 268V232V203V76H497Q520 74 528 67T536 38Q536 9 515 1H396Q374 9 374 32V38Q374 73 402 76H409V191V242Q409 317 404 339T375 361Q343 361 323 332T299 264Q298 258 298 165V76H315Q338 74 346 67T354 38Q354 9 333 1H214Q192 9 192 32V38Q192 73 220 76H227V191V242Q227 317 222 339T193 361Q161 361 141 332T117 264Q116 258 116 165V76H133Z"></path><path id="MJX-135-TEX-M-1D68B" d="M4 573Q4 596 15 603T52 611H90H124Q146 611 155 608T171 591Q173 586 173 491V396L182 402Q217 424 256 431Q280 437 309 437Q376 437 434 379T492 217Q492 162 473 118T422 47T358 8T293 -6Q229 -6 174 38Q171 13 163 7T135 1H131H122Q99 1 90 23L89 279V535H58L27 536Q4 543 4 573ZM409 215Q409 269 377 315T283 361Q255 361 224 344T177 297L173 290V167Q189 124 213 97T278 70Q330 70 369 111T409 215Z"></path><path id="MJX-135-TEX-M-1D68D" d="M266 573Q266 596 277 603T314 611H352H385Q411 611 419 607T435 586V76H498Q512 67 516 60T520 38Q520 9 498 1H436Q429 1 417 1T398 0Q375 0 363 7T351 34V43L342 36Q288 -6 223 -6Q143 -6 87 58T31 216Q31 307 88 372T230 437Q292 437 342 405L351 399V535H320L289 536Q266 543 266 573ZM351 290Q347 302 337 316T302 346T244 361Q193 361 154 319T115 215Q115 152 152 111T235 70Q314 70 351 170V290Z"></path><path id="MJX-135-TEX-M-2D" d="M57 306Q57 333 86 341H438Q468 332 468 306T438 271H86Q57 280 57 306Z"></path><path id="MJX-135-TEX-M-1D68E" d="M48 217Q48 295 100 361T248 439L258 440Q268 440 274 440Q329 438 369 416T428 359T456 292T464 228Q464 215 461 208T454 198T442 190L288 189H135L138 179Q153 132 199 102T303 71Q336 71 353 86T380 120T398 143Q404 146 422 146Q453 146 462 126Q464 120 464 116Q464 84 416 39T285 -6Q187 -6 118 59T48 217ZM377 264Q371 291 365 306T341 338T294 362Q288 363 264 363Q225 363 190 336T139 264H377Z"></path><path id="MJX-135-TEX-M-1D6A1" d="M35 393Q35 417 46 424T89 432Q95 432 112 432T141 431H223Q238 422 241 415T244 393Q244 389 244 383T237 367T216 355Q209 355 209 354L234 319Q259 286 260 286L308 354Q308 355 301 355Q285 356 278 365T270 384L271 393Q271 420 289 428Q295 431 376 431H459Q460 430 465 427T472 422T476 416T480 407T481 393Q481 368 470 362T434 355H425H392L344 290Q295 225 295 223Q294 223 309 203T350 149L405 77L439 76H453Q474 76 484 69T495 38Q495 10 473 1H303Q281 9 281 32V38Q281 49 282 54T290 67T313 76Q324 76 324 77L259 173L197 77Q202 76 209 76Q225 75 233 68T241 55T242 38Q242 28 242 24T236 12T221 1H51Q29 9 29 32V38Q29 48 29 51T31 59T38 67T51 76H117L171 149Q224 222 224 223L124 355H90H78Q54 355 45 361T35 393Z"></path><path id="MJX-135-TEX-M-1D699" d="M89 431Q93 431 104 431T121 432Q173 432 173 401V396L182 402Q237 437 305 437Q376 437 434 378T492 217Q492 146 459 93T382 17T291 -6Q261 -6 232 5T188 26L174 37Q173 37 173 -54V-146H236Q250 -155 254 -162T258 -184Q258 -213 236 -221H27Q4 -214 4 -184Q4 -169 8 -162T27 -146H89V355H58L27 356Q4 363 4 393Q4 408 8 415T27 431H89ZM409 215Q409 269 377 315T283 361Q255 361 224 344T177 297L173 290V167Q189 124 213 97T278 70Q330 70 369 111T409 215Z"></path><path id="MJX-135-TEX-M-1D698" d="M52 216Q52 318 118 379T261 440Q343 440 407 378T472 216Q472 121 410 58T262 -6Q176 -6 114 58T52 216ZM388 225Q388 281 351 322T261 364Q213 364 175 325T136 225Q136 158 174 114T262 70T350 114T388 225Z"></path><path id="MJX-135-TEX-M-1D69E" d="M4 393Q4 416 15 423T52 431H90Q141 431 151 429T168 417Q171 412 173 409V254L174 100Q182 70 244 70Q320 70 344 119Q349 130 350 144T351 248V355H320L289 356Q266 363 266 393Q266 408 270 415T289 431H351H386Q409 431 418 428T433 411Q435 406 435 241V76H498Q512 67 516 60T520 38Q520 9 498 1H436H394Q372 1 364 5T351 26L342 21Q293 -5 227 -5Q118 -5 96 67Q91 82 90 101T89 227V355H58L27 356Q4 363 4 393Z"></path><path id="MJX-135-TEX-M-1D697" d="M89 431Q94 431 105 431T122 432Q173 432 173 399Q173 394 175 394Q176 394 190 404T233 425T298 436Q343 436 371 423Q411 402 423 365T436 265Q436 257 436 239T435 211V198V76H498Q512 67 516 60T520 38Q520 9 498 1H308Q286 9 286 32V38V45Q286 65 303 73Q309 76 329 76H351V188Q351 204 351 230T352 266Q352 321 341 341T288 361Q253 361 222 341T176 274L174 264L173 170V76H236Q250 67 254 60T258 38Q258 9 236 1H27Q4 8 4 38Q4 53 8 60T27 76H89V355H58L27 356Q4 363 4 393Q4 408 8 415T27 431H89Z"></path><path id="MJX-135-TEX-M-1D69F" d="M24 392Q24 417 36 424T79 432Q85 432 103 432T132 431H215Q229 422 233 415T237 393Q237 355 198 355H193H172L262 77L352 355H331H323Q288 355 288 393Q288 409 291 415T310 431H478Q491 423 495 416T500 393Q500 364 478 356L452 355H426L374 190Q320 24 318 20Q307 -4 273 -4H262H251Q217 -4 206 20Q204 24 150 190L98 355H72L47 356Q24 363 24 392Z"></path><path id="MJX-135-TEX-M-1D69B" d="M327 76Q359 76 369 70T380 38Q380 10 359 1H47Q24 8 24 38Q24 54 28 61T47 76H145V355H96L47 356Q24 363 24 393Q24 409 28 416T47 431H207Q223 419 226 414T229 393V387V369Q297 437 394 437Q436 437 461 417T487 368Q487 347 473 332T438 317Q428 317 420 320T407 327T398 337T393 347T390 356L388 361Q348 356 324 345Q228 299 228 170Q228 161 228 151T229 138V76H293H327Z"></path><path id="MJX-135-TEX-M-1D6A2" d="M26 393Q26 417 37 424T80 431H134H217Q232 422 235 416T239 393Q239 379 236 371T226 360T214 356T197 355L179 354V353L188 330Q197 306 209 272T235 201T259 133T271 89V84L274 95Q279 122 298 185T335 300T352 354Q352 355 331 355Q312 355 304 358Q288 368 288 393Q288 408 291 415T310 431H478Q479 430 484 427T491 422T495 416T499 407T500 393Q500 376 493 367T479 357T458 355H452Q426 355 425 353Q420 337 351 124T280 -94Q240 -195 168 -220Q147 -228 125 -228Q89 -228 66 -201T42 -139Q42 -116 56 -102T93 -87Q117 -87 130 -102T144 -135V-138H126Q121 -148 121 -150T130 -152Q182 -147 207 -87Q211 -78 223 -40T236 1Q230 10 102 355H75L49 356Q26 363 26 393Z"></path><path id="MJX-135-TEX-M-1D69D" d="M25 395Q26 405 26 408T29 416T35 423T48 431H145V481L146 532Q154 547 161 550T184 554H189Q218 554 227 534Q229 529 229 480V431H405Q406 430 411 427T418 422T422 416T426 407T427 393Q427 387 427 382T424 374T421 368T417 363T413 360T408 358L405 356L317 355H229V249Q229 237 229 214T228 179Q228 126 241 98T295 70Q354 70 365 149Q366 167 375 174Q383 182 407 182H415Q438 182 446 166Q448 161 448 148Q448 84 398 39T282 -6Q226 -6 189 29T146 128Q145 134 145 247V355H96H72Q45 355 35 362T25 395Z"></path><path id="MJX-135-TEX-M-1D68F" d="M43 395Q44 405 44 408T47 416T53 423T66 431H176V461Q176 500 182 518Q201 570 252 593T353 617Q399 614 418 593T437 548Q437 528 424 514T387 499Q365 499 353 511T338 537V541H328Q275 536 261 494Q260 490 260 460V431H327Q334 431 346 431T364 432Q392 432 404 425T416 393T405 362T365 355H327H260V76H319Q375 76 388 71T401 38Q401 27 400 23T395 12T379 1H58Q47 6 42 12T36 23T35 38Q35 65 53 73Q59 76 117 76H176V355H121H93Q64 355 54 362T43 395Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mspace"></g></g><g data-mml-node="xypic" data-cmd-id="0" data-text-mml-ids="[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]" transform="translate(2000,0)"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="0.64" transform="translate(5032.5,250) scale(62.5, -62.5)"><rect x="-53.2" y="-9.86" width="106.4" height="19.71" rx="0" stroke="currentColor"></rect><rect x="-77.32" y="51.95" width="30.8" height="19.94" rx="0" stroke="currentColor"></rect><line x1="-38.01" y1="38.01" x2="-51.95" y2="51.95" stroke-dasharray=""></line><line x1="-9.86" y1="9.86" x2="-23.91" y2="23.91" stroke-dasharray=""></line><g transform="translate(-51.95,51.95) rotate(135) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="21.32" y="51.95" width="81.2" height="19.94" rx="0" stroke="currentColor"></rect><line x1="37.97" y1="37.97" x2="51.95" y2="51.95" stroke-dasharray=""></line><line x1="9.86" y1="9.86" x2="23.95" y2="23.95" stroke-dasharray=""></line><g transform="translate(51.95,51.95) rotate(45) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="-40.6" y="113.87" width="81.2" height="19.94" rx="0" stroke="currentColor"></rect><line x1="25.53" y1="98.31" x2="9.97" y2="113.87" stroke-dasharray=""></line><line x1="51.95" y1="71.89" x2="36.39" y2="87.45" stroke-dasharray=""></line><g transform="translate(9.97,113.87) rotate(135) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="83.24" y="113.87" width="81.2" height="19.94" rx="0" stroke="currentColor"></rect><line x1="98.63" y1="98.63" x2="113.87" y2="113.87" stroke-dasharray=""></line><line x1="71.89" y1="71.89" x2="87.13" y2="87.13" stroke-dasharray=""></line><g transform="translate(113.87,113.87) rotate(45) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="-15.4" y="175.79" width="30.8" height="19.94" rx="0" stroke="currentColor"></rect><line x1="0" y1="159.58" x2="0" y2="175.79" stroke-dasharray=""></line><line x1="0" y1="133.81" x2="0" y2="150.02" stroke-dasharray=""></line><g transform="translate(0,175.79) rotate(90) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="21.32" y="175.79" width="81.2" height="19.94" rx="0" stroke="currentColor"></rect><line x1="87.45" y1="160.23" x2="71.89" y2="175.79" stroke-dasharray=""></line><line x1="113.87" y1="133.81" x2="98.31" y2="149.37" stroke-dasharray=""></line><g transform="translate(71.89,175.79) rotate(135) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="145.16" y="175.79" width="81.2" height="19.94" rx="0" stroke="currentColor"></rect><line x1="160.55" y1="160.55" x2="175.79" y2="175.79" stroke-dasharray=""></line><line x1="133.81" y1="133.81" x2="149.05" y2="149.05" stroke-dasharray=""></line><g transform="translate(175.79,175.79) rotate(45) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="46.52" y="237.71" width="30.8" height="19.94" rx="0" stroke="currentColor"></rect><line x1="61.92" y1="221.5" x2="61.92" y2="237.71" stroke-dasharray=""></line><line x1="61.92" y1="195.73" x2="61.92" y2="211.94" stroke-dasharray=""></line><g transform="translate(61.92,237.71) rotate(90) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g><rect x="170.36" y="237.71" width="30.8" height="19.94" rx="0" stroke="currentColor"></rect><line x1="185.76" y1="221.5" x2="185.76" y2="237.71" stroke-dasharray=""></line><line x1="185.76" y1="195.73" x2="185.76" y2="211.94" stroke-dasharray=""></line><g transform="translate(185.76,237.71) rotate(90) "><path d="M0,0 Q-3.55,0.32 -7.82,2.35"></path><path d="M0,0 Q-3.55,-0.32 -7.82,-2.35"></path></g></g><g stroke="currentColor" fill="currentColor" data-x="-2.6250000000000004" data-y="0.19499999999999995" data-xypic-id="0" transform="translate(2407.5,55)"><g data-mml-node="mtext"><use data-c="1D695" xlink:href="#MJX-135-TEX-M-1D695"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D696" xlink:href="#MJX-135-TEX-M-1D696" transform="translate(1050,0)"></use><use data-c="1D68B" xlink:href="#MJX-135-TEX-M-1D68B" transform="translate(1575,0)"></use><use data-c="1D68D" xlink:href="#MJX-135-TEX-M-1D68D" transform="translate(2100,0)"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(2625,0)"></use><use data-c="2D" xlink:href="#MJX-135-TEX-M-2D" transform="translate(3150,0)"></use><use data-c="1D68E" xlink:href="#MJX-135-TEX-M-1D68E" transform="translate(3675,0)"></use><use data-c="1D6A1" xlink:href="#MJX-135-TEX-M-1D6A1" transform="translate(4200,0)"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(4725,0)"></use></g></g><g stroke="currentColor" fill="currentColor" data-x="-4.132499999999999" data-y="4.064" data-xypic-id="1" transform="translate(900,-3814)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D6A1" xlink:href="#MJX-135-TEX-M-1D6A1"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(525,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="-3.6055397705532184" data-y="2.0721787155501903" data-xypic-id="2" transform="translate(1427,-1822.2)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D68B" xlink:href="#MJX-135-TEX-M-1D68B"></use><use data-c="1D698" xlink:href="#MJX-135-TEX-M-1D698" transform="translate(525,0)"></use><use data-c="1D69E" xlink:href="#MJX-135-TEX-M-1D69E" transform="translate(1050,0)"></use><use data-c="1D697" xlink:href="#MJX-135-TEX-M-1D697" transform="translate(1575,0)"></use><use data-c="1D68D" xlink:href="#MJX-135-TEX-M-1D68D" transform="translate(2100,0)"></use><use data-c="2D" xlink:href="#MJX-135-TEX-M-2D" transform="translate(2625,0)"></use><use data-c="1D69F" xlink:href="#MJX-135-TEX-M-1D69F" transform="translate(3150,0)"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(3675,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(4200,0)"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4725,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="2.0325000000000006" data-y="4.064" data-xypic-id="3" transform="translate(7065,-3814)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(525,0)"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(1050,0)"></use><use data-c="2D" xlink:href="#MJX-135-TEX-M-2D" transform="translate(1575,0)"></use><use data-c="1D68E" xlink:href="#MJX-135-TEX-M-1D68E" transform="translate(2100,0)"></use><use data-c="1D6A1" xlink:href="#MJX-135-TEX-M-1D6A1" transform="translate(2625,0)"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(3150,0)"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3675,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="1.1925378797541255" data-y="2.0704109485972237" data-xypic-id="4" transform="translate(6225,-1820.4)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D68B" xlink:href="#MJX-135-TEX-M-1D68B"></use><use data-c="1D698" xlink:href="#MJX-135-TEX-M-1D698" transform="translate(525,0)"></use><use data-c="1D68D" xlink:href="#MJX-135-TEX-M-1D68D" transform="translate(1050,0)"></use><use data-c="1D6A2" xlink:href="#MJX-135-TEX-M-1D6A2" transform="translate(1575,0)"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="-1.8374999999999988" data-y="7.934" data-xypic-id="5" transform="translate(3195,-7684)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D69F" xlink:href="#MJX-135-TEX-M-1D69F"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(1050,0)"></use><use data-c="2D" xlink:href="#MJX-135-TEX-M-2D" transform="translate(1575,0)"></use><use data-c="1D68E" xlink:href="#MJX-135-TEX-M-1D68E" transform="translate(2100,0)"></use><use data-c="1D6A1" xlink:href="#MJX-135-TEX-M-1D6A1" transform="translate(2625,0)"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(3150,0)"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3675,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="1.0069223496926578" data-y="5.998747258045114" data-xypic-id="6" transform="translate(6039.4,-5748.7)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D69D" xlink:href="#MJX-135-TEX-M-1D69D" transform="translate(1050,0)"></use><use data-c="1D698" xlink:href="#MJX-135-TEX-M-1D698" transform="translate(1575,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(2100,0)"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="5.902500000000001" data-y="7.934" data-xypic-id="7" transform="translate(10935,-7684)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(525,0)"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(1050,0)"></use><use data-c="2D" xlink:href="#MJX-135-TEX-M-2D" transform="translate(1575,0)"></use><use data-c="1D68E" xlink:href="#MJX-135-TEX-M-1D68E" transform="translate(2100,0)"></use><use data-c="1D6A1" xlink:href="#MJX-135-TEX-M-1D6A1" transform="translate(2625,0)"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(3150,0)"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3675,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="5.0625378797541245" data-y="6.0188998013089305" data-xypic-id="8" transform="translate(10095,-5768.9)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D697" xlink:href="#MJX-135-TEX-M-1D697" transform="translate(1050,0)"></use><use data-c="1D68D" xlink:href="#MJX-135-TEX-M-1D68D" transform="translate(1575,0)"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="-0.26249999999999846" data-y="11.803999999999998" data-xypic-id="9" transform="translate(4770,-11554)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D68F" xlink:href="#MJX-135-TEX-M-1D68F"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(525,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="-0.5568465901844046" data-y="9.828088618126888" data-xypic-id="10" transform="translate(4475.7,-9578.1)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D69F" xlink:href="#MJX-135-TEX-M-1D69F"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(1050,0)"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="2.032500000000001" data-y="11.803999999999998" data-xypic-id="11" transform="translate(7065,-11554)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D69F" xlink:href="#MJX-135-TEX-M-1D69F"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(1050,0)"></use><use data-c="2D" xlink:href="#MJX-135-TEX-M-2D" transform="translate(1575,0)"></use><use data-c="1D68E" xlink:href="#MJX-135-TEX-M-1D68E" transform="translate(2100,0)"></use><use data-c="1D6A1" xlink:href="#MJX-135-TEX-M-1D6A1" transform="translate(2625,0)"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(3150,0)"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3675,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="4.876922349692656" data-y="9.868747258045115" data-xypic-id="12" transform="translate(9909.4,-9618.7)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D69D" xlink:href="#MJX-135-TEX-M-1D69D" transform="translate(1050,0)"></use><use data-c="1D698" xlink:href="#MJX-135-TEX-M-1D698" transform="translate(1575,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(2100,0)"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="9.772499999999999" data-y="11.803999999999998" data-xypic-id="13" transform="translate(14805,-11554)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D69F" xlink:href="#MJX-135-TEX-M-1D69F"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(1050,0)"></use><use data-c="2D" xlink:href="#MJX-135-TEX-M-2D" transform="translate(1575,0)"></use><use data-c="1D68E" xlink:href="#MJX-135-TEX-M-1D68E" transform="translate(2100,0)"></use><use data-c="1D6A1" xlink:href="#MJX-135-TEX-M-1D6A1" transform="translate(2625,0)"></use><use data-c="1D699" xlink:href="#MJX-135-TEX-M-1D699" transform="translate(3150,0)"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3675,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="8.932537879754125" data-y="9.88889980130893" data-xypic-id="14" transform="translate(13965,-9638.9)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D697" xlink:href="#MJX-135-TEX-M-1D697" transform="translate(1050,0)"></use><use data-c="1D68D" xlink:href="#MJX-135-TEX-M-1D68D" transform="translate(1575,0)"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="3.6075000000000017" data-y="15.674" data-xypic-id="15" transform="translate(8640,-15424)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D68F" xlink:href="#MJX-135-TEX-M-1D68F"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(525,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="3.313153409815595" data-y="13.698088618126887" data-xypic-id="16" transform="translate(8345.7,-13448.1)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D69F" xlink:href="#MJX-135-TEX-M-1D69F"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(1050,0)"></use></g></g></g><g stroke="currentColor" fill="currentColor" data-x="11.347499999999998" data-y="15.674" data-xypic-id="17" transform="translate(16380,-15424)"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="1D6A1" xlink:href="#MJX-135-TEX-M-1D6A1"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(525,0)"><g data-mml-node="mpadded"><g data-mml-node="mphantom"></g></g></g></g></g></g></g></g><g stroke="currentColor" fill="currentColor" data-x="11.053153409815593" data-y="13.698088618126887" data-xypic-id="18" transform="translate(16085.7,-13448.1)"><g data-mml-node="mstyle" transform="scale(0.707)"><g data-mml-node="mtext"><use data-c="1D69F" xlink:href="#MJX-135-TEX-M-1D69F"></use><use data-c="1D68A" xlink:href="#MJX-135-TEX-M-1D68A" transform="translate(525,0)"></use><use data-c="1D69B" xlink:href="#MJX-135-TEX-M-1D69B" transform="translate(1050,0)"></use></g></g></g></g></g></g></svg>
  </div>
  <style>
    .svg-container {
      display: inline-block;
      width: 100%;
      max-width: 100%;
      height: auto;
      overflow-x: auto;
      overflow-y: hidden;
    }
    .svg-container svg {
      width: auto;
      height: auto;
      
      
    }
  </style>

<p>要为某种具体语法设计抽象语法 , 我们就必须为具体语法中的每个派生式及各个派生式中的
每个非终结符的出现都起一个名字 。使用 <code>define-datatype</code> 可以很轻松地声明抽象语法 ,
我们为每个非终结符都使用一次 <code>define-datatype</code> , 为每个派生式都添加一个变体 。</p>
<p>我们可以用下述记法精确总结概括<a href="#G2.2">图 2.2</a> 中的结构 :<div class="fi-row"><a id="S2.5-lc-exp"></a></div></p>
<p>$\qquad \begin{aligned}[t]
\LcExp ::={}& \Iden \\
            & \bbox[border:.4pt solid black]{\texttt{var-exp (var)}} \\[+3pt]
       ::={}& \texttt{(lambda (\Iden) \LcExp)} \\
            & \bbox[border:.4pt solid black]{\texttt{lambda-exp (bound-var body)}}\\[+3pt]
       ::={}& \texttt{(\LcExp  \LcExp)} \\
            & \bbox[border:.4pt solid black]{\texttt{app-exp (rator rand)}}
\end{aligned}$</p>
<p>这样的记法可同时指明具体语法和抽象语法 , 本书将会始终采用 。</p>
<p>既然已经区分了具体语法 ( 主要供人使用 ) 以及抽象语法 ( 主要供计算机使用 ) , 现在看看
如何在这两种语法之间进行转换 。</p>
<p>假如具体语法是个字符串集合 , 那么想要推导出对应的抽象语法树将会非常麻烦 。这样的
任务叫做<strong>解析 parsing</strong> , 其由<strong>解析器 parser</strong> 完成 。由于写解析器通常会很麻烦 , 因此最好
用一种叫<strong>解析器生成器 parser generator</strong> 的工具来实现此目标 ; 解析器生成器以一套语法
作为输入并输出一个解析器 。由于语法是交由工具处理的 , 它们必须以某种机器可识别的
方式来书写 。有很多现成的解析器生成器 。</p>
<p>如果具体语法以列表集合的形式给出 , 那么解析过程就可被大幅简化 。
比如将<a href="#S2.5">本节开头的$\texttt{lambda}$ 演算表达式</a>声明为列表集合 ,
就如同前面 <a href="#S2.4-define-datatype">第 47 页提到的 <code>define-datatype</code></a> 一样 。
在这种情形下 Scheme 的 <code>read</code> 流程会自动把字符串解析为列表和符号 ,
如此将这些列表结构解析为抽象语法树就容易得多了 ,
正如下面的 <code>parse-expression</code> 一样 。</p>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="c1">;; parse-expression : SchemeVal → LcExp</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">parse-expression</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">datum</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">cond</span>
</span></span><span class="line"><span class="cl">     <span class="p">[(</span><span class="nb">symbol? </span><span class="nv">datum</span><span class="p">)</span> <span class="p">(</span><span class="nf">var-exp</span> <span class="nv">datum</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">     <span class="p">[(</span><span class="nb">pair? </span><span class="nv">datum</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eqv? </span><span class="p">(</span><span class="nb">car </span><span class="nv">datum</span><span class="p">)</span> <span class="ss">&#39;lambda</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">lambda-exp</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cadr </span><span class="nv">datum</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">parse-expression</span> <span class="p">(</span><span class="nb">caddr </span><span class="nv">datum</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">app-exp</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">parse-expression</span> <span class="p">(</span><span class="nb">car </span><span class="nv">datum</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">parse-expression</span> <span class="p">(</span><span class="nb">cadr </span><span class="nv">datum</span><span class="p">))))]</span>
</span></span><span class="line"><span class="cl">     <span class="p">[</span><span class="k">else </span><span class="p">(</span><span class="nf">report-invalid-concrete-syntax</span> <span class="nv">datum</span><span class="p">)])))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>通常我们很容易将抽象语法树重新转换为列表 - 符号表示 。如果这样做了那么 Scheme 的
打印流程就会将其展示为列表形式的具体语法 。这一切是通过 <code>unparse-lc-exp</code> 实现的 :</p>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="c1">;; unparse-lc-exp : LcExp → SchemeVal</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">define </span><span class="nv">unparse-lc-exp</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">exp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">cases</span> <span class="nv">lc-exp</span> <span class="nv">exp</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">var-exp</span> <span class="p">(</span><span class="nf">var</span><span class="p">)</span> <span class="nv">var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">lambda-exp</span> <span class="p">(</span><span class="nf">bound-var</span> <span class="nv">body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                       <span class="p">(</span><span class="nb">list </span><span class="ss">&#39;lambda</span> <span class="p">(</span><span class="nb">list </span><span class="nv">bound-var</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                             <span class="p">(</span><span class="nf">unparse-lc-exp</span> <span class="nv">body</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nf">app-exp</span> <span class="p">(</span><span class="nf">rator</span> <span class="nv">rand</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">(</span><span class="nf">list</span>
</span></span><span class="line"><span class="cl">                     <span class="p">(</span><span class="nf">unparse-lc-exp</span> <span class="nv">rator</span><span class="p">)</span> <span class="p">(</span><span class="nf">unparse-lc-exp</span> <span class="nv">rand</span><span class="p">))))))</span></span></span></code></pre></td></tr></table>
</div>
</div><p><div class="fi-row"><a id="Xer2.27"></a></div><strong>练习 2.27</strong> <code>[*]</code><br>
画出下面 lambda 演算表达式的抽象语法树：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">))</span> <span class="nv">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">     <span class="nv">x</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p><div class="fi-row"><a id="Xer2.28"></a></div><strong>练习 2.28</strong> <code>[*]</code><br>
写出逆向解析器以将 <code>lc-exp</code> 的抽象语法转换为符合<a href="#S2.5-lc-exp">本节第二个语法 ( 第 52 页 )</a> 的字符串 。</p>
<p><div class="fi-row"><a id="Xer2.29"></a></div><strong>练习 2.29</strong> <code>[*]</code><br>
若<a href="/posts/5cce8df/#S1.1.2-Kleene">克莱尼星号或加号 ( 第 7 页 )</a> 被用于具体语法中 , 构建抽象语法树时最好是使用相应子树
构成的列表 。例如，如果 $\texttt{lambda}$ 演算表达式的语法为</p>
<p>$\qquad \qquad \begin{aligned}[t]
\LcExp ::={}& \Iden \\
            & \bbox[border:.4pt solid black]{\texttt{var-exp (var)}} \\[+3pt]
       ::={}& \texttt{(lambda \(\{(\Iden)^*\}\) \LcExp )} \\
            & \bbox[border:.4pt solid black]{\texttt{lambda-exp (bound-var body)}}\\[+3pt]
       ::={}& \texttt{(\LcExp  \(\{\LcExp\}^*\))} \\
            & \bbox[border:.4pt solid black]{\texttt{app-exp (rator rand)}}
\end{aligned}$</p>
<p>那么字段 <code>bound-vars</code> 对应的谓词就可以写作是 <code>(list-of identifier?)</code> ,
而 <code>rands</code> 对应的谓词则可写作 <code>(list-of lc-exp?)</code> 。
以此方式写出该语法的 <code>define-datatype</code> 和解析器 。</p>
<p><div class="fi-row"><a id="Xer2.30"></a></div><strong>练习 2.30</strong> <code>[**]</code><br>
刚才定义的 <code>parse-expression</code> 过程不是很靠谱 :
它检查不到某些可能的语法错误 —— 如 <code>(a b c)</code> ;
并且会在其他表达式终止时给不出恰当的错误信息 —— 如 <code>(lambda)</code> 。
请修改它以使之更稳健 , 可以接收任何 $\SExp$ ,
并且可对不表示 $\texttt{lambda}$ 演算表达式的 $\SExp$ 给出恰当的错误信息 。</p>
<p><div class="fi-row"><a id="Xer2.31"></a></div><strong>练习 2.31</strong> <code>[**]</code><br>
有时把具体语法定义为被括号包围的符号和整数序列会很方便 。比如我们可考虑把<strong>前缀列表 prefix list</strong> 定义为</p>
<p>$\qquad \begin{aligned}[t]
\PrefixList ::={}& \texttt{(\PrefixList)}  \\
\PrefixList ::={}& \Int \\
            ::={}& \texttt{- \PrefixList  \PrefixList}
\end{aligned}$</p>
<p>如此 <code>(- - 3 2 - 4 - 12 7)</code> 是一个合法的前缀列表 。该表示法也称作<strong>波兰前缀表示法 Polish prefix notation</strong> 以纪念其发明者Jan Łukasiewicz 。写一个解析器以将前缀列表表示法
转换为下述抽象语法 :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">define-datatype</span> <span class="nv">prefix-exp</span> <span class="nv">prefix-exp?</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">const-exp</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">num</span> <span class="nv">integer?</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nf">diff-exp</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">operand1</span> <span class="nv">prefix-exp?</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">(</span><span class="nf">operand2</span> <span class="nv">prefix-exp?</span><span class="p">)))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>使上例与这几个构造器能生成相同抽象语法树 :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scheme" data-lang="scheme"><span class="line"><span class="cl"><span class="p">(</span><span class="nf">diff-exp</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="nf">diff-exp</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">const-exp</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">const-exp</span> <span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"> <span class="p">(</span><span class="nf">diff-exp</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">const-exp</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">diff-exp</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nf">const-exp</span> <span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nf">const-exp</span> <span class="mi">7</span><span class="p">))))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>提示 : 想想如何写一个过程 : 其取一列表并产生一个 <code>prefix-exp</code> 和列表剩余元素所组成的列表 。</p>
</div><div class="collection-card">
      <div class="collection-title text-secondary">收录于 <a href="/collections/%E7%BF%BB%E8%AF%91-eopl/"><i class="fa-solid fa-layer-group fa-fw" aria-hidden="true"></i> <span>合集・翻译-EOPL</span></span></a> 5</div>
      <div class="collection-nav">
        <a href="/posts/a3b7a27/" class="collection-nav-item" rel="prev" title="翻译-EOPL-03"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i><span>翻译-EOPL-03</span>
          </a><a href="/posts/5cce8df/" class="collection-nav-item" rel="next" title="翻译-EOPL-01-递归的数据集">
            <span>翻译-EOPL-01-递归的数据集</span><i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
    </div>
    
<script src="https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js"></script>

<div id="print-controls" style="text-align: center; margin: 2rem 0;">
  <button id="upload-btn" style="
    background-color: #444;
    color: white;
    padding: 0.6rem 1.2rem;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-size: 0.95rem;
  ">点此上传本博文对应的 PDF 以自动为 PDF 添加书签</button>
  <input type="file" id="pdf-upload" accept="application/pdf" style="display: none;" />
</div>

<script>
  window.addEventListener("DOMContentLoaded", () => {
    document.getElementById("upload-btn").addEventListener("click", () => {
      document.getElementById("pdf-upload").click();
    });
    document.getElementById("pdf-upload").addEventListener("change", handlePdfUpload);
  });

  window.addEventListener("beforeprint", () => {
    const headers = document.querySelectorAll(".single-title, .content h2, .content h3, .content h4");
    headers.forEach((el, i) => {
      if (el.querySelector("a.md-print-anchor")) return;
      const anchor = document.createElement("a");
      anchor.href = `af://n${i}`;
      anchor.className = "md-header-anchor md-print-anchor";
      anchor.style.display = "inline-block";
      anchor.style.height = "0.1pt";
      anchor.style.width = "0.1pt";
      anchor.style.overflow = "hidden";
      anchor.style.color = "transparent";
      el.insertBefore(anchor, el.firstChild);
    });
  });

  window.addEventListener("afterprint", () => {
    document.querySelectorAll(".md-print-anchor").forEach(a => a.remove());
  });

  async function handlePdfUpload(e) {
    const file = e.target.files[0];
    if (!file) return alert("请先选择一个 PDF 文件");

    const arrayBuffer = await file.arrayBuffer();
    const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
    const pages = pdfDoc.getPages();
    const context = pdfDoc.context;

    const markerMap = new Map();
    for (let i = 0; i < pages.length; i++) {
      const annots = pages[i].node.Annots?.();
      if (!annots) continue;
      for (let j = 0; j < annots.size(); j++) {
        try {
          const ann = annots.lookup(j, PDFLib.PDFDict);
          const subtype = ann.get(PDFLib.PDFName.of("Subtype"));
          if (subtype?.asString() !== "/Link") continue;
          const action = ann.get(PDFLib.PDFName.of("A"));
          const uri = action?.get(PDFLib.PDFName.of("URI"))?.asString();
          const rect = ann.get(PDFLib.PDFName.of("Rect"))?.asRectangle();
          const match = /^af:\/\/(.+)$/.exec(uri);
          if (!match) continue;
          const anchorId = match[1];
          const y = rect.y;
          markerMap.set(anchorId, { pageIndex: i, y });
        } catch (err) {
          console.warn("annotation parse failed", err);
        }
      }
    }

    const headings = Array.from(document.querySelectorAll(".single-title, .content h2, .content h3, .content h4"))
      .map((el, i) => ({
        level: el.matches(".single-title") ? 1 : parseInt(el.tagName[1]),
        text: el.innerText.trim(),
        marker: `n${i}`
      }))
      .filter(h => markerMap.has(h.marker));

    if (headings.length === 0) {
      alert("未在 PDF 中找到任何 af:// 书签标记，请确认已插入锚点并打印。");
      return;
    }

    const outlineNodes = [];
    headings.forEach(({ text, level, marker }) => {
      const { pageIndex, y } = markerMap.get(marker);
      const page = pages[pageIndex];
      const destArray = context.obj([
        page.ref,
        PDFLib.PDFName.of("XYZ"),
        PDFLib.PDFNumber.of(0),
        PDFLib.PDFNumber.of(y),
        PDFLib.PDFNull
      ]);
      const dict = context.obj({
        Title: PDFLib.PDFHexString.fromText(text),
        Dest: destArray
      });
      const ref = context.register(dict);
      outlineNodes.push({ dict, ref, level, children: [] });
    });

    const stack = [], topLevel = [];
    outlineNodes.forEach(node => {
      while (stack.length > 0 && stack[stack.length - 1].level >= node.level) stack.pop();
      if (stack.length === 0) topLevel.push(node);
      else stack[stack.length - 1].children.push(node);
      stack.push(node);
    });

    function linkSiblings(nodes) {
      for (let i = 0; i < nodes.length; i++) {
        const current = nodes[i];
        if (i > 0) current.dict.set(PDFLib.PDFName.of("Prev"), nodes[i - 1].ref);
        if (i < nodes.length - 1) current.dict.set(PDFLib.PDFName.of("Next"), nodes[i + 1].ref);
        if (current.children.length > 0) {
          current.dict.set(PDFLib.PDFName.of("First"), current.children[0].ref);
          current.dict.set(PDFLib.PDFName.of("Last"), current.children[current.children.length - 1].ref);
          current.dict.set(PDFLib.PDFName.of("Count"), PDFLib.PDFNumber.of(current.children.length));
          linkSiblings(current.children);
        }
      }
    }

    linkSiblings(topLevel);

    const outlineDict = context.obj({
      Type: PDFLib.PDFName.of("Outlines"),
      First: topLevel[0].ref,
      Last: topLevel[topLevel.length - 1].ref,
      Count: PDFLib.PDFNumber.of(topLevel.length)
    });

    pdfDoc.catalog.set(PDFLib.PDFName.of("Outlines"), context.register(outlineDict));
    pdfDoc.catalog.set(PDFLib.PDFName.of("PageMode"), PDFLib.PDFName.of("UseOutlines"));

    const pdfBytes = await pdfDoc.save();
    const blob = new Blob([pdfBytes], { type: "application/pdf" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    const originalName = file.name.replace(/\.pdf$/i, '');
    link.download = `${originalName}-带书签.pdf`;

    link.click();
  }
</script><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2025-04-02 23:11:17">更新于 2025-04-02&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="vscode://file//mnt/d/Studies/Myself/Arena/fixit/content/posts/read-EOPL-Chpt02.md" title="在编辑器中打开"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">在编辑器中打开</a></span></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/%E7%BF%BB%E8%AF%91/" class="post-tag" title="标签 - 翻译">翻译</a><a href="/tags/eopl/" class="post-tag" title="标签 - EOPL">EOPL</a><a href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/" class="post-tag" title="标签 - 函数式编程">函数式编程</a><a href="/tags/racket/" class="post-tag" title="标签 - Racket">Racket</a><a href="/tags/lisp/" class="post-tag" title="标签 - Lisp">Lisp</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/5cce8df/" class="post-nav-item" rel="prev" title="翻译-EOPL-01-递归的数据集"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>翻译-EOPL-01-递归的数据集</a><a href="/posts/a3b7a27/" class="post-nav-item" rel="next" title="翻译-EOPL-03">翻译-EOPL-03<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.147.2">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.21-a85a6655">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">该网站在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><script>
  MathJax = {
    loader: {
      load: ['[custom]/xypic.js'],
      paths: { custom: 'https://cdn.jsdelivr.net/gh/sonoisa/XyJax-v3@3.0.1/build/' }
    },
    tex: {
      packages: { '[+]': ['xypic'] },
      inlineMath: [['\\(', '\\)'], ['$', '$']],
      displayMath: [['\\[', '\\]'], ['$$', '$$']],
      processEscapes: true,
      
      useLabelIds: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      enableMenu: false,
    },
    chtml: {
      scale: 0.8,                    
      minScale: .5,                  
      mtextInheritFont: false,       
      merrorInheritFont: true,       
      adaptiveCSS: true,
    },
    svg: {
      scale: 0.8,
      minScale: .5,
      mtextInheritFont: false,
      merrorInheritFont: true
    }
  };
</script>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>
<style>
  mjx-container {
    display: inline-grid;
    overflow-x: auto;
    overflow-y: hidden !important;
    max-width: 100%;
  }
  mjx-container svg {
    display: inline-grid !important;
    overflow-x: auto;
    overflow-y: hidden !important;
    max-width: 100%;
  }
</style><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"version":"v0.3.21-a85a6655"};console.log('Page config:', window.config);</script><script src="/js/theme.min.js" defer></script></body>
</html>
